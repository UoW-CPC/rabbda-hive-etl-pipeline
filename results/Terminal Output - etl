Last login: Thu Feb  6 11:33:22 on ttys001

The default interactive shell is now zsh.
To update your account to use zsh, please run `chsh -s /bin/zsh`.
For more details, please visit https://support.apple.com/kb/HT208050.
eroam-118-34:~ dimitriskagialis$ ssh centos@161.74.26.176
Last login: Thu Feb  6 02:11:23 2020 from 90.220.180.4
[centos@d-hdp1 ~]$ yum check-update
Loaded plugins: fastestmirror
Determining fastest mirrors
 * base: mirror.sov.uk.goscomb.net
 * extras: mirror.sov.uk.goscomb.net
 * updates: mirrors.ukfast.co.uk
HDP-2.6-GPL-repo-1                                       | 2.9 kB     00:00     
HDP-2.6-repo-1                                           | 2.9 kB     00:00     
HDP-UTILS-1.1.0.22-repo-1                                | 2.9 kB     00:00     
ambari-2.6.2.2                                           | 2.9 kB     00:00     
base                                                     | 3.6 kB     00:00     
extras                                                   | 2.9 kB     00:00     
updates                                                  | 2.9 kB     00:00     
updates/7/x86_64/primary_db                                | 6.7 MB   00:00     

GeoIP.x86_64                            1.5.0-14.el7                   base     
audit.x86_64                            2.8.5-4.el7                    base     
audit-libs.x86_64                       2.8.5-4.el7                    base     
audit-libs-python.x86_64                2.8.5-4.el7                    base     
bash.x86_64                             4.2.46-33.el7                  base     
bind-libs-lite.x86_64                   32:9.11.4-9.P2.el7             base     
bind-license.noarch                     32:9.11.4-9.P2.el7             base     
binutils.x86_64                         2.27-41.base.el7_7.2           updates  
ca-certificates.noarch                  2019.2.32-76.el7_7             updates  
centos-release.x86_64                   7-7.1908.0.el7.centos          base     
checkpolicy.x86_64                      2.5-8.el7                      base     
chrony.x86_64                           3.4-1.el7                      base     
cloud-init.x86_64                       18.5-3.el7.centos              base     
cloud-utils-growpart.noarch             0.29-5.el7                     base     
coreutils.x86_64                        8.22-24.el7                    base     
cronie.x86_64                           1.4.11-23.el7                  base     
cronie-anacron.x86_64                   1.4.11-23.el7                  base     
cryptsetup-libs.x86_64                  2.0.3-5.el7                    base     
curl.x86_64                             7.29.0-54.el7_7.2              updates  
dbus.x86_64                             1:1.10.24-13.el7_6             base     
dbus-libs.x86_64                        1:1.10.24-13.el7_6             base     
device-mapper.x86_64                    7:1.02.158-2.el7_7.2           updates  
device-mapper-libs.x86_64               7:1.02.158-2.el7_7.2           updates  
dhclient.x86_64                         12:4.2.5-77.el7.centos         base     
dhcp-common.x86_64                      12:4.2.5-77.el7.centos         base     
dhcp-libs.x86_64                        12:4.2.5-77.el7.centos         base     
diffutils.x86_64                        3.3-5.el7                      base     
dmidecode.x86_64                        1:3.2-3.el7                    base     
dracut.x86_64                           033-564.el7                    base     
dracut-config-generic.x86_64            033-564.el7                    base     
dracut-config-rescue.x86_64             033-564.el7                    base     
dracut-network.x86_64                   033-564.el7                    base     
e2fsprogs.x86_64                        1.42.9-16.el7                  base     
e2fsprogs-libs.x86_64                   1.42.9-16.el7                  base     
elfutils-default-yama-scope.noarch      0.176-2.el7                    base     
elfutils-libelf.x86_64                  0.176-2.el7                    base     
elfutils-libs.x86_64                    0.176-2.el7                    base     
ethtool.x86_64                          2:4.8-10.el7                   base     
file.x86_64                             5.11-35.el7                    base     
file-libs.x86_64                        5.11-35.el7                    base     
findutils.x86_64                        1:4.5.11-6.el7                 base     
gnupg2.x86_64                           2.0.22-5.el7_5                 base     
gobject-introspection.x86_64            1.56.1-1.el7                   base     
grub2.x86_64                            1:2.02-0.80.el7.centos         base     
grub2-common.noarch                     1:2.02-0.80.el7.centos         base     
grub2-pc.x86_64                         1:2.02-0.80.el7.centos         base     
grub2-pc-modules.noarch                 1:2.02-0.80.el7.centos         base     
grub2-tools.x86_64                      1:2.02-0.80.el7.centos         base     
grub2-tools-extra.x86_64                1:2.02-0.80.el7.centos         base     
grub2-tools-minimal.x86_64              1:2.02-0.80.el7.centos         base     
grubby.x86_64                           8.28-26.el7                    base     
gssproxy.x86_64                         0.7.0-26.el7                   base     
hostname.x86_64                         3.13-3.el7_7.1                 updates  
hwdata.x86_64                           0.252-9.3.el7                  base     
initscripts.x86_64                      9.49.47-1.el7                  base     
iproute.x86_64                          4.11.0-25.el7_7.2              updates  
iptables.x86_64                         1.4.21-33.el7                  base     
irqbalance.x86_64                       3:1.0.7-12.el7                 base     
iwl7265-firmware.noarch                 22.0.7.0-72.el7                base     
kbd.x86_64                              1.15.5-15.el7                  base     
kbd-legacy.noarch                       1.15.5-15.el7                  base     
kbd-misc.noarch                         1.15.5-15.el7                  base     
kernel.x86_64                           3.10.0-1062.12.1.el7           updates  
kernel-headers.x86_64                   3.10.0-1062.12.1.el7           updates  
kernel-tools.x86_64                     3.10.0-1062.12.1.el7           updates  
kernel-tools-libs.x86_64                3.10.0-1062.12.1.el7           updates  
kexec-tools.x86_64                      2.0.15-33.el7                  base     
kmod.x86_64                             20-25.el7                      base     
kmod-libs.x86_64                        20-25.el7                      base     
kpartx.x86_64                           0.4.9-127.el7                  base     
krb5-libs.x86_64                        1.15.1-37.el7_7.2              updates  
libbasicobjects.x86_64                  0.1.1-32.el7                   base     
libblkid.x86_64                         2.23.2-61.el7_7.1              updates  
libcap.x86_64                           2.22-10.el7                    base     
libcgroup.x86_64                        0.41-21.el7                    base     
libcollection.x86_64                    0.7.0-32.el7                   base     
libcom_err.x86_64                       1.42.9-16.el7                  base     
libcroco.x86_64                         0.6.12-4.el7                   base     
libcurl.x86_64                          7.29.0-54.el7_7.2              updates  
libfastjson.x86_64                      0.99.4-3.el7                   base     
libini_config.x86_64                    1.3.1-32.el7                   base     
libmount.x86_64                         2.23.2-61.el7_7.1              updates  
libndp.x86_64                           1.2-9.el7                      base     
libpath_utils.x86_64                    0.2.1-32.el7                   base     
libref_array.x86_64                     0.1.5-32.el7                   base     
libselinux.x86_64                       2.5-14.1.el7                   base     
libselinux-python.x86_64                2.5-14.1.el7                   base     
libselinux-utils.x86_64                 2.5-14.1.el7                   base     
libsemanage.x86_64                      2.5-14.el7                     base     
libsemanage-python.x86_64               2.5-14.el7                     base     
libsepol.x86_64                         2.5-10.el7                     base     
libss.x86_64                            1.42.9-16.el7                  base     
libssh2.x86_64                          1.8.0-3.el7                    base     
libstdc++.x86_64                        4.8.5-39.el7                   base     
libteam.x86_64                          1.27-9.el7                     base     
libuuid.x86_64                          2.23.2-61.el7_7.1              updates  
logrotate.x86_64                        3.8.6-17.el7                   base     
lshw.x86_64                             B.02.18-13.el7                 base     
lz4.x86_64                              1.7.5-3.el7                    base     
make.x86_64                             1:3.82-24.el7                  base     
man-db.x86_64                           2.6.3-11.el7                   base     
mariadb-libs.x86_64                     1:5.5.64-1.el7                 base     
mesa-libEGL.x86_64                      18.3.4-6.el7_7                 updates  
mesa-libGL.x86_64                       18.3.4-6.el7_7                 updates  
mesa-libgbm.x86_64                      18.3.4-6.el7_7                 updates  
mesa-libglapi.x86_64                    18.3.4-6.el7_7                 updates  
microcode_ctl.x86_64                    2:2.1-53.7.el7_7               updates  
net-tools.x86_64                        2.0-0.25.20131004git.el7       base     
nfs-utils.x86_64                        1:1.3.0-0.65.el7               base     
nspr.x86_64                             4.21.0-1.el7                   base     
nss.x86_64                              3.44.0-7.el7_7                 updates  
nss-pem.x86_64                          1.0.3-7.el7                    base     
nss-softokn.x86_64                      3.44.0-8.el7_7                 updates  
nss-softokn-freebl.x86_64               3.44.0-8.el7_7                 updates  
nss-sysinit.x86_64                      3.44.0-7.el7_7                 updates  
nss-tools.x86_64                        3.44.0-7.el7_7                 updates  
nss-util.x86_64                         3.44.0-4.el7_7                 updates  
numactl-libs.x86_64                     2.0.12-3.el7_7.1               updates  
openjpeg2.x86_64                        2.3.1-2.el7_7                  updates  
openldap.x86_64                         2.4.44-21.el7_6                base     
openssh.x86_64                          7.4p1-21.el7                   base     
openssh-clients.x86_64                  7.4p1-21.el7                   base     
openssh-server.x86_64                   7.4p1-21.el7                   base     
parted.x86_64                           3.1-31.el7                     base     
passwd.x86_64                           0.79-5.el7                     base     
policycoreutils.x86_64                  2.5-33.el7                     base     
policycoreutils-python.x86_64           2.5-33.el7                     base     
polkit.x86_64                           0.112-22.el7_7.1               updates  
postfix.x86_64                          2:2.10.1-7.el7                 base     
postgresql.x86_64                       9.2.24-2.el7_7                 updates  
postgresql-libs.x86_64                  9.2.24-2.el7_7                 updates  
postgresql-server.x86_64                9.2.24-2.el7_7                 updates  
procps-ng.x86_64                        3.3.10-26.el7_7.1              updates  
python-chardet.noarch                   2.2.1-3.el7                    base     
python-jinja2.noarch                    2.7.2-4.el7                    base     
python-linux-procfs.noarch              0.4.11-4.el7                   base     
python-perf.x86_64                      3.10.0-1062.12.1.el7           updates  
python-requests.noarch                  2.6.0-8.el7_7                  updates  
python-urlgrabber.noarch                3.10-9.el7                     base     
python-urllib3.noarch                   1.10.2-7.el7                   base     
qemu-guest-agent.x86_64                 10:2.12.0-3.el7                base     
quota.x86_64                            1:4.01-19.el7                  base     
quota-nls.noarch                        1:4.01-19.el7                  base     
readline.x86_64                         6.2-11.el7                     base     
rpcbind.x86_64                          0.2.0-48.el7                   base     
rpm.x86_64                              4.11.3-40.el7                  base     
rpm-build-libs.x86_64                   4.11.3-40.el7                  base     
rpm-libs.x86_64                         4.11.3-40.el7                  base     
rpm-python.x86_64                       4.11.3-40.el7                  base     
rsync.x86_64                            3.1.2-6.el7_6.1                base     
rsyslog.x86_64                          8.24.0-41.el7_7.2              updates  
selinux-policy.noarch                   3.13.1-252.el7_7.6             updates  
selinux-policy-targeted.noarch          3.13.1-252.el7_7.6             updates  
setools-libs.x86_64                     3.3.8-4.el7                    base     
setup.noarch                            2.8.71-10.el7                  base     
sg3_utils.x86_64                        1.37-18.el7_7.2                updates  
sg3_utils-libs.x86_64                   1.37-18.el7_7.2                updates  
shadow-utils.x86_64                     2:4.6-5.el7                    base     
sqlite.x86_64                           3.7.17-8.el7_7.1               updates  
sudo.x86_64                             1.8.23-4.el7_7.1               updates  
systemd.x86_64                          219-67.el7_7.3                 updates  
systemd-libs.x86_64                     219-67.el7_7.3                 updates  
systemd-sysv.x86_64                     219-67.el7_7.3                 updates  
tar.x86_64                              2:1.26-35.el7                  base     
teamd.x86_64                            1.27-9.el7                     base     
tuned.noarch                            2.11.0-5.el7_7.1               updates  
tzdata.noarch                           2019c-1.el7                    updates  
util-linux.x86_64                       2.23.2-61.el7_7.1              updates  
vim-minimal.x86_64                      2:7.4.629-6.el7                base     
wpa_supplicant.x86_64                   1:2.6-12.el7                   base     
xfsprogs.x86_64                         4.5.0-20.el7                   base     
yum.noarch                              3.4.3-163.el7.centos           base     
yum-plugin-fastestmirror.noarch         1.1.31-52.el7                  base     
yum-utils.noarch                        1.1.31-52.el7                  base     
zlib.x86_64                             1.2.7-18.el7                   base     
Obsoleting Packages
grub2.x86_64                            1:2.02-0.80.el7.centos         base     
    grub2.x86_64                        1:2.02-0.65.el7.centos.2       installed
grub2-tools.x86_64                      1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
grub2-tools-extra.x86_64                1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
grub2-tools-minimal.x86_64              1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
[centos@d-hdp1 ~]$ yum update
Loaded plugins: fastestmirror
You need to be root to perform this command.
[centos@d-hdp1 ~]$ sudo yum check-update
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mozart.ee.ic.ac.uk
 * extras: mozart.ee.ic.ac.uk
 * updates: uk.mirror.nsec.pt
HDP-2.6-GPL-repo-1                                       | 2.9 kB     00:00     
HDP-2.6-repo-1                                           | 2.9 kB     00:00     
HDP-UTILS-1.1.0.22-repo-1                                | 2.9 kB     00:00     
ambari-2.6.2.2                                           | 2.9 kB     00:00     
base                                                     | 3.6 kB     00:00     
extras                                                   | 2.9 kB     00:00     
updates                                                  | 2.9 kB     00:00     
updates/7/x86_64/primary_db                                | 6.7 MB   00:00     

GeoIP.x86_64                            1.5.0-14.el7                   base     
audit.x86_64                            2.8.5-4.el7                    base     
audit-libs.x86_64                       2.8.5-4.el7                    base     
audit-libs-python.x86_64                2.8.5-4.el7                    base     
bash.x86_64                             4.2.46-33.el7                  base     
bind-libs-lite.x86_64                   32:9.11.4-9.P2.el7             base     
bind-license.noarch                     32:9.11.4-9.P2.el7             base     
binutils.x86_64                         2.27-41.base.el7_7.2           updates  
ca-certificates.noarch                  2019.2.32-76.el7_7             updates  
centos-release.x86_64                   7-7.1908.0.el7.centos          base     
checkpolicy.x86_64                      2.5-8.el7                      base     
chrony.x86_64                           3.4-1.el7                      base     
cloud-init.x86_64                       18.5-3.el7.centos              base     
cloud-utils-growpart.noarch             0.29-5.el7                     base     
coreutils.x86_64                        8.22-24.el7                    base     
cronie.x86_64                           1.4.11-23.el7                  base     
cronie-anacron.x86_64                   1.4.11-23.el7                  base     
cryptsetup-libs.x86_64                  2.0.3-5.el7                    base     
curl.x86_64                             7.29.0-54.el7_7.2              updates  
dbus.x86_64                             1:1.10.24-13.el7_6             base     
dbus-libs.x86_64                        1:1.10.24-13.el7_6             base     
device-mapper.x86_64                    7:1.02.158-2.el7_7.2           updates  
device-mapper-libs.x86_64               7:1.02.158-2.el7_7.2           updates  
dhclient.x86_64                         12:4.2.5-77.el7.centos         base     
dhcp-common.x86_64                      12:4.2.5-77.el7.centos         base     
dhcp-libs.x86_64                        12:4.2.5-77.el7.centos         base     
diffutils.x86_64                        3.3-5.el7                      base     
dmidecode.x86_64                        1:3.2-3.el7                    base     
dracut.x86_64                           033-564.el7                    base     
dracut-config-generic.x86_64            033-564.el7                    base     
dracut-config-rescue.x86_64             033-564.el7                    base     
dracut-network.x86_64                   033-564.el7                    base     
e2fsprogs.x86_64                        1.42.9-16.el7                  base     
e2fsprogs-libs.x86_64                   1.42.9-16.el7                  base     
elfutils-default-yama-scope.noarch      0.176-2.el7                    base     
elfutils-libelf.x86_64                  0.176-2.el7                    base     
elfutils-libs.x86_64                    0.176-2.el7                    base     
ethtool.x86_64                          2:4.8-10.el7                   base     
file.x86_64                             5.11-35.el7                    base     
file-libs.x86_64                        5.11-35.el7                    base     
findutils.x86_64                        1:4.5.11-6.el7                 base     
gnupg2.x86_64                           2.0.22-5.el7_5                 base     
gobject-introspection.x86_64            1.56.1-1.el7                   base     
grub2.x86_64                            1:2.02-0.80.el7.centos         base     
grub2-common.noarch                     1:2.02-0.80.el7.centos         base     
grub2-pc.x86_64                         1:2.02-0.80.el7.centos         base     
grub2-pc-modules.noarch                 1:2.02-0.80.el7.centos         base     
grub2-tools.x86_64                      1:2.02-0.80.el7.centos         base     
grub2-tools-extra.x86_64                1:2.02-0.80.el7.centos         base     
grub2-tools-minimal.x86_64              1:2.02-0.80.el7.centos         base     
grubby.x86_64                           8.28-26.el7                    base     
gssproxy.x86_64                         0.7.0-26.el7                   base     
hostname.x86_64                         3.13-3.el7_7.1                 updates  
hwdata.x86_64                           0.252-9.3.el7                  base     
initscripts.x86_64                      9.49.47-1.el7                  base     
iproute.x86_64                          4.11.0-25.el7_7.2              updates  
iptables.x86_64                         1.4.21-33.el7                  base     
irqbalance.x86_64                       3:1.0.7-12.el7                 base     
iwl7265-firmware.noarch                 22.0.7.0-72.el7                base     
kbd.x86_64                              1.15.5-15.el7                  base     
kbd-legacy.noarch                       1.15.5-15.el7                  base     
kbd-misc.noarch                         1.15.5-15.el7                  base     
kernel.x86_64                           3.10.0-1062.12.1.el7           updates  
kernel-headers.x86_64                   3.10.0-1062.12.1.el7           updates  
kernel-tools.x86_64                     3.10.0-1062.12.1.el7           updates  
kernel-tools-libs.x86_64                3.10.0-1062.12.1.el7           updates  
kexec-tools.x86_64                      2.0.15-33.el7                  base     
kmod.x86_64                             20-25.el7                      base     
kmod-libs.x86_64                        20-25.el7                      base     
kpartx.x86_64                           0.4.9-127.el7                  base     
krb5-libs.x86_64                        1.15.1-37.el7_7.2              updates  
libbasicobjects.x86_64                  0.1.1-32.el7                   base     
libblkid.x86_64                         2.23.2-61.el7_7.1              updates  
libcap.x86_64                           2.22-10.el7                    base     
libcgroup.x86_64                        0.41-21.el7                    base     
libcollection.x86_64                    0.7.0-32.el7                   base     
libcom_err.x86_64                       1.42.9-16.el7                  base     
libcroco.x86_64                         0.6.12-4.el7                   base     
libcurl.x86_64                          7.29.0-54.el7_7.2              updates  
libfastjson.x86_64                      0.99.4-3.el7                   base     
libini_config.x86_64                    1.3.1-32.el7                   base     
libmount.x86_64                         2.23.2-61.el7_7.1              updates  
libndp.x86_64                           1.2-9.el7                      base     
libpath_utils.x86_64                    0.2.1-32.el7                   base     
libref_array.x86_64                     0.1.5-32.el7                   base     
libselinux.x86_64                       2.5-14.1.el7                   base     
libselinux-python.x86_64                2.5-14.1.el7                   base     
libselinux-utils.x86_64                 2.5-14.1.el7                   base     
libsemanage.x86_64                      2.5-14.el7                     base     
libsemanage-python.x86_64               2.5-14.el7                     base     
libsepol.x86_64                         2.5-10.el7                     base     
libss.x86_64                            1.42.9-16.el7                  base     
libssh2.x86_64                          1.8.0-3.el7                    base     
libstdc++.x86_64                        4.8.5-39.el7                   base     
libteam.x86_64                          1.27-9.el7                     base     
libuuid.x86_64                          2.23.2-61.el7_7.1              updates  
logrotate.x86_64                        3.8.6-17.el7                   base     
lshw.x86_64                             B.02.18-13.el7                 base     
lz4.x86_64                              1.7.5-3.el7                    base     
make.x86_64                             1:3.82-24.el7                  base     
man-db.x86_64                           2.6.3-11.el7                   base     
mariadb-libs.x86_64                     1:5.5.64-1.el7                 base     
mesa-libEGL.x86_64                      18.3.4-6.el7_7                 updates  
mesa-libGL.x86_64                       18.3.4-6.el7_7                 updates  
mesa-libgbm.x86_64                      18.3.4-6.el7_7                 updates  
mesa-libglapi.x86_64                    18.3.4-6.el7_7                 updates  
microcode_ctl.x86_64                    2:2.1-53.7.el7_7               updates  
net-tools.x86_64                        2.0-0.25.20131004git.el7       base     
nfs-utils.x86_64                        1:1.3.0-0.65.el7               base     
nspr.x86_64                             4.21.0-1.el7                   base     
nss.x86_64                              3.44.0-7.el7_7                 updates  
nss-pem.x86_64                          1.0.3-7.el7                    base     
nss-softokn.x86_64                      3.44.0-8.el7_7                 updates  
nss-softokn-freebl.x86_64               3.44.0-8.el7_7                 updates  
nss-sysinit.x86_64                      3.44.0-7.el7_7                 updates  
nss-tools.x86_64                        3.44.0-7.el7_7                 updates  
nss-util.x86_64                         3.44.0-4.el7_7                 updates  
numactl-libs.x86_64                     2.0.12-3.el7_7.1               updates  
openjpeg2.x86_64                        2.3.1-2.el7_7                  updates  
openldap.x86_64                         2.4.44-21.el7_6                base     
openssh.x86_64                          7.4p1-21.el7                   base     
openssh-clients.x86_64                  7.4p1-21.el7                   base     
openssh-server.x86_64                   7.4p1-21.el7                   base     
parted.x86_64                           3.1-31.el7                     base     
passwd.x86_64                           0.79-5.el7                     base     
policycoreutils.x86_64                  2.5-33.el7                     base     
policycoreutils-python.x86_64           2.5-33.el7                     base     
polkit.x86_64                           0.112-22.el7_7.1               updates  
postfix.x86_64                          2:2.10.1-7.el7                 base     
postgresql.x86_64                       9.2.24-2.el7_7                 updates  
postgresql-libs.x86_64                  9.2.24-2.el7_7                 updates  
postgresql-server.x86_64                9.2.24-2.el7_7                 updates  
procps-ng.x86_64                        3.3.10-26.el7_7.1              updates  
python-chardet.noarch                   2.2.1-3.el7                    base     
python-jinja2.noarch                    2.7.2-4.el7                    base     
python-linux-procfs.noarch              0.4.11-4.el7                   base     
python-perf.x86_64                      3.10.0-1062.12.1.el7           updates  
python-requests.noarch                  2.6.0-8.el7_7                  updates  
python-urlgrabber.noarch                3.10-9.el7                     base     
python-urllib3.noarch                   1.10.2-7.el7                   base     
qemu-guest-agent.x86_64                 10:2.12.0-3.el7                base     
quota.x86_64                            1:4.01-19.el7                  base     
quota-nls.noarch                        1:4.01-19.el7                  base     
readline.x86_64                         6.2-11.el7                     base     
rpcbind.x86_64                          0.2.0-48.el7                   base     
rpm.x86_64                              4.11.3-40.el7                  base     
rpm-build-libs.x86_64                   4.11.3-40.el7                  base     
rpm-libs.x86_64                         4.11.3-40.el7                  base     
rpm-python.x86_64                       4.11.3-40.el7                  base     
rsync.x86_64                            3.1.2-6.el7_6.1                base     
rsyslog.x86_64                          8.24.0-41.el7_7.2              updates  
selinux-policy.noarch                   3.13.1-252.el7_7.6             updates  
selinux-policy-targeted.noarch          3.13.1-252.el7_7.6             updates  
setools-libs.x86_64                     3.3.8-4.el7                    base     
setup.noarch                            2.8.71-10.el7                  base     
sg3_utils.x86_64                        1.37-18.el7_7.2                updates  
sg3_utils-libs.x86_64                   1.37-18.el7_7.2                updates  
shadow-utils.x86_64                     2:4.6-5.el7                    base     
sqlite.x86_64                           3.7.17-8.el7_7.1               updates  
sudo.x86_64                             1.8.23-4.el7_7.1               updates  
systemd.x86_64                          219-67.el7_7.3                 updates  
systemd-libs.x86_64                     219-67.el7_7.3                 updates  
systemd-sysv.x86_64                     219-67.el7_7.3                 updates  
tar.x86_64                              2:1.26-35.el7                  base     
teamd.x86_64                            1.27-9.el7                     base     
tuned.noarch                            2.11.0-5.el7_7.1               updates  
tzdata.noarch                           2019c-1.el7                    updates  
util-linux.x86_64                       2.23.2-61.el7_7.1              updates  
vim-minimal.x86_64                      2:7.4.629-6.el7                base     
wpa_supplicant.x86_64                   1:2.6-12.el7                   base     
xfsprogs.x86_64                         4.5.0-20.el7                   base     
yum.noarch                              3.4.3-163.el7.centos           base     
yum-plugin-fastestmirror.noarch         1.1.31-52.el7                  base     
yum-utils.noarch                        1.1.31-52.el7                  base     
zlib.x86_64                             1.2.7-18.el7                   base     
Obsoleting Packages
grub2.x86_64                            1:2.02-0.80.el7.centos         base     
    grub2.x86_64                        1:2.02-0.65.el7.centos.2       installed
grub2-tools.x86_64                      1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
grub2-tools-extra.x86_64                1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
grub2-tools-minimal.x86_64              1:2.02-0.80.el7.centos         base     
    grub2-tools.x86_64                  1:2.02-0.65.el7.centos.2       installed
[centos@d-hdp1 ~]$ sudo yum update
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mozart.ee.ic.ac.uk
 * extras: mozart.ee.ic.ac.uk
 * updates: uk.mirror.nsec.pt
Resolving Dependencies
--> Running transaction check
---> Package GeoIP.x86_64 0:1.5.0-11.el7 will be updated
---> Package GeoIP.x86_64 0:1.5.0-14.el7 will be an update
--> Processing Dependency: geoipupdate for package: GeoIP-1.5.0-14.el7.x86_64
---> Package audit.x86_64 0:2.8.1-3.el7 will be updated
---> Package audit.x86_64 0:2.8.5-4.el7 will be an update
---> Package audit-libs.x86_64 0:2.8.1-3.el7 will be updated
---> Package audit-libs.x86_64 0:2.8.5-4.el7 will be an update
---> Package audit-libs-python.x86_64 0:2.8.1-3.el7 will be updated
---> Package audit-libs-python.x86_64 0:2.8.5-4.el7 will be an update
---> Package bash.x86_64 0:4.2.46-30.el7 will be updated
---> Package bash.x86_64 0:4.2.46-33.el7 will be an update
---> Package bind-libs-lite.x86_64 32:9.9.4-61.el7 will be updated
---> Package bind-libs-lite.x86_64 32:9.11.4-9.P2.el7 will be an update
---> Package bind-license.noarch 32:9.9.4-61.el7 will be updated
---> Package bind-license.noarch 32:9.11.4-9.P2.el7 will be an update
---> Package binutils.x86_64 0:2.27-27.base.el7 will be updated
---> Package binutils.x86_64 0:2.27-41.base.el7_7.2 will be an update
---> Package ca-certificates.noarch 0:2018.2.22-70.0.el7_5 will be updated
---> Package ca-certificates.noarch 0:2019.2.32-76.el7_7 will be an update
---> Package centos-release.x86_64 0:7-5.1804.el7.centos.2 will be updated
---> Package centos-release.x86_64 0:7-7.1908.0.el7.centos will be an update
---> Package checkpolicy.x86_64 0:2.5-6.el7 will be updated
---> Package checkpolicy.x86_64 0:2.5-8.el7 will be an update
---> Package chrony.x86_64 0:3.2-2.el7 will be updated
---> Package chrony.x86_64 0:3.4-1.el7 will be an update
---> Package cloud-init.x86_64 0:0.7.9-24.el7.centos will be updated
---> Package cloud-init.x86_64 0:18.5-3.el7.centos will be an update
---> Package cloud-utils-growpart.noarch 0:0.29-2.el7 will be updated
---> Package cloud-utils-growpart.noarch 0:0.29-5.el7 will be an update
---> Package coreutils.x86_64 0:8.22-21.el7 will be updated
---> Package coreutils.x86_64 0:8.22-24.el7 will be an update
---> Package cronie.x86_64 0:1.4.11-19.el7 will be updated
---> Package cronie.x86_64 0:1.4.11-23.el7 will be an update
---> Package cronie-anacron.x86_64 0:1.4.11-19.el7 will be updated
---> Package cronie-anacron.x86_64 0:1.4.11-23.el7 will be an update
---> Package cryptsetup-libs.x86_64 0:1.7.4-4.el7 will be updated
---> Package cryptsetup-libs.x86_64 0:2.0.3-5.el7 will be an update
--> Processing Dependency: libjson-c.so.2()(64bit) for package: cryptsetup-libs-2.0.3-5.el7.x86_64
---> Package curl.x86_64 0:7.29.0-46.el7 will be updated
---> Package curl.x86_64 0:7.29.0-54.el7_7.2 will be an update
---> Package dbus.x86_64 1:1.10.24-7.el7 will be updated
---> Package dbus.x86_64 1:1.10.24-13.el7_6 will be an update
---> Package dbus-libs.x86_64 1:1.10.24-7.el7 will be updated
---> Package dbus-libs.x86_64 1:1.10.24-13.el7_6 will be an update
---> Package device-mapper.x86_64 7:1.02.146-4.el7 will be updated
---> Package device-mapper.x86_64 7:1.02.158-2.el7_7.2 will be an update
---> Package device-mapper-libs.x86_64 7:1.02.146-4.el7 will be updated
---> Package device-mapper-libs.x86_64 7:1.02.158-2.el7_7.2 will be an update
---> Package dhclient.x86_64 12:4.2.5-68.el7.centos.1 will be updated
---> Package dhclient.x86_64 12:4.2.5-77.el7.centos will be an update
--> Processing Dependency: libisc-export.so.169()(64bit) for package: 12:dhclient-4.2.5-77.el7.centos.x86_64
--> Processing Dependency: libdns-export.so.1102()(64bit) for package: 12:dhclient-4.2.5-77.el7.centos.x86_64
---> Package dhcp-common.x86_64 12:4.2.5-68.el7.centos.1 will be updated
---> Package dhcp-common.x86_64 12:4.2.5-77.el7.centos will be an update
---> Package dhcp-libs.x86_64 12:4.2.5-68.el7.centos.1 will be updated
---> Package dhcp-libs.x86_64 12:4.2.5-77.el7.centos will be an update
---> Package diffutils.x86_64 0:3.3-4.el7 will be updated
---> Package diffutils.x86_64 0:3.3-5.el7 will be an update
---> Package dmidecode.x86_64 1:3.0-5.el7 will be updated
---> Package dmidecode.x86_64 1:3.2-3.el7 will be an update
---> Package dracut.x86_64 0:033-535.el7 will be updated
---> Package dracut.x86_64 0:033-564.el7 will be an update
---> Package dracut-config-generic.x86_64 0:033-535.el7 will be updated
---> Package dracut-config-generic.x86_64 0:033-564.el7 will be an update
---> Package dracut-config-rescue.x86_64 0:033-535.el7 will be updated
---> Package dracut-config-rescue.x86_64 0:033-564.el7 will be an update
---> Package dracut-network.x86_64 0:033-535.el7 will be updated
---> Package dracut-network.x86_64 0:033-564.el7 will be an update
---> Package e2fsprogs.x86_64 0:1.42.9-12.el7_5 will be updated
---> Package e2fsprogs.x86_64 0:1.42.9-16.el7 will be an update
---> Package e2fsprogs-libs.x86_64 0:1.42.9-12.el7_5 will be updated
---> Package e2fsprogs-libs.x86_64 0:1.42.9-16.el7 will be an update
---> Package elfutils-default-yama-scope.noarch 0:0.170-4.el7 will be updated
---> Package elfutils-default-yama-scope.noarch 0:0.176-2.el7 will be an update
---> Package elfutils-libelf.x86_64 0:0.170-4.el7 will be updated
---> Package elfutils-libelf.x86_64 0:0.176-2.el7 will be an update
---> Package elfutils-libs.x86_64 0:0.170-4.el7 will be updated
---> Package elfutils-libs.x86_64 0:0.176-2.el7 will be an update
---> Package ethtool.x86_64 2:4.8-7.el7 will be updated
---> Package ethtool.x86_64 2:4.8-10.el7 will be an update
---> Package file.x86_64 0:5.11-33.el7 will be updated
---> Package file.x86_64 0:5.11-35.el7 will be an update
---> Package file-libs.x86_64 0:5.11-33.el7 will be updated
---> Package file-libs.x86_64 0:5.11-35.el7 will be an update
---> Package findutils.x86_64 1:4.5.11-5.el7 will be updated
---> Package findutils.x86_64 1:4.5.11-6.el7 will be an update
---> Package gnupg2.x86_64 0:2.0.22-4.el7 will be updated
---> Package gnupg2.x86_64 0:2.0.22-5.el7_5 will be an update
---> Package gobject-introspection.x86_64 0:1.50.0-1.el7 will be updated
---> Package gobject-introspection.x86_64 0:1.56.1-1.el7 will be an update
---> Package grub2.x86_64 1:2.02-0.65.el7.centos.2 will be obsoleted
---> Package grub2.x86_64 1:2.02-0.80.el7.centos will be obsoleting
---> Package grub2-common.noarch 1:2.02-0.65.el7.centos.2 will be updated
---> Package grub2-common.noarch 1:2.02-0.80.el7.centos will be an update
---> Package grub2-pc.x86_64 1:2.02-0.65.el7.centos.2 will be updated
---> Package grub2-pc.x86_64 1:2.02-0.80.el7.centos will be an update
---> Package grub2-pc-modules.noarch 1:2.02-0.65.el7.centos.2 will be updated
---> Package grub2-pc-modules.noarch 1:2.02-0.80.el7.centos will be an update
---> Package grub2-tools.x86_64 1:2.02-0.65.el7.centos.2 will be obsoleted
---> Package grub2-tools.x86_64 1:2.02-0.80.el7.centos will be obsoleting
---> Package grub2-tools-extra.x86_64 1:2.02-0.65.el7.centos.2 will be updated
---> Package grub2-tools-extra.x86_64 1:2.02-0.80.el7.centos will be obsoleting
---> Package grub2-tools-minimal.x86_64 1:2.02-0.65.el7.centos.2 will be updated
---> Package grub2-tools-minimal.x86_64 1:2.02-0.80.el7.centos will be obsoleting
---> Package grubby.x86_64 0:8.28-23.el7 will be updated
---> Package grubby.x86_64 0:8.28-26.el7 will be an update
---> Package gssproxy.x86_64 0:0.7.0-17.el7 will be updated
---> Package gssproxy.x86_64 0:0.7.0-26.el7 will be an update
---> Package hostname.x86_64 0:3.13-3.el7 will be updated
---> Package hostname.x86_64 0:3.13-3.el7_7.1 will be an update
---> Package hwdata.x86_64 0:0.252-8.8.el7 will be updated
---> Package hwdata.x86_64 0:0.252-9.3.el7 will be an update
---> Package initscripts.x86_64 0:9.49.41-1.el7 will be updated
---> Package initscripts.x86_64 0:9.49.47-1.el7 will be an update
---> Package iproute.x86_64 0:4.11.0-14.el7 will be updated
---> Package iproute.x86_64 0:4.11.0-25.el7_7.2 will be an update
---> Package iptables.x86_64 0:1.4.21-24.1.el7_5 will be updated
---> Package iptables.x86_64 0:1.4.21-33.el7 will be an update
---> Package irqbalance.x86_64 3:1.0.7-11.el7 will be updated
---> Package irqbalance.x86_64 3:1.0.7-12.el7 will be an update
---> Package iwl7265-firmware.noarch 0:22.0.7.0-62.1.el7_5 will be updated
---> Package iwl7265-firmware.noarch 0:22.0.7.0-72.el7 will be an update
---> Package kbd.x86_64 0:1.15.5-13.el7 will be updated
---> Package kbd.x86_64 0:1.15.5-15.el7 will be an update
---> Package kbd-legacy.noarch 0:1.15.5-13.el7 will be updated
---> Package kbd-legacy.noarch 0:1.15.5-15.el7 will be an update
---> Package kbd-misc.noarch 0:1.15.5-13.el7 will be updated
---> Package kbd-misc.noarch 0:1.15.5-15.el7 will be an update
---> Package kernel.x86_64 0:3.10.0-1062.12.1.el7 will be installed
--> Processing Dependency: linux-firmware >= 20190429-72 for package: kernel-3.10.0-1062.12.1.el7.x86_64
---> Package kernel-headers.x86_64 0:3.10.0-1062.9.1.el7 will be updated
---> Package kernel-headers.x86_64 0:3.10.0-1062.12.1.el7 will be an update
---> Package kernel-tools.x86_64 0:3.10.0-862.3.2.el7 will be updated
---> Package kernel-tools.x86_64 0:3.10.0-1062.12.1.el7 will be an update
---> Package kernel-tools-libs.x86_64 0:3.10.0-862.3.2.el7 will be updated
---> Package kernel-tools-libs.x86_64 0:3.10.0-1062.12.1.el7 will be an update
---> Package kexec-tools.x86_64 0:2.0.15-13.el7 will be updated
---> Package kexec-tools.x86_64 0:2.0.15-33.el7 will be an update
---> Package kmod.x86_64 0:20-21.el7 will be updated
---> Package kmod.x86_64 0:20-25.el7 will be an update
---> Package kmod-libs.x86_64 0:20-21.el7 will be updated
---> Package kmod-libs.x86_64 0:20-25.el7 will be an update
---> Package kpartx.x86_64 0:0.4.9-119.el7 will be updated
---> Package kpartx.x86_64 0:0.4.9-127.el7 will be an update
---> Package krb5-libs.x86_64 0:1.15.1-19.el7 will be updated
---> Package krb5-libs.x86_64 0:1.15.1-37.el7_7.2 will be an update
---> Package libbasicobjects.x86_64 0:0.1.1-29.el7 will be updated
---> Package libbasicobjects.x86_64 0:0.1.1-32.el7 will be an update
---> Package libblkid.x86_64 0:2.23.2-52.el7 will be updated
---> Package libblkid.x86_64 0:2.23.2-61.el7_7.1 will be an update
---> Package libcap.x86_64 0:2.22-9.el7 will be updated
---> Package libcap.x86_64 0:2.22-10.el7 will be an update
---> Package libcgroup.x86_64 0:0.41-15.el7 will be updated
---> Package libcgroup.x86_64 0:0.41-21.el7 will be an update
---> Package libcollection.x86_64 0:0.7.0-29.el7 will be updated
---> Package libcollection.x86_64 0:0.7.0-32.el7 will be an update
---> Package libcom_err.x86_64 0:1.42.9-12.el7_5 will be updated
---> Package libcom_err.x86_64 0:1.42.9-16.el7 will be an update
---> Package libcroco.x86_64 0:0.6.11-1.el7 will be updated
---> Package libcroco.x86_64 0:0.6.12-4.el7 will be an update
---> Package libcurl.x86_64 0:7.29.0-46.el7 will be updated
---> Package libcurl.x86_64 0:7.29.0-54.el7_7.2 will be an update
---> Package libfastjson.x86_64 0:0.99.4-2.el7 will be updated
---> Package libfastjson.x86_64 0:0.99.4-3.el7 will be an update
---> Package libini_config.x86_64 0:1.3.1-29.el7 will be updated
---> Package libini_config.x86_64 0:1.3.1-32.el7 will be an update
---> Package libmount.x86_64 0:2.23.2-52.el7 will be updated
---> Package libmount.x86_64 0:2.23.2-61.el7_7.1 will be an update
---> Package libndp.x86_64 0:1.2-7.el7 will be updated
---> Package libndp.x86_64 0:1.2-9.el7 will be an update
---> Package libpath_utils.x86_64 0:0.2.1-29.el7 will be updated
---> Package libpath_utils.x86_64 0:0.2.1-32.el7 will be an update
---> Package libref_array.x86_64 0:0.1.5-29.el7 will be updated
---> Package libref_array.x86_64 0:0.1.5-32.el7 will be an update
---> Package libselinux.x86_64 0:2.5-12.el7 will be updated
---> Package libselinux.x86_64 0:2.5-14.1.el7 will be an update
---> Package libselinux-python.x86_64 0:2.5-12.el7 will be updated
---> Package libselinux-python.x86_64 0:2.5-14.1.el7 will be an update
---> Package libselinux-utils.x86_64 0:2.5-12.el7 will be updated
---> Package libselinux-utils.x86_64 0:2.5-14.1.el7 will be an update
---> Package libsemanage.x86_64 0:2.5-11.el7 will be updated
---> Package libsemanage.x86_64 0:2.5-14.el7 will be an update
---> Package libsemanage-python.x86_64 0:2.5-11.el7 will be updated
---> Package libsemanage-python.x86_64 0:2.5-14.el7 will be an update
---> Package libsepol.x86_64 0:2.5-8.1.el7 will be updated
---> Package libsepol.x86_64 0:2.5-10.el7 will be an update
---> Package libss.x86_64 0:1.42.9-12.el7_5 will be updated
---> Package libss.x86_64 0:1.42.9-16.el7 will be an update
---> Package libssh2.x86_64 0:1.4.3-10.el7_2.1 will be updated
---> Package libssh2.x86_64 0:1.8.0-3.el7 will be an update
---> Package libstdc++.x86_64 0:4.8.5-28.el7_5.1 will be updated
---> Package libstdc++.x86_64 0:4.8.5-39.el7 will be an update
---> Package libteam.x86_64 0:1.27-4.el7 will be updated
---> Package libteam.x86_64 0:1.27-9.el7 will be an update
---> Package libuuid.x86_64 0:2.23.2-52.el7 will be updated
---> Package libuuid.x86_64 0:2.23.2-61.el7_7.1 will be an update
---> Package logrotate.x86_64 0:3.8.6-15.el7 will be updated
---> Package logrotate.x86_64 0:3.8.6-17.el7 will be an update
---> Package lshw.x86_64 0:B.02.18-12.el7 will be updated
---> Package lshw.x86_64 0:B.02.18-13.el7 will be an update
---> Package lz4.x86_64 0:1.7.5-2.el7 will be updated
---> Package lz4.x86_64 0:1.7.5-3.el7 will be an update
---> Package make.x86_64 1:3.82-23.el7 will be updated
---> Package make.x86_64 1:3.82-24.el7 will be an update
---> Package man-db.x86_64 0:2.6.3-9.el7 will be updated
---> Package man-db.x86_64 0:2.6.3-11.el7 will be an update
---> Package mariadb-libs.x86_64 1:5.5.56-2.el7 will be updated
---> Package mariadb-libs.x86_64 1:5.5.64-1.el7 will be an update
---> Package mesa-libEGL.x86_64 0:18.3.4-5.el7 will be updated
---> Package mesa-libEGL.x86_64 0:18.3.4-6.el7_7 will be an update
---> Package mesa-libGL.x86_64 0:18.3.4-5.el7 will be updated
---> Package mesa-libGL.x86_64 0:18.3.4-6.el7_7 will be an update
---> Package mesa-libgbm.x86_64 0:18.3.4-5.el7 will be updated
---> Package mesa-libgbm.x86_64 0:18.3.4-6.el7_7 will be an update
---> Package mesa-libglapi.x86_64 0:18.3.4-5.el7 will be updated
---> Package mesa-libglapi.x86_64 0:18.3.4-6.el7_7 will be an update
---> Package microcode_ctl.x86_64 2:2.1-29.2.el7_5 will be updated
---> Package microcode_ctl.x86_64 2:2.1-53.7.el7_7 will be an update
---> Package net-tools.x86_64 0:2.0-0.22.20131004git.el7 will be updated
---> Package net-tools.x86_64 0:2.0-0.25.20131004git.el7 will be an update
---> Package nfs-utils.x86_64 1:1.3.0-0.54.el7 will be updated
---> Package nfs-utils.x86_64 1:1.3.0-0.65.el7 will be an update
---> Package nspr.x86_64 0:4.19.0-1.el7_5 will be updated
---> Package nspr.x86_64 0:4.21.0-1.el7 will be an update
---> Package nss.x86_64 0:3.36.0-5.el7_5 will be updated
---> Package nss.x86_64 0:3.44.0-7.el7_7 will be an update
---> Package nss-pem.x86_64 0:1.0.3-4.el7 will be updated
---> Package nss-pem.x86_64 0:1.0.3-7.el7 will be an update
---> Package nss-softokn.x86_64 0:3.36.0-5.el7_5 will be updated
---> Package nss-softokn.x86_64 0:3.44.0-8.el7_7 will be an update
---> Package nss-softokn-freebl.x86_64 0:3.36.0-5.el7_5 will be updated
---> Package nss-softokn-freebl.x86_64 0:3.44.0-8.el7_7 will be an update
---> Package nss-sysinit.x86_64 0:3.36.0-5.el7_5 will be updated
---> Package nss-sysinit.x86_64 0:3.44.0-7.el7_7 will be an update
---> Package nss-tools.x86_64 0:3.36.0-5.el7_5 will be updated
---> Package nss-tools.x86_64 0:3.44.0-7.el7_7 will be an update
---> Package nss-util.x86_64 0:3.36.0-1.el7_5 will be updated
---> Package nss-util.x86_64 0:3.44.0-4.el7_7 will be an update
---> Package numactl-libs.x86_64 0:2.0.9-7.el7 will be updated
---> Package numactl-libs.x86_64 0:2.0.12-3.el7_7.1 will be an update
---> Package openjpeg2.x86_64 0:2.3.1-1.el7 will be updated
---> Package openjpeg2.x86_64 0:2.3.1-2.el7_7 will be an update
---> Package openldap.x86_64 0:2.4.44-15.el7_5 will be updated
---> Package openldap.x86_64 0:2.4.44-21.el7_6 will be an update
---> Package openssh.x86_64 0:7.4p1-16.el7 will be updated
---> Package openssh.x86_64 0:7.4p1-21.el7 will be an update
---> Package openssh-clients.x86_64 0:7.4p1-16.el7 will be updated
---> Package openssh-clients.x86_64 0:7.4p1-21.el7 will be an update
---> Package openssh-server.x86_64 0:7.4p1-16.el7 will be updated
---> Package openssh-server.x86_64 0:7.4p1-21.el7 will be an update
---> Package parted.x86_64 0:3.1-29.el7 will be updated
---> Package parted.x86_64 0:3.1-31.el7 will be an update
---> Package passwd.x86_64 0:0.79-4.el7 will be updated
---> Package passwd.x86_64 0:0.79-5.el7 will be an update
---> Package policycoreutils.x86_64 0:2.5-22.el7 will be updated
---> Package policycoreutils.x86_64 0:2.5-33.el7 will be an update
---> Package policycoreutils-python.x86_64 0:2.5-22.el7 will be updated
---> Package policycoreutils-python.x86_64 0:2.5-33.el7 will be an update
---> Package polkit.x86_64 0:0.112-14.el7 will be updated
---> Package polkit.x86_64 0:0.112-22.el7_7.1 will be an update
---> Package postfix.x86_64 2:2.10.1-6.el7 will be updated
---> Package postfix.x86_64 2:2.10.1-7.el7 will be an update
---> Package postgresql.x86_64 0:9.2.24-1.el7_5 will be updated
---> Package postgresql.x86_64 0:9.2.24-2.el7_7 will be an update
---> Package postgresql-libs.x86_64 0:9.2.24-1.el7_5 will be updated
---> Package postgresql-libs.x86_64 0:9.2.24-2.el7_7 will be an update
---> Package postgresql-server.x86_64 0:9.2.24-1.el7_5 will be updated
---> Package postgresql-server.x86_64 0:9.2.24-2.el7_7 will be an update
---> Package procps-ng.x86_64 0:3.3.10-17.el7_5.2 will be updated
---> Package procps-ng.x86_64 0:3.3.10-26.el7_7.1 will be an update
---> Package python-chardet.noarch 0:2.2.1-1.el7_1 will be updated
---> Package python-chardet.noarch 0:2.2.1-3.el7 will be an update
---> Package python-jinja2.noarch 0:2.7.2-2.el7 will be updated
---> Package python-jinja2.noarch 0:2.7.2-4.el7 will be an update
---> Package python-linux-procfs.noarch 0:0.4.9-3.el7 will be updated
---> Package python-linux-procfs.noarch 0:0.4.11-4.el7 will be an update
---> Package python-perf.x86_64 0:3.10.0-862.3.2.el7 will be updated
---> Package python-perf.x86_64 0:3.10.0-1062.12.1.el7 will be an update
---> Package python-requests.noarch 0:2.6.0-1.el7_1 will be updated
---> Package python-requests.noarch 0:2.6.0-8.el7_7 will be an update
---> Package python-urlgrabber.noarch 0:3.10-8.el7 will be updated
---> Package python-urlgrabber.noarch 0:3.10-9.el7 will be an update
---> Package python-urllib3.noarch 0:1.10.2-5.el7 will be updated
---> Package python-urllib3.noarch 0:1.10.2-7.el7 will be an update
---> Package qemu-guest-agent.x86_64 10:2.8.0-2.el7 will be updated
---> Package qemu-guest-agent.x86_64 10:2.12.0-3.el7 will be an update
---> Package quota.x86_64 1:4.01-17.el7 will be updated
---> Package quota.x86_64 1:4.01-19.el7 will be an update
---> Package quota-nls.noarch 1:4.01-17.el7 will be updated
---> Package quota-nls.noarch 1:4.01-19.el7 will be an update
---> Package readline.x86_64 0:6.2-10.el7 will be updated
---> Package readline.x86_64 0:6.2-11.el7 will be an update
---> Package rpcbind.x86_64 0:0.2.0-44.el7 will be updated
---> Package rpcbind.x86_64 0:0.2.0-48.el7 will be an update
---> Package rpm.x86_64 0:4.11.3-32.el7 will be updated
---> Package rpm.x86_64 0:4.11.3-40.el7 will be an update
---> Package rpm-build-libs.x86_64 0:4.11.3-32.el7 will be updated
---> Package rpm-build-libs.x86_64 0:4.11.3-40.el7 will be an update
---> Package rpm-libs.x86_64 0:4.11.3-32.el7 will be updated
---> Package rpm-libs.x86_64 0:4.11.3-40.el7 will be an update
---> Package rpm-python.x86_64 0:4.11.3-32.el7 will be updated
---> Package rpm-python.x86_64 0:4.11.3-40.el7 will be an update
---> Package rsync.x86_64 0:3.1.2-4.el7 will be updated
---> Package rsync.x86_64 0:3.1.2-6.el7_6.1 will be an update
---> Package rsyslog.x86_64 0:8.24.0-16.el7_5.4 will be updated
---> Package rsyslog.x86_64 0:8.24.0-41.el7_7.2 will be an update
---> Package selinux-policy.noarch 0:3.13.1-192.el7_5.3 will be updated
---> Package selinux-policy.noarch 0:3.13.1-252.el7_7.6 will be an update
---> Package selinux-policy-targeted.noarch 0:3.13.1-192.el7_5.3 will be updated
---> Package selinux-policy-targeted.noarch 0:3.13.1-252.el7_7.6 will be an update
---> Package setools-libs.x86_64 0:3.3.8-2.el7 will be updated
---> Package setools-libs.x86_64 0:3.3.8-4.el7 will be an update
---> Package setup.noarch 0:2.8.71-9.el7 will be updated
---> Package setup.noarch 0:2.8.71-10.el7 will be an update
---> Package sg3_utils.x86_64 0:1.37-12.el7 will be updated
---> Package sg3_utils.x86_64 0:1.37-18.el7_7.2 will be an update
---> Package sg3_utils-libs.x86_64 0:1.37-12.el7 will be updated
---> Package sg3_utils-libs.x86_64 0:1.37-18.el7_7.2 will be an update
---> Package shadow-utils.x86_64 2:4.1.5.1-24.el7 will be updated
---> Package shadow-utils.x86_64 2:4.6-5.el7 will be an update
---> Package sqlite.x86_64 0:3.7.17-8.el7 will be updated
---> Package sqlite.x86_64 0:3.7.17-8.el7_7.1 will be an update
---> Package sudo.x86_64 0:1.8.19p2-13.el7 will be updated
---> Package sudo.x86_64 0:1.8.23-4.el7_7.1 will be an update
---> Package systemd.x86_64 0:219-57.el7 will be updated
---> Package systemd.x86_64 0:219-67.el7_7.3 will be an update
---> Package systemd-libs.x86_64 0:219-57.el7 will be updated
---> Package systemd-libs.x86_64 0:219-67.el7_7.3 will be an update
---> Package systemd-sysv.x86_64 0:219-57.el7 will be updated
---> Package systemd-sysv.x86_64 0:219-67.el7_7.3 will be an update
---> Package tar.x86_64 2:1.26-34.el7 will be updated
---> Package tar.x86_64 2:1.26-35.el7 will be an update
---> Package teamd.x86_64 0:1.27-4.el7 will be updated
---> Package teamd.x86_64 0:1.27-9.el7 will be an update
---> Package tuned.noarch 0:2.9.0-1.el7 will be updated
---> Package tuned.noarch 0:2.11.0-5.el7_7.1 will be an update
---> Package tzdata.noarch 0:2018e-3.el7 will be updated
---> Package tzdata.noarch 0:2019c-1.el7 will be an update
---> Package util-linux.x86_64 0:2.23.2-52.el7 will be updated
---> Package util-linux.x86_64 0:2.23.2-61.el7_7.1 will be an update
--> Processing Dependency: libsmartcols = 2.23.2-61.el7_7.1 for package: util-linux-2.23.2-61.el7_7.1.x86_64
--> Processing Dependency: libsmartcols.so.1(SMARTCOLS_2.25)(64bit) for package: util-linux-2.23.2-61.el7_7.1.x86_64
--> Processing Dependency: libsmartcols.so.1()(64bit) for package: util-linux-2.23.2-61.el7_7.1.x86_64
---> Package vim-minimal.x86_64 2:7.4.160-4.el7 will be updated
---> Package vim-minimal.x86_64 2:7.4.629-6.el7 will be an update
---> Package wpa_supplicant.x86_64 1:2.6-9.el7 will be updated
---> Package wpa_supplicant.x86_64 1:2.6-12.el7 will be an update
---> Package xfsprogs.x86_64 0:4.5.0-15.el7 will be updated
---> Package xfsprogs.x86_64 0:4.5.0-20.el7 will be an update
---> Package yum.noarch 0:3.4.3-158.el7.centos will be updated
---> Package yum.noarch 0:3.4.3-163.el7.centos will be an update
---> Package yum-plugin-fastestmirror.noarch 0:1.1.31-45.el7 will be updated
---> Package yum-plugin-fastestmirror.noarch 0:1.1.31-52.el7 will be an update
---> Package yum-utils.noarch 0:1.1.31-45.el7 will be updated
---> Package yum-utils.noarch 0:1.1.31-52.el7 will be an update
---> Package zlib.x86_64 0:1.2.7-17.el7 will be updated
---> Package zlib.x86_64 0:1.2.7-18.el7 will be an update
--> Running transaction check
---> Package bind-export-libs.x86_64 32:9.11.4-9.P2.el7 will be installed
---> Package geoipupdate.x86_64 0:2.5.0-1.el7 will be installed
---> Package json-c.x86_64 0:0.11-4.el7_0 will be installed
---> Package libsmartcols.x86_64 0:2.23.2-61.el7_7.1 will be installed
---> Package linux-firmware.noarch 0:20190429-72.gitddde598.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

================================================================================
 Package                     Arch   Version                       Repository
                                                                           Size
================================================================================
Installing:
 grub2                       x86_64 1:2.02-0.80.el7.centos        base     32 k
     replacing  grub2.x86_64 1:2.02-0.65.el7.centos.2
 grub2-tools                 x86_64 1:2.02-0.80.el7.centos        base    1.8 M
     replacing  grub2-tools.x86_64 1:2.02-0.65.el7.centos.2
 grub2-tools-extra           x86_64 1:2.02-0.80.el7.centos        base    997 k
     replacing  grub2-tools.x86_64 1:2.02-0.65.el7.centos.2
 grub2-tools-minimal         x86_64 1:2.02-0.80.el7.centos        base    174 k
     replacing  grub2-tools.x86_64 1:2.02-0.65.el7.centos.2
 kernel                      x86_64 3.10.0-1062.12.1.el7          updates  50 M
Updating:
 GeoIP                       x86_64 1.5.0-14.el7                  base    1.5 M
 audit                       x86_64 2.8.5-4.el7                   base    256 k
 audit-libs                  x86_64 2.8.5-4.el7                   base    102 k
 audit-libs-python           x86_64 2.8.5-4.el7                   base     76 k
 bash                        x86_64 4.2.46-33.el7                 base    1.0 M
 bind-libs-lite              x86_64 32:9.11.4-9.P2.el7            base    1.1 M
 bind-license                noarch 32:9.11.4-9.P2.el7            base     88 k
 binutils                    x86_64 2.27-41.base.el7_7.2          updates 5.9 M
 ca-certificates             noarch 2019.2.32-76.el7_7            updates 399 k
 centos-release              x86_64 7-7.1908.0.el7.centos         base     26 k
 checkpolicy                 x86_64 2.5-8.el7                     base    295 k
 chrony                      x86_64 3.4-1.el7                     base    251 k
 cloud-init                  x86_64 18.5-3.el7.centos             base    861 k
 cloud-utils-growpart        noarch 0.29-5.el7                    base     27 k
 coreutils                   x86_64 8.22-24.el7                   base    3.3 M
 cronie                      x86_64 1.4.11-23.el7                 base     92 k
 cronie-anacron              x86_64 1.4.11-23.el7                 base     36 k
 cryptsetup-libs             x86_64 2.0.3-5.el7                   base    338 k
 curl                        x86_64 7.29.0-54.el7_7.2             updates 270 k
 dbus                        x86_64 1:1.10.24-13.el7_6            base    245 k
 dbus-libs                   x86_64 1:1.10.24-13.el7_6            base    169 k
 device-mapper               x86_64 7:1.02.158-2.el7_7.2          updates 294 k
 device-mapper-libs          x86_64 7:1.02.158-2.el7_7.2          updates 322 k
 dhclient                    x86_64 12:4.2.5-77.el7.centos        base    285 k
 dhcp-common                 x86_64 12:4.2.5-77.el7.centos        base    176 k
 dhcp-libs                   x86_64 12:4.2.5-77.el7.centos        base    133 k
 diffutils                   x86_64 3.3-5.el7                     base    322 k
 dmidecode                   x86_64 1:3.2-3.el7                   base     81 k
 dracut                      x86_64 033-564.el7                   base    329 k
 dracut-config-generic       x86_64 033-564.el7                   base     59 k
 dracut-config-rescue        x86_64 033-564.el7                   base     60 k
 dracut-network              x86_64 033-564.el7                   base    103 k
 e2fsprogs                   x86_64 1.42.9-16.el7                 base    700 k
 e2fsprogs-libs              x86_64 1.42.9-16.el7                 base    167 k
 elfutils-default-yama-scope noarch 0.176-2.el7                   base     33 k
 elfutils-libelf             x86_64 0.176-2.el7                   base    194 k
 elfutils-libs               x86_64 0.176-2.el7                   base    291 k
 ethtool                     x86_64 2:4.8-10.el7                  base    127 k
 file                        x86_64 5.11-35.el7                   base     57 k
 file-libs                   x86_64 5.11-35.el7                   base    340 k
 findutils                   x86_64 1:4.5.11-6.el7                base    559 k
 gnupg2                      x86_64 2.0.22-5.el7_5                base    1.5 M
 gobject-introspection       x86_64 1.56.1-1.el7                  base    241 k
 grub2-common                noarch 1:2.02-0.80.el7.centos        base    730 k
 grub2-pc                    x86_64 1:2.02-0.80.el7.centos        base     32 k
 grub2-pc-modules            noarch 1:2.02-0.80.el7.centos        base    848 k
 grubby                      x86_64 8.28-26.el7                   base     71 k
 gssproxy                    x86_64 0.7.0-26.el7                  base    110 k
 hostname                    x86_64 3.13-3.el7_7.1                updates  17 k
 hwdata                      x86_64 0.252-9.3.el7                 base    2.4 M
 initscripts                 x86_64 9.49.47-1.el7                 base    439 k
 iproute                     x86_64 4.11.0-25.el7_7.2             updates 803 k
 iptables                    x86_64 1.4.21-33.el7                 base    433 k
 irqbalance                  x86_64 3:1.0.7-12.el7                base     45 k
 iwl7265-firmware            noarch 22.0.7.0-72.el7               base    7.3 M
 kbd                         x86_64 1.15.5-15.el7                 base    348 k
 kbd-legacy                  noarch 1.15.5-15.el7                 base    466 k
 kbd-misc                    noarch 1.15.5-15.el7                 base    1.4 M
 kernel-headers              x86_64 3.10.0-1062.12.1.el7          updates 8.7 M
 kernel-tools                x86_64 3.10.0-1062.12.1.el7          updates 7.9 M
 kernel-tools-libs           x86_64 3.10.0-1062.12.1.el7          updates 7.8 M
 kexec-tools                 x86_64 2.0.15-33.el7                 base    346 k
 kmod                        x86_64 20-25.el7                     base    122 k
 kmod-libs                   x86_64 20-25.el7                     base     51 k
 kpartx                      x86_64 0.4.9-127.el7                 base     78 k
 krb5-libs                   x86_64 1.15.1-37.el7_7.2             updates 805 k
 libbasicobjects             x86_64 0.1.1-32.el7                  base     26 k
 libblkid                    x86_64 2.23.2-61.el7_7.1             updates 181 k
 libcap                      x86_64 2.22-10.el7                   base     47 k
 libcgroup                   x86_64 0.41-21.el7                   base     66 k
 libcollection               x86_64 0.7.0-32.el7                  base     42 k
 libcom_err                  x86_64 1.42.9-16.el7                 base     41 k
 libcroco                    x86_64 0.6.12-4.el7                  base    105 k
 libcurl                     x86_64 7.29.0-54.el7_7.2             updates 223 k
 libfastjson                 x86_64 0.99.4-3.el7                  base     27 k
 libini_config               x86_64 1.3.1-32.el7                  base     64 k
 libmount                    x86_64 2.23.2-61.el7_7.1             updates 183 k
 libndp                      x86_64 1.2-9.el7                     base     32 k
 libpath_utils               x86_64 0.2.1-32.el7                  base     28 k
 libref_array                x86_64 0.1.5-32.el7                  base     27 k
 libselinux                  x86_64 2.5-14.1.el7                  base    162 k
 libselinux-python           x86_64 2.5-14.1.el7                  base    235 k
 libselinux-utils            x86_64 2.5-14.1.el7                  base    151 k
 libsemanage                 x86_64 2.5-14.el7                    base    151 k
 libsemanage-python          x86_64 2.5-14.el7                    base    113 k
 libsepol                    x86_64 2.5-10.el7                    base    297 k
 libss                       x86_64 1.42.9-16.el7                 base     46 k
 libssh2                     x86_64 1.8.0-3.el7                   base     88 k
 libstdc++                   x86_64 4.8.5-39.el7                  base    305 k
 libteam                     x86_64 1.27-9.el7                    base     49 k
 libuuid                     x86_64 2.23.2-61.el7_7.1             updates  83 k
 logrotate                   x86_64 3.8.6-17.el7                  base     70 k
 lshw                        x86_64 B.02.18-13.el7                base    321 k
 lz4                         x86_64 1.7.5-3.el7                   base     99 k
 make                        x86_64 1:3.82-24.el7                 base    421 k
 man-db                      x86_64 2.6.3-11.el7                  base    832 k
 mariadb-libs                x86_64 1:5.5.64-1.el7                base    759 k
 mesa-libEGL                 x86_64 18.3.4-6.el7_7                updates 109 k
 mesa-libGL                  x86_64 18.3.4-6.el7_7                updates 165 k
 mesa-libgbm                 x86_64 18.3.4-6.el7_7                updates  39 k
 mesa-libglapi               x86_64 18.3.4-6.el7_7                updates  45 k
 microcode_ctl               x86_64 2:2.1-53.7.el7_7              updates 2.5 M
 net-tools                   x86_64 2.0-0.25.20131004git.el7      base    306 k
 nfs-utils                   x86_64 1:1.3.0-0.65.el7              base    412 k
 nspr                        x86_64 4.21.0-1.el7                  base    127 k
 nss                         x86_64 3.44.0-7.el7_7                updates 854 k
 nss-pem                     x86_64 1.0.3-7.el7                   base     74 k
 nss-softokn                 x86_64 3.44.0-8.el7_7                updates 330 k
 nss-softokn-freebl          x86_64 3.44.0-8.el7_7                updates 224 k
 nss-sysinit                 x86_64 3.44.0-7.el7_7                updates  65 k
 nss-tools                   x86_64 3.44.0-7.el7_7                updates 528 k
 nss-util                    x86_64 3.44.0-4.el7_7                updates  79 k
 numactl-libs                x86_64 2.0.12-3.el7_7.1              updates  30 k
 openjpeg2                   x86_64 2.3.1-2.el7_7                 updates 153 k
 openldap                    x86_64 2.4.44-21.el7_6               base    356 k
 openssh                     x86_64 7.4p1-21.el7                  base    510 k
 openssh-clients             x86_64 7.4p1-21.el7                  base    655 k
 openssh-server              x86_64 7.4p1-21.el7                  base    459 k
 parted                      x86_64 3.1-31.el7                    base    609 k
 passwd                      x86_64 0.79-5.el7                    base    105 k
 policycoreutils             x86_64 2.5-33.el7                    base    916 k
 policycoreutils-python      x86_64 2.5-33.el7                    base    457 k
 polkit                      x86_64 0.112-22.el7_7.1              updates 170 k
 postfix                     x86_64 2:2.10.1-7.el7                base    2.4 M
 postgresql                  x86_64 9.2.24-2.el7_7                updates 3.0 M
 postgresql-libs             x86_64 9.2.24-2.el7_7                updates 234 k
 postgresql-server           x86_64 9.2.24-2.el7_7                updates 3.8 M
 procps-ng                   x86_64 3.3.10-26.el7_7.1             updates 291 k
 python-chardet              noarch 2.2.1-3.el7                   base    227 k
 python-jinja2               noarch 2.7.2-4.el7                   base    519 k
 python-linux-procfs         noarch 0.4.11-4.el7                  base     33 k
 python-perf                 x86_64 3.10.0-1062.12.1.el7          updates 7.9 M
 python-requests             noarch 2.6.0-8.el7_7                 updates  95 k
 python-urlgrabber           noarch 3.10-9.el7                    base    108 k
 python-urllib3              noarch 1.10.2-7.el7                  base    103 k
 qemu-guest-agent            x86_64 10:2.12.0-3.el7               base    116 k
 quota                       x86_64 1:4.01-19.el7                 base    179 k
 quota-nls                   noarch 1:4.01-19.el7                 base     90 k
 readline                    x86_64 6.2-11.el7                    base    193 k
 rpcbind                     x86_64 0.2.0-48.el7                  base     60 k
 rpm                         x86_64 4.11.3-40.el7                 base    1.2 M
 rpm-build-libs              x86_64 4.11.3-40.el7                 base    107 k
 rpm-libs                    x86_64 4.11.3-40.el7                 base    278 k
 rpm-python                  x86_64 4.11.3-40.el7                 base     83 k
 rsync                       x86_64 3.1.2-6.el7_6.1               base    404 k
 rsyslog                     x86_64 8.24.0-41.el7_7.2             updates 616 k
 selinux-policy              noarch 3.13.1-252.el7_7.6            updates 492 k
 selinux-policy-targeted     noarch 3.13.1-252.el7_7.6            updates 7.0 M
 setools-libs                x86_64 3.3.8-4.el7                   base    620 k
 setup                       noarch 2.8.71-10.el7                 base    166 k
 sg3_utils                   x86_64 1.37-18.el7_7.2               updates 646 k
 sg3_utils-libs              x86_64 1.37-18.el7_7.2               updates  65 k
 shadow-utils                x86_64 2:4.6-5.el7                   base    1.2 M
 sqlite                      x86_64 3.7.17-8.el7_7.1              updates 394 k
 sudo                        x86_64 1.8.23-4.el7_7.1              updates 841 k
 systemd                     x86_64 219-67.el7_7.3                updates 5.1 M
 systemd-libs                x86_64 219-67.el7_7.3                updates 411 k
 systemd-sysv                x86_64 219-67.el7_7.3                updates  88 k
 tar                         x86_64 2:1.26-35.el7                 base    846 k
 teamd                       x86_64 1.27-9.el7                    base    113 k
 tuned                       noarch 2.11.0-5.el7_7.1              updates 268 k
 tzdata                      noarch 2019c-1.el7                   updates 493 k
 util-linux                  x86_64 2.23.2-61.el7_7.1             updates 2.0 M
 vim-minimal                 x86_64 2:7.4.629-6.el7               base    443 k
 wpa_supplicant              x86_64 1:2.6-12.el7                  base    1.2 M
 xfsprogs                    x86_64 4.5.0-20.el7                  base    896 k
 yum                         noarch 3.4.3-163.el7.centos          base    1.2 M
 yum-plugin-fastestmirror    noarch 1.1.31-52.el7                 base     34 k
 yum-utils                   noarch 1.1.31-52.el7                 base    121 k
 zlib                        x86_64 1.2.7-18.el7                  base     90 k
Installing for dependencies:
 bind-export-libs            x86_64 32:9.11.4-9.P2.el7            base    1.1 M
 geoipupdate                 x86_64 2.5.0-1.el7                   base     35 k
 json-c                      x86_64 0.11-4.el7_0                  base     31 k
 libsmartcols                x86_64 2.23.2-61.el7_7.1             updates 141 k
 linux-firmware              noarch 20190429-72.gitddde598.el7    base     73 M

Transaction Summary
================================================================================
Install    5 Packages (+5 Dependent packages)
Upgrade  170 Packages

Total download size: 253 M
Is this ok [y/d/N]: y
Downloading packages:
Delta RPMs disabled because /usr/bin/applydeltarpm not installed.
(1/180): audit-2.8.5-4.el7.x86_64.rpm                      | 256 kB   00:00     
(2/180): audit-libs-2.8.5-4.el7.x86_64.rpm                 | 102 kB   00:00     
(3/180): audit-libs-python-2.8.5-4.el7.x86_64.rpm          |  76 kB   00:00     
(4/180): GeoIP-1.5.0-14.el7.x86_64.rpm                     | 1.5 MB   00:00     
(5/180): bash-4.2.46-33.el7.x86_64.rpm                     | 1.0 MB   00:00     
(6/180): bind-export-libs-9.11.4-9.P2.el7.x86_64.rpm       | 1.1 MB   00:00     
(7/180): bind-license-9.11.4-9.P2.el7.noarch.rpm           |  88 kB   00:00     
(8/180): centos-release-7-7.1908.0.el7.centos.x86_64.rpm   |  26 kB   00:00     
(9/180): bind-libs-lite-9.11.4-9.P2.el7.x86_64.rpm         | 1.1 MB   00:00     
(10/180): checkpolicy-2.5-8.el7.x86_64.rpm                 | 295 kB   00:00     
(11/180): ca-certificates-2019.2.32-76.el7_7.noarch.rpm    | 399 kB   00:00     
(12/180): chrony-3.4-1.el7.x86_64.rpm                      | 251 kB   00:00     
(13/180): cloud-utils-growpart-0.29-5.el7.noarch.rpm       |  27 kB   00:00     
(14/180): cloud-init-18.5-3.el7.centos.x86_64.rpm          | 861 kB   00:00     
(15/180): cronie-1.4.11-23.el7.x86_64.rpm                  |  92 kB   00:00     
(16/180): cronie-anacron-1.4.11-23.el7.x86_64.rpm          |  36 kB   00:00     
(17/180): cryptsetup-libs-2.0.3-5.el7.x86_64.rpm           | 338 kB   00:00     
(18/180): dbus-1.10.24-13.el7_6.x86_64.rpm                 | 245 kB   00:00     
(19/180): dbus-libs-1.10.24-13.el7_6.x86_64.rpm            | 169 kB   00:00     
(20/180): curl-7.29.0-54.el7_7.2.x86_64.rpm                | 270 kB   00:00     
(21/180): device-mapper-1.02.158-2.el7_7.2.x86_64.rpm      | 294 kB   00:00     
(22/180): device-mapper-libs-1.02.158-2.el7_7.2.x86_64.rpm | 322 kB   00:00     
(23/180): dhclient-4.2.5-77.el7.centos.x86_64.rpm          | 285 kB   00:00     
(24/180): dhcp-common-4.2.5-77.el7.centos.x86_64.rpm       | 176 kB   00:00     
(25/180): coreutils-8.22-24.el7.x86_64.rpm                 | 3.3 MB   00:00     
(26/180): dhcp-libs-4.2.5-77.el7.centos.x86_64.rpm         | 133 kB   00:00     
(27/180): dmidecode-3.2-3.el7.x86_64.rpm                   |  81 kB   00:00     
(28/180): binutils-2.27-41.base.el7_7.2.x86_64.rpm         | 5.9 MB   00:01     
(29/180): dracut-033-564.el7.x86_64.rpm                    | 329 kB   00:00     
(30/180): diffutils-3.3-5.el7.x86_64.rpm                   | 322 kB   00:00     
(31/180): dracut-config-generic-033-564.el7.x86_64.rpm     |  59 kB   00:00     
(32/180): dracut-network-033-564.el7.x86_64.rpm            | 103 kB   00:00     
(33/180): dracut-config-rescue-033-564.el7.x86_64.rpm      |  60 kB   00:00     
(34/180): e2fsprogs-1.42.9-16.el7.x86_64.rpm               | 700 kB   00:00     
(35/180): elfutils-default-yama-scope-0.176-2.el7.noarch.r |  33 kB   00:00     
(36/180): e2fsprogs-libs-1.42.9-16.el7.x86_64.rpm          | 167 kB   00:00     
(37/180): elfutils-libelf-0.176-2.el7.x86_64.rpm           | 194 kB   00:00     
(38/180): elfutils-libs-0.176-2.el7.x86_64.rpm             | 291 kB   00:00     
(39/180): ethtool-4.8-10.el7.x86_64.rpm                    | 127 kB   00:00     
(40/180): file-5.11-35.el7.x86_64.rpm                      |  57 kB   00:00     
(41/180): file-libs-5.11-35.el7.x86_64.rpm                 | 340 kB   00:00     
(42/180): findutils-4.5.11-6.el7.x86_64.rpm                | 559 kB   00:00     
(43/180): geoipupdate-2.5.0-1.el7.x86_64.rpm               |  35 kB   00:00     
(44/180): gobject-introspection-1.56.1-1.el7.x86_64.rpm    | 241 kB   00:00     
(45/180): grub2-2.02-0.80.el7.centos.x86_64.rpm            |  32 kB   00:00     
(46/180): gnupg2-2.0.22-5.el7_5.x86_64.rpm                 | 1.5 MB   00:00     
(47/180): grub2-common-2.02-0.80.el7.centos.noarch.rpm     | 730 kB   00:00     
(48/180): grub2-pc-2.02-0.80.el7.centos.x86_64.rpm         |  32 kB   00:00     
(49/180): grub2-pc-modules-2.02-0.80.el7.centos.noarch.rpm | 848 kB   00:00     
(50/180): grub2-tools-2.02-0.80.el7.centos.x86_64.rpm      | 1.8 MB   00:00     
(51/180): grub2-tools-extra-2.02-0.80.el7.centos.x86_64.rp | 997 kB   00:00     
(52/180): grub2-tools-minimal-2.02-0.80.el7.centos.x86_64. | 174 kB   00:00     
(53/180): grubby-8.28-26.el7.x86_64.rpm                    |  71 kB   00:00     
(54/180): hostname-3.13-3.el7_7.1.x86_64.rpm               |  17 kB   00:00     
(55/180): gssproxy-0.7.0-26.el7.x86_64.rpm                 | 110 kB   00:00     
(56/180): iproute-4.11.0-25.el7_7.2.x86_64.rpm             | 803 kB   00:00     
(57/180): initscripts-9.49.47-1.el7.x86_64.rpm             | 439 kB   00:00     
(58/180): iptables-1.4.21-33.el7.x86_64.rpm                | 433 kB   00:00     
(59/180): hwdata-0.252-9.3.el7.x86_64.rpm                  | 2.4 MB   00:00     
(60/180): irqbalance-1.0.7-12.el7.x86_64.rpm               |  45 kB   00:00     
(61/180): json-c-0.11-4.el7_0.x86_64.rpm                   |  31 kB   00:00     
(62/180): kbd-1.15.5-15.el7.x86_64.rpm                     | 348 kB   00:00     
(63/180): kbd-legacy-1.15.5-15.el7.noarch.rpm              | 466 kB   00:00     
(64/180): iwl7265-firmware-22.0.7.0-72.el7.noarch.rpm      | 7.3 MB   00:00     
(65/180): kbd-misc-1.15.5-15.el7.noarch.rpm                | 1.4 MB   00:00     
(66/180): kernel-3.10.0-1062.12.1.el7.x86_64.rpm           |  50 MB   00:05     
(67/180): kernel-tools-3.10.0-1062.12.1.el7.x86_64.rpm     | 7.9 MB   00:00     
(68/180): kexec-tools-2.0.15-33.el7.x86_64.rpm             | 346 kB   00:00     
(69/180): kmod-20-25.el7.x86_64.rpm                        | 122 kB   00:00     
(70/180): kmod-libs-20-25.el7.x86_64.rpm                   |  51 kB   00:00     
(71/180): kpartx-0.4.9-127.el7.x86_64.rpm                  |  78 kB   00:00     
(72/180): kernel-tools-libs-3.10.0-1062.12.1.el7.x86_64.rp | 7.8 MB   00:01     
(73/180): libbasicobjects-0.1.1-32.el7.x86_64.rpm          |  26 kB   00:00     
(74/180): krb5-libs-1.15.1-37.el7_7.2.x86_64.rpm           | 805 kB   00:00     
(75/180): libblkid-2.23.2-61.el7_7.1.x86_64.rpm            | 181 kB   00:00     
(76/180): libcap-2.22-10.el7.x86_64.rpm                    |  47 kB   00:00     
(77/180): libcollection-0.7.0-32.el7.x86_64.rpm            |  42 kB   00:00     
(78/180): libcom_err-1.42.9-16.el7.x86_64.rpm              |  41 kB   00:00     
(79/180): libcurl-7.29.0-54.el7_7.2.x86_64.rpm             | 223 kB   00:00     
(80/180): libcgroup-0.41-21.el7.x86_64.rpm                 |  66 kB   00:00     
(81/180): kernel-headers-3.10.0-1062.12.1.el7.x86_64.rpm   | 8.7 MB   00:07     
(82/180): libcroco-0.6.12-4.el7.x86_64.rpm                 | 105 kB   00:00     
(83/180): libfastjson-0.99.4-3.el7.x86_64.rpm              |  27 kB   00:00     
(84/180): libmount-2.23.2-61.el7_7.1.x86_64.rpm            | 183 kB   00:00     
(85/180): libini_config-1.3.1-32.el7.x86_64.rpm            |  64 kB   00:00     
(86/180): libpath_utils-0.2.1-32.el7.x86_64.rpm            |  28 kB   00:00     
(87/180): libndp-1.2-9.el7.x86_64.rpm                      |  32 kB   00:00     
(88/180): libref_array-0.1.5-32.el7.x86_64.rpm             |  27 kB   00:00     
(89/180): libselinux-2.5-14.1.el7.x86_64.rpm               | 162 kB   00:00     
(90/180): libselinux-python-2.5-14.1.el7.x86_64.rpm        | 235 kB   00:00     
(91/180): libselinux-utils-2.5-14.1.el7.x86_64.rpm         | 151 kB   00:00     
(92/180): libsemanage-2.5-14.el7.x86_64.rpm                | 151 kB   00:00     
(93/180): libsmartcols-2.23.2-61.el7_7.1.x86_64.rpm        | 141 kB   00:00     
(94/180): libsemanage-python-2.5-14.el7.x86_64.rpm         | 113 kB   00:00     
(95/180): libsepol-2.5-10.el7.x86_64.rpm                   | 297 kB   00:00     
(96/180): libss-1.42.9-16.el7.x86_64.rpm                   |  46 kB   00:00     
(97/180): libssh2-1.8.0-3.el7.x86_64.rpm                   |  88 kB   00:00     
(98/180): libstdc++-4.8.5-39.el7.x86_64.rpm                | 305 kB   00:00     
(99/180): libteam-1.27-9.el7.x86_64.rpm                    |  49 kB   00:00     
(100/180): libuuid-2.23.2-61.el7_7.1.x86_64.rpm            |  83 kB   00:00     
(101/180): logrotate-3.8.6-17.el7.x86_64.rpm               |  70 kB   00:00     
(102/180): lshw-B.02.18-13.el7.x86_64.rpm                  | 321 kB   00:00     
(103/180): lz4-1.7.5-3.el7.x86_64.rpm                      |  99 kB   00:00     
(104/180): make-3.82-24.el7.x86_64.rpm                     | 421 kB   00:00     
(105/180): man-db-2.6.3-11.el7.x86_64.rpm                  | 832 kB   00:01     
(106/180): mesa-libEGL-18.3.4-6.el7_7.x86_64.rpm           | 109 kB   00:00     
(107/180): mesa-libgbm-18.3.4-6.el7_7.x86_64.rpm           |  39 kB   00:00     
(108/180): mesa-libglapi-18.3.4-6.el7_7.x86_64.rpm         |  45 kB   00:00     
(109/180): mesa-libGL-18.3.4-6.el7_7.x86_64.rpm            | 165 kB   00:00     
(110/180): mariadb-libs-5.5.64-1.el7.x86_64.rpm            | 759 kB   00:01     
(111/180): net-tools-2.0-0.25.20131004git.el7.x86_64.rpm   | 306 kB   00:00     
(112/180): microcode_ctl-2.1-53.7.el7_7.x86_64.rpm         | 2.5 MB   00:01     
(113/180): nfs-utils-1.3.0-0.65.el7.x86_64.rpm             | 412 kB   00:00     
(114/180): nspr-4.21.0-1.el7.x86_64.rpm                    | 127 kB   00:00     
(115/180): nss-pem-1.0.3-7.el7.x86_64.rpm                  |  74 kB   00:00     
(116/180): nss-3.44.0-7.el7_7.x86_64.rpm                   | 854 kB   00:00     
(117/180): nss-softokn-freebl-3.44.0-8.el7_7.x86_64.rpm    | 224 kB   00:00     
(118/180): nss-sysinit-3.44.0-7.el7_7.x86_64.rpm           |  65 kB   00:00     
(119/180): nss-softokn-3.44.0-8.el7_7.x86_64.rpm           | 330 kB   00:00     
(120/180): nss-util-3.44.0-4.el7_7.x86_64.rpm              |  79 kB   00:00     
(121/180): numactl-libs-2.0.12-3.el7_7.1.x86_64.rpm        |  30 kB   00:00     
(122/180): nss-tools-3.44.0-7.el7_7.x86_64.rpm             | 528 kB   00:00     
(123/180): openjpeg2-2.3.1-2.el7_7.x86_64.rpm              | 153 kB   00:00     
(124/180): openldap-2.4.44-21.el7_6.x86_64.rpm             | 356 kB   00:00     
(125/180): openssh-7.4p1-21.el7.x86_64.rpm                 | 510 kB   00:00     
(126/180): openssh-clients-7.4p1-21.el7.x86_64.rpm         | 655 kB   00:00     
(127/180): openssh-server-7.4p1-21.el7.x86_64.rpm          | 459 kB   00:00     
(128/180): passwd-0.79-5.el7.x86_64.rpm                    | 105 kB   00:00     
(129/180): polkit-0.112-22.el7_7.1.x86_64.rpm              | 170 kB   00:00     
(130/180): policycoreutils-python-2.5-33.el7.x86_64.rpm    | 457 kB   00:00     
(131/180): parted-3.1-31.el7.x86_64.rpm                    | 609 kB   00:00     
(132/180): postfix-2.10.1-7.el7.x86_64.rpm                 | 2.4 MB   00:00     
(133/180): postgresql-libs-9.2.24-2.el7_7.x86_64.rpm       | 234 kB   00:00     
(134/180): linux-firmware-20190429-72.gitddde598.el7.noarc |  73 MB   00:08     
(135/180): postgresql-9.2.24-2.el7_7.x86_64.rpm            | 3.0 MB   00:01     
(136/180): postgresql-server-9.2.24-2.el7_7.x86_64.rpm     | 3.8 MB   00:00     
(137/180): policycoreutils-2.5-33.el7.x86_64.rpm           | 916 kB   00:02     
(138/180): procps-ng-3.3.10-26.el7_7.1.x86_64.rpm          | 291 kB   00:00     
(139/180): python-chardet-2.2.1-3.el7.noarch.rpm           | 227 kB   00:00     
(140/180): python-requests-2.6.0-8.el7_7.noarch.rpm        |  95 kB   00:00     
(141/180): python-jinja2-2.7.2-4.el7.noarch.rpm            | 519 kB   00:00     
(142/180): python-urlgrabber-3.10-9.el7.noarch.rpm         | 108 kB   00:00     
(143/180): python-linux-procfs-0.4.11-4.el7.noarch.rpm     |  33 kB   00:00     
(144/180): qemu-guest-agent-2.12.0-3.el7.x86_64.rpm        | 116 kB   00:00     
(145/180): quota-nls-4.01-19.el7.noarch.rpm                |  90 kB   00:00     
(146/180): quota-4.01-19.el7.x86_64.rpm                    | 179 kB   00:00     
(147/180): rpcbind-0.2.0-48.el7.x86_64.rpm                 |  60 kB   00:00     
(148/180): readline-6.2-11.el7.x86_64.rpm                  | 193 kB   00:00     
(149/180): rpm-build-libs-4.11.3-40.el7.x86_64.rpm         | 107 kB   00:00     
(150/180): python-urllib3-1.10.2-7.el7.noarch.rpm          | 103 kB   00:00     
(151/180): rpm-python-4.11.3-40.el7.x86_64.rpm             |  83 kB   00:00     
(152/180): rpm-libs-4.11.3-40.el7.x86_64.rpm               | 278 kB   00:00     
(153/180): rpm-4.11.3-40.el7.x86_64.rpm                    | 1.2 MB   00:00     
(154/180): rsync-3.1.2-6.el7_6.1.x86_64.rpm                | 404 kB   00:00     
(155/180): rsyslog-8.24.0-41.el7_7.2.x86_64.rpm            | 616 kB   00:00     
(156/180): selinux-policy-3.13.1-252.el7_7.6.noarch.rpm    | 492 kB   00:00     
(157/180): setup-2.8.71-10.el7.noarch.rpm                  | 166 kB   00:00     
(158/180): setools-libs-3.3.8-4.el7.x86_64.rpm             | 620 kB   00:00     
(159/180): python-perf-3.10.0-1062.12.1.el7.x86_64.rpm     | 7.9 MB   00:01     
(160/180): sg3_utils-1.37-18.el7_7.2.x86_64.rpm            | 646 kB   00:00     
(161/180): sg3_utils-libs-1.37-18.el7_7.2.x86_64.rpm       |  65 kB   00:00     
(162/180): sqlite-3.7.17-8.el7_7.1.x86_64.rpm              | 394 kB   00:00     
(163/180): sudo-1.8.23-4.el7_7.1.x86_64.rpm                | 841 kB   00:00     
(164/180): shadow-utils-4.6-5.el7.x86_64.rpm               | 1.2 MB   00:00     
(165/180): systemd-219-67.el7_7.3.x86_64.rpm               | 5.1 MB   00:00     
(166/180): systemd-libs-219-67.el7_7.3.x86_64.rpm          | 411 kB   00:00     
(167/180): systemd-sysv-219-67.el7_7.3.x86_64.rpm          |  88 kB   00:00     
(168/180): tuned-2.11.0-5.el7_7.1.noarch.rpm               | 268 kB   00:00     
(169/180): selinux-policy-targeted-3.13.1-252.el7_7.6.noar | 7.0 MB   00:02     
(170/180): tzdata-2019c-1.el7.noarch.rpm                   | 493 kB   00:00     
(171/180): teamd-1.27-9.el7.x86_64.rpm                     | 113 kB   00:00     
(172/180): tar-1.26-35.el7.x86_64.rpm                      | 846 kB   00:00     
(173/180): vim-minimal-7.4.629-6.el7.x86_64.rpm            | 443 kB   00:00     
(174/180): util-linux-2.23.2-61.el7_7.1.x86_64.rpm         | 2.0 MB   00:00     
(175/180): yum-plugin-fastestmirror-1.1.31-52.el7.noarch.r |  34 kB   00:00     
(176/180): xfsprogs-4.5.0-20.el7.x86_64.rpm                | 896 kB   00:00     
(177/180): yum-utils-1.1.31-52.el7.noarch.rpm              | 121 kB   00:00     
(178/180): zlib-1.2.7-18.el7.x86_64.rpm                    |  90 kB   00:00     
(179/180): wpa_supplicant-2.6-12.el7.x86_64.rpm            | 1.2 MB   00:00     
(180/180): yum-3.4.3-163.el7.centos.noarch.rpm             | 1.2 MB   00:00     
--------------------------------------------------------------------------------
Total                                               10 MB/s | 253 MB  00:25     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Updating   : bash-4.2.46-33.el7.x86_64                                  1/354 
  Updating   : zlib-1.2.7-18.el7.x86_64                                   2/354 
  Updating   : audit-libs-2.8.5-4.el7.x86_64                              3/354 
  Updating   : libcom_err-1.42.9-16.el7.x86_64                            4/354 
  Updating   : libcap-2.22-10.el7.x86_64                                  5/354 
  Updating   : nspr-4.21.0-1.el7.x86_64                                   6/354 
  Updating   : nss-util-3.44.0-4.el7_7.x86_64                             7/354 
  Updating   : libsepol-2.5-10.el7.x86_64                                 8/354 
  Updating   : libselinux-2.5-14.1.el7.x86_64                             9/354 
  Updating   : coreutils-8.22-24.el7.x86_64                              10/354 
  Updating   : krb5-libs-1.15.1-37.el7_7.2.x86_64                        11/354 
  Updating   : libuuid-2.23.2-61.el7_7.1.x86_64                          12/354 
  Updating   : libblkid-2.23.2-61.el7_7.1.x86_64                         13/354 
  Updating   : elfutils-libelf-0.176-2.el7.x86_64                        14/354 
  Updating   : readline-6.2-11.el7.x86_64                                15/354 
  Updating   : centos-release-7-7.1908.0.el7.centos.x86_64               16/354 
  Updating   : 1:grub2-common-2.02-0.80.el7.centos.noarch                17/354 
  Updating   : sqlite-3.7.17-8.el7_7.1.x86_64                            18/354 
  Updating   : libsemanage-2.5-14.el7.x86_64                             19/354 
  Updating   : diffutils-3.3-5.el7.x86_64                                20/354 
  Updating   : libstdc++-4.8.5-39.el7.x86_64                             21/354 
  Updating   : libmount-2.23.2-61.el7_7.1.x86_64                         22/354 
  Updating   : mesa-libglapi-18.3.4-6.el7_7.x86_64                       23/354 
  Updating   : 1:findutils-4.5.11-6.el7.x86_64                           24/354 
  Updating   : file-libs-5.11-35.el7.x86_64                              25/354 
  Updating   : file-5.11-35.el7.x86_64                                   26/354 
  Updating   : setup-2.8.71-10.el7.noarch                                27/354 
warning: /etc/shadow created as /etc/shadow.rpmnew
  Updating   : 2:shadow-utils-4.6-5.el7.x86_64                           28/354 
  Updating   : libselinux-python-2.5-14.1.el7.x86_64                     29/354 
  Updating   : nss-softokn-freebl-3.44.0-8.el7_7.x86_64                  30/354 
  Updating   : nss-softokn-3.44.0-8.el7_7.x86_64                         31/354 
  Updating   : nss-pem-1.0.3-7.el7.x86_64                                32/354 
  Updating   : nss-sysinit-3.44.0-7.el7_7.x86_64                         33/354 
  Updating   : nss-3.44.0-7.el7_7.x86_64                                 34/354 
  Updating   : e2fsprogs-libs-1.42.9-16.el7.x86_64                       35/354 
  Updating   : ca-certificates-2019.2.32-76.el7_7.noarch                 36/354 
  Updating   : lz4-1.7.5-3.el7.x86_64                                    37/354 
  Updating   : libref_array-0.1.5-32.el7.x86_64                          38/354 
  Updating   : 2:ethtool-4.8-10.el7.x86_64                               39/354 
  Updating   : libcollection-0.7.0-32.el7.x86_64                         40/354 
  Updating   : hostname-3.13-3.el7_7.1.x86_64                            41/354 
  Updating   : libbasicobjects-0.1.1-32.el7.x86_64                       42/354 
  Updating   : python-urllib3-1.10.2-7.el7.noarch                        43/354 
  Updating   : nss-tools-3.44.0-7.el7_7.x86_64                           44/354 
  Updating   : mesa-libgbm-18.3.4-6.el7_7.x86_64                         45/354 
  Updating   : 1:mariadb-libs-5.5.64-1.el7.x86_64                        46/354 
  Updating   : setools-libs-3.3.8-4.el7.x86_64                           47/354 
  Updating   : libsemanage-python-2.5-14.el7.x86_64                      48/354 
  Updating   : 1:grub2-pc-modules-2.02-0.80.el7.centos.noarch            49/354 
  Updating   : grubby-8.28-26.el7.x86_64                                 50/354 
  Installing : 32:bind-export-libs-9.11.4-9.P2.el7.x86_64                51/354 
  Updating   : binutils-2.27-41.base.el7_7.2.x86_64                      52/354 
  Updating   : logrotate-3.8.6-17.el7.x86_64                             53/354 
  Updating   : 2:vim-minimal-7.4.629-6.el7.x86_64                        54/354 
  Updating   : libselinux-utils-2.5-14.1.el7.x86_64                      55/354 
  Updating   : 2:tar-1.26-35.el7.x86_64                                  56/354 
  Updating   : libss-1.42.9-16.el7.x86_64                                57/354 
  Updating   : e2fsprogs-1.42.9-16.el7.x86_64                            58/354 
  Updating   : audit-libs-python-2.8.5-4.el7.x86_64                      59/354 
  Updating   : libssh2-1.8.0-3.el7.x86_64                                60/354 
  Updating   : libcurl-7.29.0-54.el7_7.2.x86_64                          61/354 
  Updating   : curl-7.29.0-54.el7_7.2.x86_64                             62/354 
  Updating   : rpm-libs-4.11.3-40.el7.x86_64                             63/354 
  Updating   : rpm-4.11.3-40.el7.x86_64                                  64/354 
  Updating   : openldap-2.4.44-21.el7_6.x86_64                           65/354 
  Updating   : postgresql-libs-9.2.24-2.el7_7.x86_64                     66/354 
  Updating   : postgresql-9.2.24-2.el7_7.x86_64                          67/354 
  Updating   : gnupg2-2.0.22-5.el7_5.x86_64                              68/354 
  Updating   : rpm-build-libs-4.11.3-40.el7.x86_64                       69/354 
  Updating   : rpm-python-4.11.3-40.el7.x86_64                           70/354 
  Installing : geoipupdate-2.5.0-1.el7.x86_64                            71/354 
  Updating   : GeoIP-1.5.0-14.el7.x86_64                                 72/354 
  Updating   : kmod-libs-20-25.el7.x86_64                                73/354 
  Installing : linux-firmware-20190429-72.gitddde598.el7.noarch          74/354 
  Updating   : iptables-1.4.21-33.el7.x86_64                             75/354 
  Updating   : iproute-4.11.0-25.el7_7.2.x86_64                          76/354 
  Updating   : checkpolicy-2.5-8.el7.x86_64                              77/354 
  Updating   : kbd-misc-1.15.5-15.el7.noarch                             78/354 
  Installing : json-c-0.11-4.el7_0.x86_64                                79/354 
  Updating   : python-chardet-2.2.1-3.el7.noarch                         80/354 
  Updating   : python-requests-2.6.0-8.el7_7.noarch                      81/354 
  Installing : libsmartcols-2.23.2-61.el7_7.1.x86_64                     82/354 
  Updating   : util-linux-2.23.2-61.el7_7.1.x86_64                       83/354 
  Updating   : procps-ng-3.3.10-26.el7_7.1.x86_64                        84/354 
  Updating   : kpartx-0.4.9-127.el7.x86_64                               85/354 
  Updating   : 7:device-mapper-1.02.158-2.el7_7.2.x86_64                 86/354 
  Updating   : dracut-033-564.el7.x86_64                                 87/354 
  Updating   : kmod-20-25.el7.x86_64                                     88/354 
  Updating   : 7:device-mapper-libs-1.02.158-2.el7_7.2.x86_64            89/354 
  Updating   : cryptsetup-libs-2.0.3-5.el7.x86_64                        90/354 
  Updating   : elfutils-libs-0.176-2.el7.x86_64                          91/354 
  Updating   : systemd-libs-219-67.el7_7.3.x86_64                        92/354 
  Updating   : 1:dbus-libs-1.10.24-13.el7_6.x86_64                       93/354 
  Updating   : systemd-219-67.el7_7.3.x86_64                             94/354 
  Updating   : 1:dbus-1.10.24-13.el7_6.x86_64                            95/354 
  Updating   : elfutils-default-yama-scope-0.176-2.el7.noarch            96/354 
  Updating   : systemd-sysv-219-67.el7_7.3.x86_64                        97/354 
  Updating   : initscripts-9.49.47-1.el7.x86_64                          98/354 
  Installing : 1:grub2-tools-minimal-2.02-0.80.el7.centos.x86_64         99/354 
  Updating   : policycoreutils-2.5-33.el7.x86_64                        100/354 
  Installing : 1:grub2-tools-2.02-0.80.el7.centos.x86_64                101/354 
  Updating   : rpcbind-0.2.0-48.el7.x86_64                              102/354 
  Updating   : 12:dhcp-libs-4.2.5-77.el7.centos.x86_64                  103/354 
  Updating   : openssh-7.4p1-21.el7.x86_64                              104/354 
  Updating   : 12:dhcp-common-4.2.5-77.el7.centos.x86_64                105/354 
  Updating   : 12:dhclient-4.2.5-77.el7.centos.x86_64                   106/354 
  Updating   : dracut-network-033-564.el7.x86_64                        107/354 
  Installing : 1:grub2-tools-extra-2.02-0.80.el7.centos.x86_64          108/354 
  Updating   : 1:grub2-pc-2.02-0.80.el7.centos.x86_64                   109/354 
  Updating   : selinux-policy-3.13.1-252.el7_7.6.noarch                 110/354 
  Updating   : polkit-0.112-22.el7_7.1.x86_64                           111/354 
  Updating   : cronie-anacron-1.4.11-23.el7.x86_64                      112/354 
  Updating   : cronie-1.4.11-23.el7.x86_64                              113/354 
  Updating   : libcgroup-0.41-21.el7.x86_64                             114/354 
  Updating   : policycoreutils-python-2.5-33.el7.x86_64                 115/354 
  Updating   : hwdata-0.252-9.3.el7.x86_64                              116/354 
  Updating   : net-tools-2.0-0.25.20131004git.el7.x86_64                117/354 
  Updating   : python-linux-procfs-0.4.11-4.el7.noarch                  118/354 
  Updating   : sg3_utils-libs-1.37-18.el7_7.2.x86_64                    119/354 
  Updating   : libfastjson-0.99.4-3.el7.x86_64                          120/354 
  Updating   : python-urlgrabber-3.10-9.el7.noarch                      121/354 
  Updating   : yum-plugin-fastestmirror-1.1.31-52.el7.noarch            122/354 
  Updating   : yum-3.4.3-163.el7.centos.noarch                          123/354 
  Updating   : 1:dmidecode-3.2-3.el7.x86_64                             124/354 
  Updating   : numactl-libs-2.0.12-3.el7_7.1.x86_64                     125/354 
  Updating   : python-jinja2-2.7.2-4.el7.noarch                         126/354 
  Updating   : 1:quota-nls-4.01-19.el7.noarch                           127/354 
  Updating   : 1:quota-4.01-19.el7.x86_64                               128/354 
  Updating   : python-perf-3.10.0-1062.12.1.el7.x86_64                  129/354 
  Updating   : kbd-legacy-1.15.5-15.el7.noarch                          130/354 
  Updating   : 32:bind-license-9.11.4-9.P2.el7.noarch                   131/354 
  Updating   : kernel-tools-libs-3.10.0-1062.12.1.el7.x86_64            132/354 
  Updating   : libteam-1.27-9.el7.x86_64                                133/354 
  Updating   : libpath_utils-0.2.1-32.el7.x86_64                        134/354 
  Updating   : libini_config-1.3.1-32.el7.x86_64                        135/354 
  Updating   : gssproxy-0.7.0-26.el7.x86_64                             136/354 
  Updating   : 1:nfs-utils-1.3.0-0.65.el7.x86_64                        137/354 
  Updating   : teamd-1.27-9.el7.x86_64                                  138/354 
  Updating   : kernel-tools-3.10.0-1062.12.1.el7.x86_64                 139/354 
  Updating   : 32:bind-libs-lite-9.11.4-9.P2.el7.x86_64                 140/354 
  Updating   : kbd-1.15.5-15.el7.x86_64                                 141/354 
  Updating   : tuned-2.11.0-5.el7_7.1.noarch                            142/354 
  Updating   : cloud-init-18.5-3.el7.centos.x86_64                      143/354 
  Updating   : 3:irqbalance-1.0.7-12.el7.x86_64                         144/354 
  Updating   : yum-utils-1.1.31-52.el7.noarch                           145/354 
  Updating   : rsyslog-8.24.0-41.el7_7.2.x86_64                         146/354 
  Updating   : sg3_utils-1.37-18.el7_7.2.x86_64                         147/354 
  Updating   : lshw-B.02.18-13.el7.x86_64                               148/354 
  Updating   : selinux-policy-targeted-3.13.1-252.el7_7.6.noarch        149/354 
  Installing : 1:grub2-2.02-0.80.el7.centos.x86_64                      150/354 
  Updating   : kexec-tools-2.0.15-33.el7.x86_64                         151/354 
  Updating   : openssh-server-7.4p1-21.el7.x86_64                       152/354 
  Updating   : openssh-clients-7.4p1-21.el7.x86_64                      153/354 
  Installing : kernel-3.10.0-1062.12.1.el7.x86_64                       154/354 
  Updating   : postgresql-server-9.2.24-2.el7_7.x86_64                  155/354 
  Updating   : 1:wpa_supplicant-2.6-12.el7.x86_64                       156/354 
  Updating   : 2:postfix-2.10.1-7.el7.x86_64                            157/354 
  Updating   : audit-2.8.5-4.el7.x86_64                                 158/354 
  Updating   : 2:microcode_ctl-2.1-53.7.el7_7.x86_64                    159/354 
  Updating   : rsync-3.1.2-6.el7_6.1.x86_64                             160/354 
  Updating   : chrony-3.4-1.el7.x86_64                                  161/354 
  Updating   : 10:qemu-guest-agent-2.12.0-3.el7.x86_64                  162/354 
  Updating   : parted-3.1-31.el7.x86_64                                 163/354 
  Updating   : dracut-config-rescue-033-564.el7.x86_64                  164/354 
  Updating   : dracut-config-generic-033-564.el7.x86_64                 165/354 
  Updating   : cloud-utils-growpart-0.29-5.el7.noarch                   166/354 
  Updating   : sudo-1.8.23-4.el7_7.1.x86_64                             167/354 
  Updating   : mesa-libEGL-18.3.4-6.el7_7.x86_64                        168/354 
  Updating   : mesa-libGL-18.3.4-6.el7_7.x86_64                         169/354 
  Updating   : xfsprogs-4.5.0-20.el7.x86_64                             170/354 
  Updating   : man-db-2.6.3-11.el7.x86_64                               171/354 
  Updating   : passwd-0.79-5.el7.x86_64                                 172/354 
  Updating   : 1:make-3.82-24.el7.x86_64                                173/354 
  Updating   : openjpeg2-2.3.1-2.el7_7.x86_64                           174/354 
  Updating   : kernel-headers-3.10.0-1062.12.1.el7.x86_64               175/354 
  Updating   : libcroco-0.6.12-4.el7.x86_64                             176/354 
  Updating   : tzdata-2019c-1.el7.noarch                                177/354 
  Updating   : iwl7265-firmware-22.0.7.0-72.el7.noarch                  178/354 
  Updating   : libndp-1.2-9.el7.x86_64                                  179/354 
  Updating   : gobject-introspection-1.56.1-1.el7.x86_64                180/354 
  Cleanup    : 1:nfs-utils-1.3.0-0.54.el7.x86_64                        181/354 
  Cleanup    : cloud-init-0.7.9-24.el7.centos.x86_64                    182/354 
  Cleanup    : policycoreutils-python-2.5-22.el7.x86_64                 183/354 
  Cleanup    : gssproxy-0.7.0-17.el7.x86_64                             184/354 
  Cleanup    : postgresql-server-9.2.24-1.el7_5.x86_64                  185/354 
  Cleanup    : openssh-server-7.4p1-16.el7.x86_64                       186/354 
  Cleanup    : kexec-tools-2.0.15-13.el7.x86_64                         187/354 
  Cleanup    : tuned-2.9.0-1.el7.noarch                                 188/354 
  Cleanup    : audit-2.8.1-3.el7.x86_64                                 189/354 
  Cleanup    : openssh-clients-7.4p1-16.el7.x86_64                      190/354 
  Cleanup    : parted-3.1-29.el7.x86_64                                 191/354 
  Cleanup    : rsyslog-8.24.0-16.el7_5.4.x86_64                         192/354 
  Cleanup    : dracut-network-033-535.el7.x86_64                        193/354 
  Cleanup    : 12:dhclient-4.2.5-68.el7.centos.1.x86_64                 194/354 
  Cleanup    : selinux-policy-targeted-3.13.1-192.el7_5.3.noarch        195/354 
  Cleanup    : 32:bind-libs-lite-9.9.4-61.el7.x86_64                    196/354 
  Cleanup    : openssh-7.4p1-16.el7.x86_64                              197/354 
  Cleanup    : e2fsprogs-1.42.9-12.el7_5.x86_64                         198/354 
  Cleanup    : 1:quota-4.01-17.el7.x86_64                               199/354 
  Cleanup    : rpcbind-0.2.0-44.el7.x86_64                              200/354 
  Cleanup    : cronie-anacron-1.4.11-19.el7.x86_64                      201/354 
  Cleanup    : cronie-1.4.11-19.el7.x86_64                              202/354 
  Cleanup    : sudo-1.8.19p2-13.el7.x86_64                              203/354 
  Cleanup    : 2:postfix-2.10.1-6.el7.x86_64                            204/354 
  Cleanup    : polkit-0.112-14.el7.x86_64                               205/354 
  Cleanup    : setools-libs-3.3.8-2.el7.x86_64                          206/354 
  Cleanup    : chrony-3.2-2.el7.x86_64                                  207/354 
  Cleanup    : mesa-libEGL-18.3.4-5.el7.x86_64                          208/354 
  Cleanup    : selinux-policy-3.13.1-192.el7_5.3.noarch                 209/354 
  Cleanup    : policycoreutils-2.5-22.el7.x86_64                        210/354 
  Cleanup    : postgresql-9.2.24-1.el7_5.x86_64                         211/354 
  Cleanup    : libini_config-1.3.1-29.el7.x86_64                        212/354 
  Cleanup    : xfsprogs-4.5.0-15.el7.x86_64                             213/354 
  Cleanup    : 1:wpa_supplicant-2.6-9.el7.x86_64                        214/354 
  Cleanup    : mesa-libGL-18.3.4-5.el7.x86_64                           215/354 
  Cleanup    : kbd-1.15.5-13.el7.x86_64                                 216/354 
  Cleanup    : python-requests-2.6.0-1.el7_1.noarch                     217/354 
  Cleanup    : initscripts-9.49.41-1.el7.x86_64                         218/354 
  Cleanup    : iproute-4.11.0-14.el7.x86_64                             219/354 
  Cleanup    : postgresql-libs-9.2.24-1.el7_5.x86_64                    220/354 
  Cleanup    : logrotate-3.8.6-15.el7.x86_64                            221/354 
  Cleanup    : libcgroup-0.41-15.el7.x86_64                             222/354 
  Cleanup    : net-tools-2.0-0.22.20131004git.el7.x86_64                223/354 
  Cleanup    : man-db-2.6.3-9.el7.x86_64                                224/354 
  Cleanup    : teamd-1.27-4.el7.x86_64                                  225/354 
  Cleanup    : 3:irqbalance-1.0.7-11.el7.x86_64                         226/354 
  Cleanup    : 10:qemu-guest-agent-2.8.0-2.el7.x86_64                   227/354 
  Cleanup    : lshw-B.02.18-12.el7.x86_64                               228/354 
  Cleanup    : rsync-3.1.2-4.el7.x86_64                                 229/354 
  Cleanup    : grubby-8.28-23.el7.x86_64                                230/354 
  Cleanup    : hwdata-0.252-8.8.el7.x86_64                              231/354 
  Cleanup    : cloud-utils-growpart-0.29-2.el7.noarch                   232/354 
  Cleanup    : dracut-config-rescue-033-535.el7.x86_64                  233/354 
  Cleanup    : 1:grub2-2.02-0.65.el7.centos.2.x86_64                    234/354 
  Cleanup    : 1:grub2-pc-2.02-0.65.el7.centos.2.x86_64                 235/354 
  Cleanup    : 1:grub2-tools-extra-2.02-0.65.el7.centos.2.x86_64        236/354 
  Cleanup    : 1:grub2-tools-2.02-0.65.el7.centos.2.x86_64              237/354 
  Cleanup    : 1:grub2-tools-minimal-2.02-0.65.el7.centos.2.x86_64      238/354 
  Cleanup    : file-5.11-33.el7.x86_64                                  239/354 
  Cleanup    : libselinux-utils-2.5-12.el7.x86_64                       240/354 
  Cleanup    : mesa-libgbm-18.3.4-5.el7.x86_64                          241/354 
  Cleanup    : 1:mariadb-libs-5.5.56-2.el7.x86_64                       242/354 
  Cleanup    : kernel-tools-3.10.0-862.3.2.el7.x86_64                   243/354 
  Cleanup    : sg3_utils-1.37-12.el7.x86_64                             244/354 
  Cleanup    : 2:microcode_ctl-2.1-29.2.el7_5.x86_64                    245/354 
  Cleanup    : passwd-0.79-4.el7.x86_64                                 246/354 
  Cleanup    : 1:grub2-pc-modules-2.02-0.65.el7.centos.2.noarch         247/354 
  Cleanup    : python-urllib3-1.10.2-5.el7.noarch                       248/354 
  Cleanup    : ca-certificates-2018.2.22-70.0.el7_5.noarch              249/354 
  Cleanup    : systemd-sysv-219-57.el7.x86_64                           250/354 
  Cleanup    : 12:dhcp-common-4.2.5-68.el7.centos.1.x86_64              251/354 
  Cleanup    : 12:dhcp-libs-4.2.5-68.el7.centos.1.x86_64                252/354 
  Cleanup    : dracut-config-generic-033-535.el7.x86_64                 253/354 
  Cleanup    : yum-utils-1.1.31-45.el7.noarch                           254/354 
  Cleanup    : yum-3.4.3-158.el7.centos.noarch                          255/354 
  Cleanup    : yum-plugin-fastestmirror-1.1.31-45.el7.noarch            256/354 
  Cleanup    : python-urlgrabber-3.10-8.el7.noarch                      257/354 
  Cleanup    : 1:grub2-common-2.02-0.65.el7.centos.2.noarch             258/354 
  Cleanup    : python-chardet-2.2.1-1.el7_1.noarch                      259/354 
  Cleanup    : kbd-legacy-1.15.5-13.el7.noarch                          260/354 
  Cleanup    : kbd-misc-1.15.5-13.el7.noarch                            261/354 
  Cleanup    : 1:quota-nls-4.01-17.el7.noarch                           262/354 
  Cleanup    : 32:bind-license-9.9.4-61.el7.noarch                      263/354 
  Cleanup    : python-linux-procfs-0.4.9-3.el7.noarch                   264/354 
  Cleanup    : python-jinja2-2.7.2-2.el7.noarch                         265/354 
  Cleanup    : kernel-headers-3.10.0-1062.9.1.el7.x86_64                266/354 
  Cleanup    : tzdata-2018e-3.el7.noarch                                267/354 
  Cleanup    : iwl7265-firmware-22.0.7.0-62.1.el7_5.noarch              268/354 
  Cleanup    : rpm-python-4.11.3-32.el7.x86_64                          269/354 
  Cleanup    : rpm-build-libs-4.11.3-32.el7.x86_64                      270/354 
  Cleanup    : 1:dbus-libs-1.10.24-7.el7.x86_64                         271/354 
  Cleanup    : procps-ng-3.3.10-17.el7_5.2.x86_64                       272/354 
  Cleanup    : util-linux-2.23.2-52.el7.x86_64                          273/354 
  Cleanup    : kpartx-0.4.9-119.el7.x86_64                              274/354 
  Cleanup    : cryptsetup-libs-1.7.4-4.el7.x86_64                       275/354 
  Cleanup    : systemd-libs-219-57.el7.x86_64                           276/354 
  Cleanup    : kmod-20-21.el7.x86_64                                    277/354 
  Cleanup    : dracut-033-535.el7.x86_64                                278/354 
  Cleanup    : 7:device-mapper-libs-1.02.146-4.el7.x86_64               279/354 
  Cleanup    : 7:device-mapper-1.02.146-4.el7.x86_64                    280/354 
  Cleanup    : elfutils-libs-0.170-4.el7.x86_64                         281/354 
  Cleanup    : elfutils-default-yama-scope-0.170-4.el7.noarch           282/354 
  Cleanup    : 1:dbus-1.10.24-7.el7.x86_64                              283/354 
  Cleanup    : systemd-219-57.el7.x86_64                                284/354 
  Cleanup    : 2:shadow-utils-4.1.5.1-24.el7.x86_64                     285/354 
  Cleanup    : gnupg2-2.0.22-4.el7.x86_64                               286/354 
  Cleanup    : curl-7.29.0-46.el7.x86_64                                287/354 
  Cleanup    : libcurl-7.29.0-46.el7.x86_64                             288/354 
  Cleanup    : openldap-2.4.44-15.el7_5.x86_64                          289/354 
  Cleanup    : rpm-libs-4.11.3-32.el7.x86_64                            290/354 
  Cleanup    : rpm-4.11.3-32.el7.x86_64                                 291/354 
  Cleanup    : nss-tools-3.36.0-5.el7_5.x86_64                          292/354 
  Cleanup    : nss-pem-1.0.3-4.el7.x86_64                               293/354 
  Cleanup    : nss-sysinit-3.36.0-5.el7_5.x86_64                        294/354 
  Cleanup    : nss-3.36.0-5.el7_5.x86_64                                295/354 
  Cleanup    : nss-softokn-3.36.0-5.el7_5.x86_64                        296/354 
  Cleanup    : krb5-libs-1.15.1-19.el7.x86_64                           297/354 
  Cleanup    : nss-softokn-freebl-3.36.0-5.el7_5.x86_64                 298/354 
  Cleanup    : libmount-2.23.2-52.el7.x86_64                            299/354 
  Cleanup    : libblkid-2.23.2-52.el7.x86_64                            300/354 
  Cleanup    : binutils-2.27-27.base.el7.x86_64                         301/354 
  Cleanup    : 1:findutils-4.5.11-5.el7.x86_64                          302/354 
  Cleanup    : 2:tar-1.26-34.el7.x86_64                                 303/354 
  Cleanup    : setup-2.8.71-9.el7.noarch                                304/354 
  Cleanup    : centos-release-7-5.1804.el7.centos.2.x86_64              305/354 
  Cleanup    : coreutils-8.22-21.el7.x86_64                             306/354 
  Cleanup    : nss-util-3.36.0-1.el7_5.x86_64                           307/354 
  Cleanup    : sqlite-3.7.17-8.el7.x86_64                               308/354 
  Cleanup    : readline-6.2-10.el7.x86_64                               309/354 
  Cleanup    : elfutils-libelf-0.170-4.el7.x86_64                       310/354 
  Cleanup    : libssh2-1.4.3-10.el7_2.1.x86_64                          311/354 
  Cleanup    : diffutils-3.3-4.el7.x86_64                               312/354 
  Cleanup    : kmod-libs-20-21.el7.x86_64                               313/354 
  Cleanup    : file-libs-5.11-33.el7.x86_64                             314/354 
  Cleanup    : mesa-libglapi-18.3.4-5.el7.x86_64                        315/354 
  Cleanup    : iptables-1.4.21-24.1.el7_5.x86_64                        316/354 
  Cleanup    : 2:vim-minimal-7.4.160-4.el7.x86_64                       317/354 
  Cleanup    : e2fsprogs-libs-1.42.9-12.el7_5.x86_64                    318/354 
  Cleanup    : libss-1.42.9-12.el7_5.x86_64                             319/354 
  Cleanup    : GeoIP-1.5.0-11.el7.x86_64                                320/354 
  Cleanup    : audit-libs-python-2.8.1-3.el7.x86_64                     321/354 
  Cleanup    : libselinux-python-2.5-12.el7.x86_64                      322/354 
  Cleanup    : libsemanage-python-2.5-11.el7.x86_64                     323/354 
  Cleanup    : libsemanage-2.5-11.el7.x86_64                            324/354 
  Cleanup    : libselinux-2.5-12.el7.x86_64                             325/354 
  Cleanup    : libsepol-2.5-8.1.el7.x86_64                              326/354 
  Cleanup    : 1:make-3.82-23.el7.x86_64                                327/354 
  Cleanup    : bash-4.2.46-30.el7.x86_64                                328/354 
  Cleanup    : audit-libs-2.8.1-3.el7.x86_64                            329/354 
  Cleanup    : zlib-1.2.7-17.el7.x86_64                                 330/354 
  Cleanup    : libcom_err-1.42.9-12.el7_5.x86_64                        331/354 
  Cleanup    : nspr-4.19.0-1.el7_5.x86_64                               332/354 
  Cleanup    : libcap-2.22-9.el7.x86_64                                 333/354 
  Cleanup    : libuuid-2.23.2-52.el7.x86_64                             334/354 
  Cleanup    : lz4-1.7.5-2.el7.x86_64                                   335/354 
  Cleanup    : sg3_utils-libs-1.37-12.el7.x86_64                        336/354 
  Cleanup    : kernel-tools-libs-3.10.0-862.3.2.el7.x86_64              337/354 
  Cleanup    : libstdc++-4.8.5-28.el7_5.1.x86_64                        338/354 
  Cleanup    : numactl-libs-2.0.9-7.el7.x86_64                          339/354 
  Cleanup    : libteam-1.27-4.el7.x86_64                                340/354 
  Cleanup    : hostname-3.13-3.el7.x86_64                               341/354 
  Cleanup    : libbasicobjects-0.1.1-29.el7.x86_64                      342/354 
  Cleanup    : libcollection-0.7.0-29.el7.x86_64                        343/354 
  Cleanup    : libpath_utils-0.2.1-29.el7.x86_64                        344/354 
  Cleanup    : libref_array-0.1.5-29.el7.x86_64                         345/354 
  Cleanup    : libfastjson-0.99.4-2.el7.x86_64                          346/354 
  Cleanup    : 2:ethtool-4.8-7.el7.x86_64                               347/354 
  Cleanup    : python-perf-3.10.0-862.3.2.el7.x86_64                    348/354 
  Cleanup    : checkpolicy-2.5-6.el7.x86_64                             349/354 
  Cleanup    : 1:dmidecode-3.0-5.el7.x86_64                             350/354 
  Cleanup    : openjpeg2-2.3.1-1.el7.x86_64                             351/354 
  Cleanup    : libcroco-0.6.11-1.el7.x86_64                             352/354 
  Cleanup    : libndp-1.2-7.el7.x86_64                                  353/354 
  Cleanup    : gobject-introspection-1.50.0-1.el7.x86_64                354/354 
  Verifying  : initscripts-9.49.47-1.el7.x86_64                           1/354 
  Verifying  : nss-3.44.0-7.el7_7.x86_64                                  2/354 
  Verifying  : elfutils-default-yama-scope-0.176-2.el7.noarch             3/354 
  Verifying  : python-urllib3-1.10.2-7.el7.noarch                         4/354 
  Verifying  : dracut-network-033-564.el7.x86_64                          5/354 
  Verifying  : rsyslog-8.24.0-41.el7_7.2.x86_64                           6/354 
  Verifying  : file-libs-5.11-35.el7.x86_64                               7/354 
  Verifying  : grubby-8.28-26.el7.x86_64                                  8/354 
  Verifying  : openssh-server-7.4p1-21.el7.x86_64                         9/354 
  Verifying  : libsemanage-2.5-14.el7.x86_64                             10/354 
  Verifying  : 32:bind-libs-lite-9.11.4-9.P2.el7.x86_64                  11/354 
  Verifying  : libpath_utils-0.2.1-32.el7.x86_64                         12/354 
  Verifying  : selinux-policy-targeted-3.13.1-252.el7_7.6.noarch         13/354 
  Verifying  : 1:grub2-common-2.02-0.80.el7.centos.noarch                14/354 
  Verifying  : libteam-1.27-9.el7.x86_64                                 15/354 
  Verifying  : libssh2-1.8.0-3.el7.x86_64                                16/354 
  Verifying  : 1:grub2-tools-2.02-0.80.el7.centos.x86_64                 17/354 
  Verifying  : libbasicobjects-0.1.1-32.el7.x86_64                       18/354 
  Verifying  : 2:vim-minimal-7.4.629-6.el7.x86_64                        19/354 
  Verifying  : kernel-tools-libs-3.10.0-1062.12.1.el7.x86_64             20/354 
  Verifying  : passwd-0.79-5.el7.x86_64                                  21/354 
  Verifying  : 32:bind-license-9.11.4-9.P2.el7.noarch                    22/354 
  Verifying  : policycoreutils-2.5-33.el7.x86_64                         23/354 
  Verifying  : elfutils-libs-0.176-2.el7.x86_64                          24/354 
  Verifying  : libcurl-7.29.0-54.el7_7.2.x86_64                          25/354 
  Verifying  : nspr-4.21.0-1.el7.x86_64                                  26/354 
  Verifying  : yum-plugin-fastestmirror-1.1.31-52.el7.noarch             27/354 
  Verifying  : binutils-2.27-41.base.el7_7.2.x86_64                      28/354 
  Verifying  : centos-release-7-7.1908.0.el7.centos.x86_64               29/354 
  Verifying  : kernel-3.10.0-1062.12.1.el7.x86_64                        30/354 
  Verifying  : gobject-introspection-1.56.1-1.el7.x86_64                 31/354 
  Verifying  : cronie-1.4.11-23.el7.x86_64                               32/354 
  Verifying  : kbd-legacy-1.15.5-15.el7.noarch                           33/354 
  Verifying  : hostname-3.13-3.el7_7.1.x86_64                            34/354 
  Verifying  : 1:quota-4.01-19.el7.x86_64                                35/354 
  Verifying  : 2:microcode_ctl-2.1-53.7.el7_7.x86_64                     36/354 
  Verifying  : python-perf-3.10.0-1062.12.1.el7.x86_64                   37/354 
  Verifying  : 1:nfs-utils-1.3.0-0.65.el7.x86_64                         38/354 
  Verifying  : rsync-3.1.2-6.el7_6.1.x86_64                              39/354 
  Verifying  : diffutils-3.3-5.el7.x86_64                                40/354 
  Verifying  : sg3_utils-1.37-18.el7_7.2.x86_64                          41/354 
  Verifying  : 7:device-mapper-libs-1.02.158-2.el7_7.2.x86_64            42/354 
  Verifying  : kpartx-0.4.9-127.el7.x86_64                               43/354 
  Verifying  : libcom_err-1.42.9-16.el7.x86_64                           44/354 
  Verifying  : nss-softokn-freebl-3.44.0-8.el7_7.x86_64                  45/354 
  Verifying  : nss-util-3.44.0-4.el7_7.x86_64                            46/354 
  Verifying  : 1:quota-nls-4.01-19.el7.noarch                            47/354 
  Verifying  : lshw-B.02.18-13.el7.x86_64                                48/354 
  Verifying  : sqlite-3.7.17-8.el7_7.1.x86_64                            49/354 
  Verifying  : zlib-1.2.7-18.el7.x86_64                                  50/354 
  Verifying  : python-jinja2-2.7.2-4.el7.noarch                          51/354 
  Verifying  : nss-pem-1.0.3-7.el7.x86_64                                52/354 
  Verifying  : file-5.11-35.el7.x86_64                                   53/354 
  Verifying  : 32:bind-export-libs-9.11.4-9.P2.el7.x86_64                54/354 
  Verifying  : libss-1.42.9-16.el7.x86_64                                55/354 
  Verifying  : logrotate-3.8.6-17.el7.x86_64                             56/354 
  Verifying  : systemd-sysv-219-67.el7_7.3.x86_64                        57/354 
  Verifying  : libselinux-python-2.5-14.1.el7.x86_64                     58/354 
  Verifying  : 1:grub2-2.02-0.80.el7.centos.x86_64                       59/354 
  Verifying  : polkit-0.112-22.el7_7.1.x86_64                            60/354 
  Verifying  : GeoIP-1.5.0-14.el7.x86_64                                 61/354 
  Verifying  : numactl-libs-2.0.12-3.el7_7.1.x86_64                      62/354 
  Verifying  : libselinux-utils-2.5-14.1.el7.x86_64                      63/354 
  Verifying  : yum-utils-1.1.31-52.el7.noarch                            64/354 
  Verifying  : e2fsprogs-libs-1.42.9-16.el7.x86_64                       65/354 
  Verifying  : libndp-1.2-9.el7.x86_64                                   66/354 
  Verifying  : openldap-2.4.44-21.el7_6.x86_64                           67/354 
  Verifying  : rpm-build-libs-4.11.3-40.el7.x86_64                       68/354 
  Verifying  : 1:dmidecode-3.2-3.el7.x86_64                              69/354 
  Verifying  : python-urlgrabber-3.10-9.el7.noarch                       70/354 
  Verifying  : cryptsetup-libs-2.0.3-5.el7.x86_64                        71/354 
  Verifying  : mesa-libEGL-18.3.4-6.el7_7.x86_64                         72/354 
  Verifying  : libfastjson-0.99.4-3.el7.x86_64                           73/354 
  Verifying  : postgresql-9.2.24-2.el7_7.x86_64                          74/354 
  Verifying  : mesa-libgbm-18.3.4-6.el7_7.x86_64                         75/354 
  Verifying  : kbd-1.15.5-15.el7.x86_64                                  76/354 
  Verifying  : sg3_utils-libs-1.37-18.el7_7.2.x86_64                     77/354 
  Verifying  : iwl7265-firmware-22.0.7.0-72.el7.noarch                   78/354 
  Verifying  : libblkid-2.23.2-61.el7_7.1.x86_64                         79/354 
  Verifying  : 1:mariadb-libs-5.5.64-1.el7.x86_64                        80/354 
  Verifying  : 1:grub2-tools-extra-2.02-0.80.el7.centos.x86_64           81/354 
  Verifying  : bash-4.2.46-33.el7.x86_64                                 82/354 
  Verifying  : parted-3.1-31.el7.x86_64                                  83/354 
  Verifying  : python-linux-procfs-0.4.11-4.el7.noarch                   84/354 
  Verifying  : policycoreutils-python-2.5-33.el7.x86_64                  85/354 
  Verifying  : mesa-libGL-18.3.4-6.el7_7.x86_64                          86/354 
  Verifying  : libmount-2.23.2-61.el7_7.1.x86_64                         87/354 
  Verifying  : libcollection-0.7.0-32.el7.x86_64                         88/354 
  Verifying  : libcap-2.22-10.el7.x86_64                                 89/354 
  Verifying  : 12:dhcp-common-4.2.5-77.el7.centos.x86_64                 90/354 
  Verifying  : libsmartcols-2.23.2-61.el7_7.1.x86_64                     91/354 
  Verifying  : 12:dhclient-4.2.5-77.el7.centos.x86_64                    92/354 
  Verifying  : libcgroup-0.41-21.el7.x86_64                              93/354 
  Verifying  : dracut-config-rescue-033-564.el7.x86_64                   94/354 
  Verifying  : tzdata-2019c-1.el7.noarch                                 95/354 
  Verifying  : readline-6.2-11.el7.x86_64                                96/354 
  Verifying  : postgresql-server-9.2.24-2.el7_7.x86_64                   97/354 
  Verifying  : kexec-tools-2.0.15-33.el7.x86_64                          98/354 
  Verifying  : 12:dhcp-libs-4.2.5-77.el7.centos.x86_64                   99/354 
  Verifying  : kernel-tools-3.10.0-1062.12.1.el7.x86_64                 100/354 
  Verifying  : hwdata-0.252-9.3.el7.x86_64                              101/354 
  Verifying  : util-linux-2.23.2-61.el7_7.1.x86_64                      102/354 
  Verifying  : 1:wpa_supplicant-2.6-12.el7.x86_64                       103/354 
  Verifying  : libstdc++-4.8.5-39.el7.x86_64                            104/354 
  Verifying  : iproute-4.11.0-25.el7_7.2.x86_64                         105/354 
  Verifying  : libuuid-2.23.2-61.el7_7.1.x86_64                         106/354 
  Verifying  : e2fsprogs-1.42.9-16.el7.x86_64                           107/354 
  Verifying  : systemd-libs-219-67.el7_7.3.x86_64                       108/354 
  Verifying  : nss-sysinit-3.44.0-7.el7_7.x86_64                        109/354 
  Verifying  : openssh-clients-7.4p1-21.el7.x86_64                      110/354 
  Verifying  : libsepol-2.5-10.el7.x86_64                               111/354 
  Verifying  : cloud-utils-growpart-0.29-5.el7.noarch                   112/354 
  Verifying  : nss-softokn-3.44.0-8.el7_7.x86_64                        113/354 
  Verifying  : kmod-libs-20-25.el7.x86_64                               114/354 
  Verifying  : chrony-3.4-1.el7.x86_64                                  115/354 
  Verifying  : libcroco-0.6.12-4.el7.x86_64                             116/354 
  Verifying  : ca-certificates-2019.2.32-76.el7_7.noarch                117/354 
  Verifying  : 1:dbus-libs-1.10.24-13.el7_6.x86_64                      118/354 
  Verifying  : tuned-2.11.0-5.el7_7.1.noarch                            119/354 
  Verifying  : python-chardet-2.2.1-3.el7.noarch                        120/354 
  Verifying  : 1:grub2-tools-minimal-2.02-0.80.el7.centos.x86_64        121/354 
  Verifying  : 2:ethtool-4.8-10.el7.x86_64                              122/354 
  Verifying  : openssh-7.4p1-21.el7.x86_64                              123/354 
  Verifying  : 1:grub2-pc-modules-2.02-0.80.el7.centos.noarch           124/354 
  Verifying  : 2:postfix-2.10.1-7.el7.x86_64                            125/354 
  Verifying  : net-tools-2.0-0.25.20131004git.el7.x86_64                126/354 
  Verifying  : libref_array-0.1.5-32.el7.x86_64                         127/354 
  Verifying  : json-c-0.11-4.el7_0.x86_64                               128/354 
  Verifying  : dracut-033-564.el7.x86_64                                129/354 
  Verifying  : rpm-python-4.11.3-40.el7.x86_64                          130/354 
  Verifying  : audit-2.8.5-4.el7.x86_64                                 131/354 
  Verifying  : postgresql-libs-9.2.24-2.el7_7.x86_64                    132/354 
  Verifying  : systemd-219-67.el7_7.3.x86_64                            133/354 
  Verifying  : linux-firmware-20190429-72.gitddde598.el7.noarch         134/354 
  Verifying  : rpcbind-0.2.0-48.el7.x86_64                              135/354 
  Verifying  : kernel-headers-3.10.0-1062.12.1.el7.x86_64               136/354 
  Verifying  : xfsprogs-4.5.0-20.el7.x86_64                             137/354 
  Verifying  : mesa-libglapi-18.3.4-6.el7_7.x86_64                      138/354 
  Verifying  : dracut-config-generic-033-564.el7.x86_64                 139/354 
  Verifying  : sudo-1.8.23-4.el7_7.1.x86_64                             140/354 
  Verifying  : yum-3.4.3-163.el7.centos.noarch                          141/354 
  Verifying  : 10:qemu-guest-agent-2.12.0-3.el7.x86_64                  142/354 
  Verifying  : lz4-1.7.5-3.el7.x86_64                                   143/354 
  Verifying  : rpm-libs-4.11.3-40.el7.x86_64                            144/354 
  Verifying  : openjpeg2-2.3.1-2.el7_7.x86_64                           145/354 
  Verifying  : python-requests-2.6.0-8.el7_7.noarch                     146/354 
  Verifying  : 1:grub2-pc-2.02-0.80.el7.centos.x86_64                   147/354 
  Verifying  : geoipupdate-2.5.0-1.el7.x86_64                           148/354 
  Verifying  : nss-tools-3.44.0-7.el7_7.x86_64                          149/354 
  Verifying  : iptables-1.4.21-33.el7.x86_64                            150/354 
  Verifying  : kbd-misc-1.15.5-15.el7.noarch                            151/354 
  Verifying  : checkpolicy-2.5-8.el7.x86_64                             152/354 
  Verifying  : 1:make-3.82-24.el7.x86_64                                153/354 
  Verifying  : cloud-init-18.5-3.el7.centos.x86_64                      154/354 
  Verifying  : setools-libs-3.3.8-4.el7.x86_64                          155/354 
  Verifying  : audit-libs-python-2.8.5-4.el7.x86_64                     156/354 
  Verifying  : gssproxy-0.7.0-26.el7.x86_64                             157/354 
  Verifying  : setup-2.8.71-10.el7.noarch                               158/354 
  Verifying  : cronie-anacron-1.4.11-23.el7.x86_64                      159/354 
  Verifying  : libselinux-2.5-14.1.el7.x86_64                           160/354 
  Verifying  : 2:shadow-utils-4.6-5.el7.x86_64                          161/354 
  Verifying  : audit-libs-2.8.5-4.el7.x86_64                            162/354 
  Verifying  : gnupg2-2.0.22-5.el7_5.x86_64                             163/354 
  Verifying  : 3:irqbalance-1.0.7-12.el7.x86_64                         164/354 
  Verifying  : 1:dbus-1.10.24-13.el7_6.x86_64                           165/354 
  Verifying  : coreutils-8.22-24.el7.x86_64                             166/354 
  Verifying  : teamd-1.27-9.el7.x86_64                                  167/354 
  Verifying  : 1:findutils-4.5.11-6.el7.x86_64                          168/354 
  Verifying  : rpm-4.11.3-40.el7.x86_64                                 169/354 
  Verifying  : 7:device-mapper-1.02.158-2.el7_7.2.x86_64                170/354 
  Verifying  : 2:tar-1.26-35.el7.x86_64                                 171/354 
  Verifying  : selinux-policy-3.13.1-252.el7_7.6.noarch                 172/354 
  Verifying  : procps-ng-3.3.10-26.el7_7.1.x86_64                       173/354 
  Verifying  : man-db-2.6.3-11.el7.x86_64                               174/354 
  Verifying  : libini_config-1.3.1-32.el7.x86_64                        175/354 
  Verifying  : krb5-libs-1.15.1-37.el7_7.2.x86_64                       176/354 
  Verifying  : libsemanage-python-2.5-14.el7.x86_64                     177/354 
  Verifying  : curl-7.29.0-54.el7_7.2.x86_64                            178/354 
  Verifying  : kmod-20-25.el7.x86_64                                    179/354 
  Verifying  : elfutils-libelf-0.176-2.el7.x86_64                       180/354 
  Verifying  : libsemanage-python-2.5-11.el7.x86_64                     181/354 
  Verifying  : libbasicobjects-0.1.1-29.el7.x86_64                      182/354 
  Verifying  : systemd-sysv-219-57.el7.x86_64                           183/354 
  Verifying  : 1:make-3.82-23.el7.x86_64                                184/354 
  Verifying  : libcom_err-1.42.9-12.el7_5.x86_64                        185/354 
  Verifying  : python-perf-3.10.0-862.3.2.el7.x86_64                    186/354 
  Verifying  : kbd-misc-1.15.5-13.el7.noarch                            187/354 
  Verifying  : sqlite-3.7.17-8.el7.x86_64                               188/354 
  Verifying  : checkpolicy-2.5-6.el7.x86_64                             189/354 
  Verifying  : nspr-4.19.0-1.el7_5.x86_64                               190/354 
  Verifying  : net-tools-2.0-0.22.20131004git.el7.x86_64                191/354 
  Verifying  : cloud-utils-growpart-0.29-2.el7.noarch                   192/354 
  Verifying  : sg3_utils-libs-1.37-12.el7.x86_64                        193/354 
  Verifying  : 2:ethtool-4.8-7.el7.x86_64                               194/354 
  Verifying  : binutils-2.27-27.base.el7.x86_64                         195/354 
  Verifying  : elfutils-default-yama-scope-0.170-4.el7.noarch           196/354 
  Verifying  : xfsprogs-4.5.0-15.el7.x86_64                             197/354 
  Verifying  : lshw-B.02.18-12.el7.x86_64                               198/354 
  Verifying  : audit-2.8.1-3.el7.x86_64                                 199/354 
  Verifying  : selinux-policy-3.13.1-192.el7_5.3.noarch                 200/354 
  Verifying  : gssproxy-0.7.0-17.el7.x86_64                             201/354 
  Verifying  : rsync-3.1.2-4.el7.x86_64                                 202/354 
  Verifying  : libsepol-2.5-8.1.el7.x86_64                              203/354 
  Verifying  : 32:bind-license-9.9.4-61.el7.noarch                      204/354 
  Verifying  : libpath_utils-0.2.1-29.el7.x86_64                        205/354 
  Verifying  : ca-certificates-2018.2.22-70.0.el7_5.noarch              206/354 
  Verifying  : 10:qemu-guest-agent-2.8.0-2.el7.x86_64                   207/354 
  Verifying  : setools-libs-3.3.8-2.el7.x86_64                          208/354 
  Verifying  : curl-7.29.0-46.el7.x86_64                                209/354 
  Verifying  : audit-libs-2.8.1-3.el7.x86_64                            210/354 
  Verifying  : python-linux-procfs-0.4.9-3.el7.noarch                   211/354 
  Verifying  : audit-libs-python-2.8.1-3.el7.x86_64                     212/354 
  Verifying  : procps-ng-3.3.10-17.el7_5.2.x86_64                       213/354 
  Verifying  : 1:grub2-pc-2.02-0.65.el7.centos.2.x86_64                 214/354 
  Verifying  : rpm-python-4.11.3-32.el7.x86_64                          215/354 
  Verifying  : 1:grub2-tools-minimal-2.02-0.65.el7.centos.2.x86_64      216/354 
  Verifying  : mesa-libEGL-18.3.4-5.el7.x86_64                          217/354 
  Verifying  : libini_config-1.3.1-29.el7.x86_64                        218/354 
  Verifying  : rpm-build-libs-4.11.3-32.el7.x86_64                      219/354 
  Verifying  : nss-tools-3.36.0-5.el7_5.x86_64                          220/354 
  Verifying  : libteam-1.27-4.el7.x86_64                                221/354 
  Verifying  : 12:dhclient-4.2.5-68.el7.centos.1.x86_64                 222/354 
  Verifying  : nss-sysinit-3.36.0-5.el7_5.x86_64                        223/354 
  Verifying  : iwl7265-firmware-22.0.7.0-62.1.el7_5.noarch              224/354 
  Verifying  : kernel-tools-libs-3.10.0-862.3.2.el7.x86_64              225/354 
  Verifying  : python-requests-2.6.0-1.el7_1.noarch                     226/354 
  Verifying  : 2:tar-1.26-34.el7.x86_64                                 227/354 
  Verifying  : python-chardet-2.2.1-1.el7_1.noarch                      228/354 
  Verifying  : rpm-libs-4.11.3-32.el7.x86_64                            229/354 
  Verifying  : libselinux-python-2.5-12.el7.x86_64                      230/354 
  Verifying  : polkit-0.112-14.el7.x86_64                               231/354 
  Verifying  : kexec-tools-2.0.15-13.el7.x86_64                         232/354 
  Verifying  : openjpeg2-2.3.1-1.el7.x86_64                             233/354 
  Verifying  : libssh2-1.4.3-10.el7_2.1.x86_64                          234/354 
  Verifying  : gobject-introspection-1.50.0-1.el7.x86_64                235/354 
  Verifying  : sg3_utils-1.37-12.el7.x86_64                             236/354 
  Verifying  : iptables-1.4.21-24.1.el7_5.x86_64                        237/354 
  Verifying  : 1:grub2-tools-extra-2.02-0.65.el7.centos.2.x86_64        238/354 
  Verifying  : 7:device-mapper-1.02.146-4.el7.x86_64                    239/354 
  Verifying  : readline-6.2-10.el7.x86_64                               240/354 
  Verifying  : gnupg2-2.0.22-4.el7.x86_64                               241/354 
  Verifying  : setup-2.8.71-9.el7.noarch                                242/354 
  Verifying  : cronie-anacron-1.4.11-19.el7.x86_64                      243/354 
  Verifying  : nss-util-3.36.0-1.el7_5.x86_64                           244/354 
  Verifying  : 1:nfs-utils-1.3.0-0.54.el7.x86_64                        245/354 
  Verifying  : e2fsprogs-1.42.9-12.el7_5.x86_64                         246/354 
  Verifying  : krb5-libs-1.15.1-19.el7.x86_64                           247/354 
  Verifying  : selinux-policy-targeted-3.13.1-192.el7_5.3.noarch        248/354 
  Verifying  : libss-1.42.9-12.el7_5.x86_64                             249/354 
  Verifying  : dracut-config-rescue-033-535.el7.x86_64                  250/354 
  Verifying  : libselinux-2.5-12.el7.x86_64                             251/354 
  Verifying  : openssh-clients-7.4p1-16.el7.x86_64                      252/354 
  Verifying  : nss-3.36.0-5.el7_5.x86_64                                253/354 
  Verifying  : 2:microcode_ctl-2.1-29.2.el7_5.x86_64                    254/354 
  Verifying  : 1:wpa_supplicant-2.6-9.el7.x86_64                        255/354 
  Verifying  : iproute-4.11.0-14.el7.x86_64                             256/354 
  Verifying  : parted-3.1-29.el7.x86_64                                 257/354 
  Verifying  : cloud-init-0.7.9-24.el7.centos.x86_64                    258/354 
  Verifying  : centos-release-7-5.1804.el7.centos.2.x86_64              259/354 
  Verifying  : 1:dmidecode-3.0-5.el7.x86_64                             260/354 
  Verifying  : systemd-libs-219-57.el7.x86_64                           261/354 
  Verifying  : 1:findutils-4.5.11-5.el7.x86_64                          262/354 
  Verifying  : 1:mariadb-libs-5.5.56-2.el7.x86_64                       263/354 
  Verifying  : teamd-1.27-4.el7.x86_64                                  264/354 
  Verifying  : 1:grub2-2.02-0.65.el7.centos.2.x86_64                    265/354 
  Verifying  : policycoreutils-python-2.5-22.el7.x86_64                 266/354 
  Verifying  : kbd-legacy-1.15.5-13.el7.noarch                          267/354 
  Verifying  : file-libs-5.11-33.el7.x86_64                             268/354 
  Verifying  : grubby-8.28-23.el7.x86_64                                269/354 
  Verifying  : 12:dhcp-libs-4.2.5-68.el7.centos.1.x86_64                270/354 
  Verifying  : util-linux-2.23.2-52.el7.x86_64                          271/354 
  Verifying  : dracut-network-033-535.el7.x86_64                        272/354 
  Verifying  : openssh-7.4p1-16.el7.x86_64                              273/354 
  Verifying  : libcroco-0.6.11-1.el7.x86_64                             274/354 
  Verifying  : 7:device-mapper-libs-1.02.146-4.el7.x86_64               275/354 
  Verifying  : python-jinja2-2.7.2-2.el7.noarch                         276/354 
  Verifying  : 1:dbus-libs-1.10.24-7.el7.x86_64                         277/354 
  Verifying  : openssh-server-7.4p1-16.el7.x86_64                       278/354 
  Verifying  : 2:vim-minimal-7.4.160-4.el7.x86_64                       279/354 
  Verifying  : python-urllib3-1.10.2-5.el7.noarch                       280/354 
  Verifying  : 12:dhcp-common-4.2.5-68.el7.centos.1.x86_64              281/354 
  Verifying  : bash-4.2.46-30.el7.x86_64                                282/354 
  Verifying  : 2:shadow-utils-4.1.5.1-24.el7.x86_64                     283/354 
  Verifying  : coreutils-8.22-21.el7.x86_64                             284/354 
  Verifying  : initscripts-9.49.41-1.el7.x86_64                         285/354 
  Verifying  : libselinux-utils-2.5-12.el7.x86_64                       286/354 
  Verifying  : libndp-1.2-7.el7.x86_64                                  287/354 
  Verifying  : postgresql-9.2.24-1.el7_5.x86_64                         288/354 
  Verifying  : file-5.11-33.el7.x86_64                                  289/354 
  Verifying  : libmount-2.23.2-52.el7.x86_64                            290/354 
  Verifying  : passwd-0.79-4.el7.x86_64                                 291/354 
  Verifying  : kmod-20-21.el7.x86_64                                    292/354 
  Verifying  : libcgroup-0.41-15.el7.x86_64                             293/354 
  Verifying  : numactl-libs-2.0.9-7.el7.x86_64                          294/354 
  Verifying  : hostname-3.13-3.el7.x86_64                               295/354 
  Verifying  : libsemanage-2.5-11.el7.x86_64                            296/354 
  Verifying  : libfastjson-0.99.4-2.el7.x86_64                          297/354 
  Verifying  : nss-softokn-freebl-3.36.0-5.el7_5.x86_64                 298/354 
  Verifying  : elfutils-libelf-0.170-4.el7.x86_64                       299/354 
  Verifying  : mesa-libgbm-18.3.4-5.el7.x86_64                          300/354 
  Verifying  : 2:postfix-2.10.1-6.el7.x86_64                            301/354 
  Verifying  : 1:quota-nls-4.01-17.el7.noarch                           302/354 
  Verifying  : kmod-libs-20-21.el7.x86_64                               303/354 
  Verifying  : yum-plugin-fastestmirror-1.1.31-45.el7.noarch            304/354 
  Verifying  : diffutils-3.3-4.el7.x86_64                               305/354 
  Verifying  : 3:irqbalance-1.0.7-11.el7.x86_64                         306/354 
  Verifying  : yum-utils-1.1.31-45.el7.noarch                           307/354 
  Verifying  : kernel-tools-3.10.0-862.3.2.el7.x86_64                   308/354 
  Verifying  : libref_array-0.1.5-29.el7.x86_64                         309/354 
  Verifying  : 1:grub2-common-2.02-0.65.el7.centos.2.noarch             310/354 
  Verifying  : kernel-headers-3.10.0-1062.9.1.el7.x86_64                311/354 
  Verifying  : rpcbind-0.2.0-44.el7.x86_64                              312/354 
  Verifying  : dracut-033-535.el7.x86_64                                313/354 
  Verifying  : logrotate-3.8.6-15.el7.x86_64                            314/354 
  Verifying  : kbd-1.15.5-13.el7.x86_64                                 315/354 
  Verifying  : 32:bind-libs-lite-9.9.4-61.el7.x86_64                    316/354 
  Verifying  : postgresql-libs-9.2.24-1.el7_5.x86_64                    317/354 
  Verifying  : openldap-2.4.44-15.el7_5.x86_64                          318/354 
  Verifying  : dracut-config-generic-033-535.el7.x86_64                 319/354 
  Verifying  : libcollection-0.7.0-29.el7.x86_64                        320/354 
  Verifying  : tuned-2.9.0-1.el7.noarch                                 321/354 
  Verifying  : libcurl-7.29.0-46.el7.x86_64                             322/354 
  Verifying  : lz4-1.7.5-2.el7.x86_64                                   323/354 
  Verifying  : rsyslog-8.24.0-16.el7_5.4.x86_64                         324/354 
  Verifying  : libuuid-2.23.2-52.el7.x86_64                             325/354 
  Verifying  : postgresql-server-9.2.24-1.el7_5.x86_64                  326/354 
  Verifying  : rpm-4.11.3-32.el7.x86_64                                 327/354 
  Verifying  : tzdata-2018e-3.el7.noarch                                328/354 
  Verifying  : nss-pem-1.0.3-4.el7.x86_64                               329/354 
  Verifying  : policycoreutils-2.5-22.el7.x86_64                        330/354 
  Verifying  : python-urlgrabber-3.10-8.el7.noarch                      331/354 
  Verifying  : yum-3.4.3-158.el7.centos.noarch                          332/354 
  Verifying  : elfutils-libs-0.170-4.el7.x86_64                         333/354 
  Verifying  : e2fsprogs-libs-1.42.9-12.el7_5.x86_64                    334/354 
  Verifying  : chrony-3.2-2.el7.x86_64                                  335/354 
  Verifying  : 1:quota-4.01-17.el7.x86_64                               336/354 
  Verifying  : 1:grub2-tools-2.02-0.65.el7.centos.2.x86_64              337/354 
  Verifying  : sudo-1.8.19p2-13.el7.x86_64                              338/354 
  Verifying  : nss-softokn-3.36.0-5.el7_5.x86_64                        339/354 
  Verifying  : libblkid-2.23.2-52.el7.x86_64                            340/354 
  Verifying  : cryptsetup-libs-1.7.4-4.el7.x86_64                       341/354 
  Verifying  : 1:dbus-1.10.24-7.el7.x86_64                              342/354 
  Verifying  : kpartx-0.4.9-119.el7.x86_64                              343/354 
  Verifying  : mesa-libglapi-18.3.4-5.el7.x86_64                        344/354 
  Verifying  : mesa-libGL-18.3.4-5.el7.x86_64                           345/354 
  Verifying  : zlib-1.2.7-17.el7.x86_64                                 346/354 
  Verifying  : man-db-2.6.3-9.el7.x86_64                                347/354 
  Verifying  : libcap-2.22-9.el7.x86_64                                 348/354 
  Verifying  : systemd-219-57.el7.x86_64                                349/354 
  Verifying  : hwdata-0.252-8.8.el7.x86_64                              350/354 
  Verifying  : cronie-1.4.11-19.el7.x86_64                              351/354 
  Verifying  : GeoIP-1.5.0-11.el7.x86_64                                352/354 
  Verifying  : 1:grub2-pc-modules-2.02-0.65.el7.centos.2.noarch         353/354 
  Verifying  : libstdc++-4.8.5-28.el7_5.1.x86_64                        354/354 

Installed:
  grub2.x86_64 1:2.02-0.80.el7.centos                                           
  grub2-tools.x86_64 1:2.02-0.80.el7.centos                                     
  grub2-tools-extra.x86_64 1:2.02-0.80.el7.centos                               
  grub2-tools-minimal.x86_64 1:2.02-0.80.el7.centos                             
  kernel.x86_64 0:3.10.0-1062.12.1.el7                                          

Dependency Installed:
  bind-export-libs.x86_64 32:9.11.4-9.P2.el7                                    
  geoipupdate.x86_64 0:2.5.0-1.el7                                              
  json-c.x86_64 0:0.11-4.el7_0                                                  
  libsmartcols.x86_64 0:2.23.2-61.el7_7.1                                       
  linux-firmware.noarch 0:20190429-72.gitddde598.el7                            

Updated:
  GeoIP.x86_64 0:1.5.0-14.el7                                                   
  audit.x86_64 0:2.8.5-4.el7                                                    
  audit-libs.x86_64 0:2.8.5-4.el7                                               
  audit-libs-python.x86_64 0:2.8.5-4.el7                                        
  bash.x86_64 0:4.2.46-33.el7                                                   
  bind-libs-lite.x86_64 32:9.11.4-9.P2.el7                                      
  bind-license.noarch 32:9.11.4-9.P2.el7                                        
  binutils.x86_64 0:2.27-41.base.el7_7.2                                        
  ca-certificates.noarch 0:2019.2.32-76.el7_7                                   
  centos-release.x86_64 0:7-7.1908.0.el7.centos                                 
  checkpolicy.x86_64 0:2.5-8.el7                                                
  chrony.x86_64 0:3.4-1.el7                                                     
  cloud-init.x86_64 0:18.5-3.el7.centos                                         
  cloud-utils-growpart.noarch 0:0.29-5.el7                                      
  coreutils.x86_64 0:8.22-24.el7                                                
  cronie.x86_64 0:1.4.11-23.el7                                                 
  cronie-anacron.x86_64 0:1.4.11-23.el7                                         
  cryptsetup-libs.x86_64 0:2.0.3-5.el7                                          
  curl.x86_64 0:7.29.0-54.el7_7.2                                               
  dbus.x86_64 1:1.10.24-13.el7_6                                                
  dbus-libs.x86_64 1:1.10.24-13.el7_6                                           
  device-mapper.x86_64 7:1.02.158-2.el7_7.2                                     
  device-mapper-libs.x86_64 7:1.02.158-2.el7_7.2                                
  dhclient.x86_64 12:4.2.5-77.el7.centos                                        
  dhcp-common.x86_64 12:4.2.5-77.el7.centos                                     
  dhcp-libs.x86_64 12:4.2.5-77.el7.centos                                       
  diffutils.x86_64 0:3.3-5.el7                                                  
  dmidecode.x86_64 1:3.2-3.el7                                                  
  dracut.x86_64 0:033-564.el7                                                   
  dracut-config-generic.x86_64 0:033-564.el7                                    
  dracut-config-rescue.x86_64 0:033-564.el7                                     
  dracut-network.x86_64 0:033-564.el7                                           
  e2fsprogs.x86_64 0:1.42.9-16.el7                                              
  e2fsprogs-libs.x86_64 0:1.42.9-16.el7                                         
  elfutils-default-yama-scope.noarch 0:0.176-2.el7                              
  elfutils-libelf.x86_64 0:0.176-2.el7                                          
  elfutils-libs.x86_64 0:0.176-2.el7                                            
  ethtool.x86_64 2:4.8-10.el7                                                   
  file.x86_64 0:5.11-35.el7                                                     
  file-libs.x86_64 0:5.11-35.el7                                                
  findutils.x86_64 1:4.5.11-6.el7                                               
  gnupg2.x86_64 0:2.0.22-5.el7_5                                                
  gobject-introspection.x86_64 0:1.56.1-1.el7                                   
  grub2-common.noarch 1:2.02-0.80.el7.centos                                    
  grub2-pc.x86_64 1:2.02-0.80.el7.centos                                        
  grub2-pc-modules.noarch 1:2.02-0.80.el7.centos                                
  grubby.x86_64 0:8.28-26.el7                                                   
  gssproxy.x86_64 0:0.7.0-26.el7                                                
  hostname.x86_64 0:3.13-3.el7_7.1                                              
  hwdata.x86_64 0:0.252-9.3.el7                                                 
  initscripts.x86_64 0:9.49.47-1.el7                                            
  iproute.x86_64 0:4.11.0-25.el7_7.2                                            
  iptables.x86_64 0:1.4.21-33.el7                                               
  irqbalance.x86_64 3:1.0.7-12.el7                                              
  iwl7265-firmware.noarch 0:22.0.7.0-72.el7                                     
  kbd.x86_64 0:1.15.5-15.el7                                                    
  kbd-legacy.noarch 0:1.15.5-15.el7                                             
  kbd-misc.noarch 0:1.15.5-15.el7                                               
  kernel-headers.x86_64 0:3.10.0-1062.12.1.el7                                  
  kernel-tools.x86_64 0:3.10.0-1062.12.1.el7                                    
  kernel-tools-libs.x86_64 0:3.10.0-1062.12.1.el7                               
  kexec-tools.x86_64 0:2.0.15-33.el7                                            
  kmod.x86_64 0:20-25.el7                                                       
  kmod-libs.x86_64 0:20-25.el7                                                  
  kpartx.x86_64 0:0.4.9-127.el7                                                 
  krb5-libs.x86_64 0:1.15.1-37.el7_7.2                                          
  libbasicobjects.x86_64 0:0.1.1-32.el7                                         
  libblkid.x86_64 0:2.23.2-61.el7_7.1                                           
  libcap.x86_64 0:2.22-10.el7                                                   
  libcgroup.x86_64 0:0.41-21.el7                                                
  libcollection.x86_64 0:0.7.0-32.el7                                           
  libcom_err.x86_64 0:1.42.9-16.el7                                             
  libcroco.x86_64 0:0.6.12-4.el7                                                
  libcurl.x86_64 0:7.29.0-54.el7_7.2                                            
  libfastjson.x86_64 0:0.99.4-3.el7                                             
  libini_config.x86_64 0:1.3.1-32.el7                                           
  libmount.x86_64 0:2.23.2-61.el7_7.1                                           
  libndp.x86_64 0:1.2-9.el7                                                     
  libpath_utils.x86_64 0:0.2.1-32.el7                                           
  libref_array.x86_64 0:0.1.5-32.el7                                            
  libselinux.x86_64 0:2.5-14.1.el7                                              
  libselinux-python.x86_64 0:2.5-14.1.el7                                       
  libselinux-utils.x86_64 0:2.5-14.1.el7                                        
  libsemanage.x86_64 0:2.5-14.el7                                               
  libsemanage-python.x86_64 0:2.5-14.el7                                        
  libsepol.x86_64 0:2.5-10.el7                                                  
  libss.x86_64 0:1.42.9-16.el7                                                  
  libssh2.x86_64 0:1.8.0-3.el7                                                  
  libstdc++.x86_64 0:4.8.5-39.el7                                               
  libteam.x86_64 0:1.27-9.el7                                                   
  libuuid.x86_64 0:2.23.2-61.el7_7.1                                            
  logrotate.x86_64 0:3.8.6-17.el7                                               
  lshw.x86_64 0:B.02.18-13.el7                                                  
  lz4.x86_64 0:1.7.5-3.el7                                                      
  make.x86_64 1:3.82-24.el7                                                     
  man-db.x86_64 0:2.6.3-11.el7                                                  
  mariadb-libs.x86_64 1:5.5.64-1.el7                                            
  mesa-libEGL.x86_64 0:18.3.4-6.el7_7                                           
  mesa-libGL.x86_64 0:18.3.4-6.el7_7                                            
  mesa-libgbm.x86_64 0:18.3.4-6.el7_7                                           
  mesa-libglapi.x86_64 0:18.3.4-6.el7_7                                         
  microcode_ctl.x86_64 2:2.1-53.7.el7_7                                         
  net-tools.x86_64 0:2.0-0.25.20131004git.el7                                   
  nfs-utils.x86_64 1:1.3.0-0.65.el7                                             
  nspr.x86_64 0:4.21.0-1.el7                                                    
  nss.x86_64 0:3.44.0-7.el7_7                                                   
  nss-pem.x86_64 0:1.0.3-7.el7                                                  
  nss-softokn.x86_64 0:3.44.0-8.el7_7                                           
  nss-softokn-freebl.x86_64 0:3.44.0-8.el7_7                                    
  nss-sysinit.x86_64 0:3.44.0-7.el7_7                                           
  nss-tools.x86_64 0:3.44.0-7.el7_7                                             
  nss-util.x86_64 0:3.44.0-4.el7_7                                              
  numactl-libs.x86_64 0:2.0.12-3.el7_7.1                                        
  openjpeg2.x86_64 0:2.3.1-2.el7_7                                              
  openldap.x86_64 0:2.4.44-21.el7_6                                             
  openssh.x86_64 0:7.4p1-21.el7                                                 
  openssh-clients.x86_64 0:7.4p1-21.el7                                         
  openssh-server.x86_64 0:7.4p1-21.el7                                          
  parted.x86_64 0:3.1-31.el7                                                    
  passwd.x86_64 0:0.79-5.el7                                                    
  policycoreutils.x86_64 0:2.5-33.el7                                           
  policycoreutils-python.x86_64 0:2.5-33.el7                                    
  polkit.x86_64 0:0.112-22.el7_7.1                                              
  postfix.x86_64 2:2.10.1-7.el7                                                 
  postgresql.x86_64 0:9.2.24-2.el7_7                                            
  postgresql-libs.x86_64 0:9.2.24-2.el7_7                                       
  postgresql-server.x86_64 0:9.2.24-2.el7_7                                     
  procps-ng.x86_64 0:3.3.10-26.el7_7.1                                          
  python-chardet.noarch 0:2.2.1-3.el7                                           
  python-jinja2.noarch 0:2.7.2-4.el7                                            
  python-linux-procfs.noarch 0:0.4.11-4.el7                                     
  python-perf.x86_64 0:3.10.0-1062.12.1.el7                                     
  python-requests.noarch 0:2.6.0-8.el7_7                                        
  python-urlgrabber.noarch 0:3.10-9.el7                                         
  python-urllib3.noarch 0:1.10.2-7.el7                                          
  qemu-guest-agent.x86_64 10:2.12.0-3.el7                                       
  quota.x86_64 1:4.01-19.el7                                                    
  quota-nls.noarch 1:4.01-19.el7                                                
  readline.x86_64 0:6.2-11.el7                                                  
  rpcbind.x86_64 0:0.2.0-48.el7                                                 
  rpm.x86_64 0:4.11.3-40.el7                                                    
  rpm-build-libs.x86_64 0:4.11.3-40.el7                                         
  rpm-libs.x86_64 0:4.11.3-40.el7                                               
  rpm-python.x86_64 0:4.11.3-40.el7                                             
  rsync.x86_64 0:3.1.2-6.el7_6.1                                                
  rsyslog.x86_64 0:8.24.0-41.el7_7.2                                            
  selinux-policy.noarch 0:3.13.1-252.el7_7.6                                    
  selinux-policy-targeted.noarch 0:3.13.1-252.el7_7.6                           
  setools-libs.x86_64 0:3.3.8-4.el7                                             
  setup.noarch 0:2.8.71-10.el7                                                  
  sg3_utils.x86_64 0:1.37-18.el7_7.2                                            
  sg3_utils-libs.x86_64 0:1.37-18.el7_7.2                                       
  shadow-utils.x86_64 2:4.6-5.el7                                               
  sqlite.x86_64 0:3.7.17-8.el7_7.1                                              
  sudo.x86_64 0:1.8.23-4.el7_7.1                                                
  systemd.x86_64 0:219-67.el7_7.3                                               
  systemd-libs.x86_64 0:219-67.el7_7.3                                          
  systemd-sysv.x86_64 0:219-67.el7_7.3                                          
  tar.x86_64 2:1.26-35.el7                                                      
  teamd.x86_64 0:1.27-9.el7                                                     
  tuned.noarch 0:2.11.0-5.el7_7.1                                               
  tzdata.noarch 0:2019c-1.el7                                                   
  util-linux.x86_64 0:2.23.2-61.el7_7.1                                         
  vim-minimal.x86_64 2:7.4.629-6.el7                                            
  wpa_supplicant.x86_64 1:2.6-12.el7                                            
  xfsprogs.x86_64 0:4.5.0-20.el7                                                
  yum.noarch 0:3.4.3-163.el7.centos                                             
  yum-plugin-fastestmirror.noarch 0:1.1.31-52.el7                               
  yum-utils.noarch 0:1.1.31-52.el7                                              
  zlib.x86_64 0:1.2.7-18.el7                                                    

Replaced:
  grub2.x86_64 1:2.02-0.65.el7.centos.2                                         
  grub2-tools.x86_64 1:2.02-0.65.el7.centos.2                                   

Complete!
[centos@d-hdp1 ~]$ sudo yam update openssh
sudo: yam: command not found
[centos@d-hdp1 ~]$ sudo yum update openssh
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mozart.ee.ic.ac.uk
 * extras: mozart.ee.ic.ac.uk
 * updates: mirrors.ukfast.co.uk
No packages marked for update
[centos@d-hdp1 ~]$ openssh
-bash: openssh: command not found
[centos@d-hdp1 ~]$ rpm -qa --last|grep "openssh"
openssh-server-7.4p1-21.el7.x86_64            Thu 06 Feb 2020 14:36:43 UTC
openssh-clients-7.4p1-21.el7.x86_64           Thu 06 Feb 2020 14:36:43 UTC
openssh-7.4p1-21.el7.x86_64                   Thu 06 Feb 2020 14:35:55 UTC
[centos@d-hdp1 ~]$ ls
1.sql
confluent-hub-client-latest.tar.gz
confluentinc-kafka-connect-hdfs-5.4.0
confluentinc-kafka-connect-hdfs-5.4.0.zip
helloworld.jar
jcustenborder-kafka-connect-twitter-0.3.33.zip
kafka-connect-hdfs
postgresql-42.2.9.jar
testconnectors
[centos@d-hdp1 ~]$ mkdir earthquakes-etl
[centos@d-hdp1 ~]$ cd earthquakes-etl/
[centos@d-hdp1 earthquakes-etl]$ ls
[centos@d-hdp1 earthquakes-etl]$ ls
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/1.sql
[centos@d-hdp1 earthquakes-etl]$ ls
1.sql
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n hive -f 1.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.616 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.344 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_full_dataset
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   year int,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   date_time string,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   depth double,
0: jdbc:hive2://localhost:10000>   mag double,
0: jdbc:hive2://localhost:10000>   magType string,
0: jdbc:hive2://localhost:10000>   nst string,
0: jdbc:hive2://localhost:10000>   gap string,
0: jdbc:hive2://localhost:10000>   dmin string,
0: jdbc:hive2://localhost:10000>   rms string,
0: jdbc:hive2://localhost:10000>   net string,
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   updated string,
0: jdbc:hive2://localhost:10000>   place string,
0: jdbc:hive2://localhost:10000>   type string,
0: jdbc:hive2://localhost:10000>   horizontalError string,
0: jdbc:hive2://localhost:10000>   depthError string,
0: jdbc:hive2://localhost:10000>   magError string,
0: jdbc:hive2://localhost:10000>   magNst string,
0: jdbc:hive2://localhost:10000>   status string,
0: jdbc:hive2://localhost:10000>   locationSource string,
0: jdbc:hive2://localhost:10000>   magSource string
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.632 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
ERROR : Failed with exception Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv
org.apache.hadoop.hive.ql.metadata.HiveException: Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv
	at org.apache.hadoop.hive.ql.metadata.Hive.moveFile(Hive.java:3263)
	at org.apache.hadoop.hive.ql.metadata.Hive.replaceFiles(Hive.java:3528)
	at org.apache.hadoop.hive.ql.metadata.Hive.loadTable(Hive.java:1941)
	at org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:398)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:177)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:96)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1777)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1511)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1308)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1175)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1170)
	at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:197)
	at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:76)
	at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:255)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.hadoop.security.AccessControlException: Permission denied: user=hive, access=WRITE, inode="/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv":admin:hdfs:drwxr-xr-x
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:353)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:325)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:249)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:190)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1950)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameTo(FSDirRenameOp.java:477)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameToInt(FSDirRenameOp.java:73)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.renameTo(FSNamesystem.java:3942)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.rename(NameNodeRpcServer.java:993)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.rename(ClientNamenodeProtocolServerSideTranslatorPB.java:587)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:640)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:982)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2351)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2347)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2347)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)
	at org.apache.hadoop.hdfs.DFSClient.rename(DFSClient.java:2019)
	at org.apache.hadoop.hdfs.DistributedFileSystem.rename(DistributedFileSystem.java:732)
	at org.apache.hadoop.hive.ql.metadata.Hive.moveFile(Hive.java:3251)
	... 24 more
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=hive, access=WRITE, inode="/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv":admin:hdfs:drwxr-xr-x
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:353)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:325)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:249)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:190)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1950)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameTo(FSDirRenameOp.java:477)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameToInt(FSDirRenameOp.java:73)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.renameTo(FSNamesystem.java:3942)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.rename(NameNodeRpcServer.java:993)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.rename(ClientNamenodeProtocolServerSideTranslatorPB.java:587)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:640)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:982)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2351)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2347)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2347)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)
	at org.apache.hadoop.ipc.Client.call(Client.java:1498)
	at org.apache.hadoop.ipc.Client.call(Client.java:1398)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at com.sun.proxy.$Proxy19.rename(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.rename(ClientNamenodeProtocolTranslatorPB.java:529)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)
	at com.sun.proxy.$Proxy20.rename(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.rename(DFSClient.java:2017)
	... 26 more

Error: Error while processing statement: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.exec.MoveTask. Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv (state=08S01,code=40000)

Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ vi 1.sql 
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n hive -f 1.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.622 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.59 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_full_dataset
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   year int,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   date_time string,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   depth double,
0: jdbc:hive2://localhost:10000>   mag double,
0: jdbc:hive2://localhost:10000>   magType string,
0: jdbc:hive2://localhost:10000>   nst string,
0: jdbc:hive2://localhost:10000>   gap string,
0: jdbc:hive2://localhost:10000>   dmin string,
0: jdbc:hive2://localhost:10000>   rms string,
0: jdbc:hive2://localhost:10000>   net string,
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   updated string,
0: jdbc:hive2://localhost:10000>   place string,
0: jdbc:hive2://localhost:10000>   type string,
0: jdbc:hive2://localhost:10000>   horizontalError string,
0: jdbc:hive2://localhost:10000>   depthError string,
0: jdbc:hive2://localhost:10000>   magError string,
0: jdbc:hive2://localhost:10000>   magNst string,
0: jdbc:hive2://localhost:10000>   status string,
0: jdbc:hive2://localhost:10000>   locationSource string,
0: jdbc:hive2://localhost:10000>   magSource string
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.495 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
ERROR : Failed with exception Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv
org.apache.hadoop.hive.ql.metadata.HiveException: Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv
	at org.apache.hadoop.hive.ql.metadata.Hive.moveFile(Hive.java:3263)
	at org.apache.hadoop.hive.ql.metadata.Hive.replaceFiles(Hive.java:3528)
	at org.apache.hadoop.hive.ql.metadata.Hive.loadTable(Hive.java:1941)
	at org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:398)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:177)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:96)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1777)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1511)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1308)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1175)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1170)
	at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:197)
	at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:76)
	at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:255)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.hadoop.security.AccessControlException: Permission denied: user=hive, access=WRITE, inode="/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv":admin:hdfs:drwxr-xr-x
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:353)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:325)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:249)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:190)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1950)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameTo(FSDirRenameOp.java:477)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameToInt(FSDirRenameOp.java:73)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.renameTo(FSNamesystem.java:3942)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.rename(NameNodeRpcServer.java:993)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.rename(ClientNamenodeProtocolServerSideTranslatorPB.java:587)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:640)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:982)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2351)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2347)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2347)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)
	at org.apache.hadoop.hdfs.DFSClient.rename(DFSClient.java:2019)
	at org.apache.hadoop.hdfs.DistributedFileSystem.rename(DistributedFileSystem.java:732)
	at org.apache.hadoop.hive.ql.metadata.Hive.moveFile(Hive.java:3251)
	... 24 more
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=hive, access=WRITE, inode="/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv":admin:hdfs:drwxr-xr-x
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:353)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:325)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:249)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:190)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1950)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameTo(FSDirRenameOp.java:477)
	at org.apache.hadoop.hdfs.server.namenode.FSDirRenameOp.renameToInt(FSDirRenameOp.java:73)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.renameTo(FSNamesystem.java:3942)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.rename(NameNodeRpcServer.java:993)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.rename(ClientNamenodeProtocolServerSideTranslatorPB.java:587)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:640)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:982)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2351)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2347)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1869)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2347)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)
	at org.apache.hadoop.ipc.Client.call(Client.java:1498)
	at org.apache.hadoop.ipc.Client.call(Client.java:1398)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at com.sun.proxy.$Proxy19.rename(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.rename(ClientNamenodeProtocolTranslatorPB.java:529)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)
	at com.sun.proxy.$Proxy20.rename(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.rename(DFSClient.java:2017)
	... 26 more

Error: Error while processing statement: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.exec.MoveTask. Unable to move source hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv to destination hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_full_dataset/earthquakes.csv (state=08S01,code=40000)

Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 1.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.514 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.539 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_full_dataset
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   year int,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   date_time string,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   depth double,
0: jdbc:hive2://localhost:10000>   mag double,
0: jdbc:hive2://localhost:10000>   magType string,
0: jdbc:hive2://localhost:10000>   nst string,
0: jdbc:hive2://localhost:10000>   gap string,
0: jdbc:hive2://localhost:10000>   dmin string,
0: jdbc:hive2://localhost:10000>   rms string,
0: jdbc:hive2://localhost:10000>   net string,
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   updated string,
0: jdbc:hive2://localhost:10000>   place string,
0: jdbc:hive2://localhost:10000>   type string,
0: jdbc:hive2://localhost:10000>   horizontalError string,
0: jdbc:hive2://localhost:10000>   depthError string,
0: jdbc:hive2://localhost:10000>   magError string,
0: jdbc:hive2://localhost:10000>   magNst string,
0: jdbc:hive2://localhost:10000>   status string,
0: jdbc:hive2://localhost:10000>   locationSource string,
0: jdbc:hive2://localhost:10000>   magSource string
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.397 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
INFO  : Table earthquakesbasic.earthquakes_full_dataset stats: [numFiles=1, numRows=0, totalSize=23050, rawDataSize=0]
No rows affected (0.67 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 2.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
2.sql (No such file or directory)

Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/2.sql
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/3.sql
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/4.sql
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/5.sql
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/6.sql
^[[A[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/shell.sh
get: `/user/admin/project/earthquakes-basic/earthquakes-etl/shell.sh': No such file or directory
[centos@d-hdp1 earthquakes-etl]$ hadoop fs -get /user/admin/project/earthquakes-basic/earthquakes-etl/shell.sh
[centos@d-hdp1 earthquakes-etl]$ ls
1.sql  2.sql  3.sql  4.sql  5.sql  6.sql  shell.sh
[centos@d-hdp1 earthquakes-etl]$ cat shell.sh

tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "----------- EARTHQUAKES ETL PIPELINE --------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 1 - 6 ---------------------"; tput sgr0
tput rev; echo "------ loading earthquakes dataset to hive --------"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 1.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 2 - 6 ---------------------"; tput sgr0
tput rev; echo "-- exctracting required columns from earthquakes --"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 2.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 3 - 6 ---------------------"; tput sgr0
tput rev; echo "-- calculate distance - earthquakes to all cities -"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 3.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 4 - 6 ---------------------"; tput sgr0
tput rev; echo "---- find the closest city for all earthquakes ----"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 4.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 4 - 6 ---------------------"; tput sgr0
tput rev; echo "- calculate distance - earthquakes to all stations -"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 5.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------------------ STEP 4 - 6 ---------------------"; tput sgr0
tput rev; echo "--- find the closest station for all earthquakes --"; tput sgr0
beeline -u jdbc:hive2://d-hdp1.novalocal:10000 -n hive -f 6.sql
tput rev; echo "--------------------- DONE ------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "---------------------------------------------------"; tput sgr0
tput rev; echo "------- Your data are now loaded to Hive ----------"; tput sgr0


[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ bash shell.sh 
---------------------------------------------------
---------------------------------------------------
----------- EARTHQUAKES ETL PIPELINE --------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 1 - 6 ---------------------
------ loading earthquakes dataset to hive --------
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.535 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.294 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_full_dataset
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   year int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   date_time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depth double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   mag double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magType string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   nst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   gap string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   dmin string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   rms string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   net string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   updated string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   place string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   type string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   horizontalError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depthError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magNst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   status string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   locationSource string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magSource string
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.427 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
INFO  : Table earthquakesbasic.earthquakes_full_dataset stats: [numFiles=1, numRows=0, totalSize=23050, rawDataSize=0]
No rows affected (0.713 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 2 - 6 ---------------------
-- exctracting required columns from earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.561 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes;
No rows affected (0.33 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.411 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0019)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/01  [==========================>>] 100%  ELAPSED TIME: 10.50 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_15-49-59_545_2543758708600754498-59/-ext-10000
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=1, numRows=111, totalSize=5788, rawDataSize=5677]
No rows affected (29.683 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 3 - 6 ---------------------
-- calculate distance - earthquakes to all cities -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.55 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.373 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.495 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://d-hdp1.novalocal:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://d-hdp1.novalocal:10000>           /PI())            
0: jdbc:hive2://d-hdp1.novalocal:10000> as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2656][bigTable=e] in task 'Map 1' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0020)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2              SUCCEEDED      0          0        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 8.78 s     
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_15-50-34_889_2937814733345810341-59/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (23.62 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
---- find the closest city for all earthquakes ----
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.67 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city;
No rows affected (0.311 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.552 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      e.city_distance as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_distance_to_all_cities e INNER JOIN
0: jdbc:hive2://d-hdp1.novalocal:10000>   (
0: jdbc:hive2://d-hdp1.novalocal:10000>     SELECT id, MIN(city_distance) as MinDistance
0: jdbc:hive2://d-hdp1.novalocal:10000>     FROM earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000>     GROUP BY id
0: jdbc:hive2://d-hdp1.novalocal:10000>   ) t ON e.id = t.id AND e.city_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0021)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 3              SUCCEEDED      0          0        0        0       0       0
Reducer 2 ......   SUCCEEDED      2          2        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/03  [==========================>>] 100%  ELAPSED TIME: 12.28 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city/.hive-staging_hive_2020-02-06_15-51-03_831_8008605997514601444-59/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (25.682 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
- calculate distance - earthquakes to all stations -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.609 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city_discance_to_all_stations;
No rows affected (0.338 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_code string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_name string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_datacenter string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.518 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_discance_to_all_stations 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      e.city_distance as city_distance,
0: jdbc:hive2://d-hdp1.novalocal:10000>      s.station_code as station_code, s.station_name as station_name, s.country as station_country,
0: jdbc:hive2://d-hdp1.novalocal:10000>      s.latitude as station_latitude, s.longitude as station_longitude, s.datacenter as station_datacenter,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(s.latitude)))+(cos(radians(e.latitude))*cos(radians(s.latitude))*cos(radians(e.longitude - s.longitude))))))/PI()) as station_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_closest_city e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN seismograph_stations s;
Error: Error while compiling statement: FAILED: SemanticException [Error 10002]: Line 6:7 Invalid column reference 'latitude' (state=42000,code=10002)

Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
--- find the closest station for all earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.876 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city_station;
No rows affected (0.675 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city_station
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_code string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_name string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_datacenter string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (2.297 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_station 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT 
0: jdbc:hive2://d-hdp1.novalocal:10000> e.id as id,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.time as time,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.day as day,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.latitude as latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.longitude as longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city as city,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_latitude as latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_longitude as longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.country as country,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_distance as city_distance,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_code as station_code,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_name as station_name,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_latitude as station_latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_longitude as station_longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_datacenter as station_datacenter,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_distance as station_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_closest_city_discance_to_all_stations e INNER JOIN
0: jdbc:hive2://d-hdp1.novalocal:10000>     (
0: jdbc:hive2://d-hdp1.novalocal:10000>       SELECT id, MIN(station_distance) as MinDistance
0: jdbc:hive2://d-hdp1.novalocal:10000>       FROM earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://d-hdp1.novalocal:10000>       GROUP BY id
0: jdbc:hive2://d-hdp1.novalocal:10000>       ) t ON e.id = t.id AND e.station_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0022)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 3              SUCCEEDED      0          0        0        0       0       0
Reducer 2 ......   SUCCEEDED      2          2        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/03  [==========================>>] 100%  ELAPSED TIME: 10.70 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_station from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_station/.hive-staging_hive_2020-02-06_15-51-43_515_8052247513442240663-59/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_station stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (24.524 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------- Your data are now loaded to Hive ----------
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 3.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.56 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.587 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.48 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://localhost:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://localhost:10000>           /PI())            
0: jdbc:hive2://localhost:10000> as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes e
0: jdbc:hive2://localhost:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2742][bigTable=e] in task 'Map 1' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0023)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2              SUCCEEDED      0          0        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 11.09 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_15-53-48_849_1997591835874795817-66/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (24.403 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ vi 3.sql
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 3.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.439 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.456 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.477 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://localhost:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://localhost:10000>           /PI())            
0: jdbc:hive2://localhost:10000> as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes e
0: jdbc:hive2://localhost:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2785][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
--------------------------------------------------------------------------------
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0025)
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_15-59-58_219_9134980532408469512-73/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=1, numRows=1431123, totalSize=159723233, rawDataSize=158292110]
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 37.82 s    
--------------------------------------------------------------------------------
No rows affected (478.676 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 4.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.692 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city;
No rows affected (0.55 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.49 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://localhost:10000>      e.city_distance as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_distance_to_all_cities e INNER JOIN
0: jdbc:hive2://localhost:10000>   (
0: jdbc:hive2://localhost:10000>     SELECT id, MIN(city_distance) as MinDistance
0: jdbc:hive2://localhost:10000>     FROM earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000>     GROUP BY id
0: jdbc:hive2://localhost:10000>   ) t ON e.id = t.id AND e.city_distance = t.MinDistance;
No rows affected (55.382 seconds)
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0026)

INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city/.hive-staging_hive_2020-02-06_16-08-08_113_5290621439353983249-73/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city stats: [numFiles=1, numRows=111, totalSize=12267, rawDataSize=12156]
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 5.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.758 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city_discance_to_all_stations;
No rows affected (0.613 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double,
0: jdbc:hive2://localhost:10000>   station_code string,
0: jdbc:hive2://localhost:10000>   station_name string,
0: jdbc:hive2://localhost:10000>   station_country string,
0: jdbc:hive2://localhost:10000>   station_latitude double,
0: jdbc:hive2://localhost:10000>   station_longitude double,
0: jdbc:hive2://localhost:10000>   station_datacenter string,
0: jdbc:hive2://localhost:10000>   station_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.466 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_discance_to_all_stations 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://localhost:10000>      e.city_distance as city_distance,
0: jdbc:hive2://localhost:10000>      s.station_code as station_code, s.station_name as station_name, s.country as station_country,
0: jdbc:hive2://localhost:10000>      s.latitude as station_latitude, s.longitude as station_longitude, s.datacenter as station_datacenter,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(s.latitude)))+(cos(radians(e.latitude))*cos(radians(s.latitude))*cos(radians(e.longitude - s.longitude))))))/PI()) as station_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_closest_city e
0: jdbc:hive2://localhost:10000> CROSS JOIN seismograph_stations s;
Error: Error while compiling statement: FAILED: SemanticException [Error 10002]: Line 6:7 Invalid column reference 'latitude' (state=42000,code=10002)

Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ vi 5.sql 
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 5.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.461 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city_discance_to_all_stations;
No rows affected (0.534 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double,
0: jdbc:hive2://localhost:10000>   station_code string,
0: jdbc:hive2://localhost:10000>   station_name string,
0: jdbc:hive2://localhost:10000>   station_country string,
0: jdbc:hive2://localhost:10000>   station_latitude double,
0: jdbc:hive2://localhost:10000>   station_longitude double,
0: jdbc:hive2://localhost:10000>   station_datacenter string,
0: jdbc:hive2://localhost:10000>   station_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.447 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_discance_to_all_stations 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://localhost:10000>      e.city_distance as city_distance,
0: jdbc:hive2://localhost:10000>      s.station_code as station_code, s.station_name as station_name, s.country as station_country,
0: jdbc:hive2://localhost:10000>      s.latitude as station_latitude, s.longitude as station_longitude, s.datacenter as station_datacenter,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(s.latitude)))+(cos(radians(e.latitude))*cos(radians(s.latitude))*cos(radians(e.longitude - s.longitude))))))/PI()) as station_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_closest_city e
0: jdbc:hive2://localhost:10000> CROSS JOIN seismograph_stations s;
INFO  : Warning: Map Join MAPJOIN[2837][bigTable=e] in task 'Map 1' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_close...s(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0027)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 12.39 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_discance_to_all_stations/.hive-staging_hive_2020-02-06_16-14-08_791_847191402965801562-80/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations stats: [numFiles=1, numRows=10212, totalSize=1956575, rawDataSize=1946363]
No rows affected (29.518 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ vi 5.sql 
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 6.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.514 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city_station;
No rows affected (0.566 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city_station
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double,
0: jdbc:hive2://localhost:10000>   station_code string,
0: jdbc:hive2://localhost:10000>   station_name string,
0: jdbc:hive2://localhost:10000>   station_latitude double,
0: jdbc:hive2://localhost:10000>   station_longitude double,
0: jdbc:hive2://localhost:10000>   station_datacenter string,
0: jdbc:hive2://localhost:10000>   station_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.442 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_station 
0: jdbc:hive2://localhost:10000> SELECT 
0: jdbc:hive2://localhost:10000> e.id as id,
0: jdbc:hive2://localhost:10000> e.time as time,
0: jdbc:hive2://localhost:10000> e.day as day,
0: jdbc:hive2://localhost:10000> e.latitude as latitude,
0: jdbc:hive2://localhost:10000> e.longitude as longitude,
0: jdbc:hive2://localhost:10000> e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000> e.city as city,
0: jdbc:hive2://localhost:10000> e.city_latitude as latitude,
0: jdbc:hive2://localhost:10000> e.city_longitude as longitude,
0: jdbc:hive2://localhost:10000> e.country as country,
0: jdbc:hive2://localhost:10000> e.population as population,
0: jdbc:hive2://localhost:10000> e.city_distance as city_distance,
0: jdbc:hive2://localhost:10000> e.station_code as station_code,
0: jdbc:hive2://localhost:10000> e.station_name as station_name,
0: jdbc:hive2://localhost:10000> e.station_latitude as station_latitude,
0: jdbc:hive2://localhost:10000> e.station_longitude as station_longitude,
0: jdbc:hive2://localhost:10000> e.station_datacenter as station_datacenter,
0: jdbc:hive2://localhost:10000> e.station_distance as station_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_closest_city_discance_to_all_stations e INNER JOIN
0: jdbc:hive2://localhost:10000>     (
0: jdbc:hive2://localhost:10000>       SELECT id, MIN(station_distance) as MinDistance
0: jdbc:hive2://localhost:10000>       FROM earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://localhost:10000>       GROUP BY id
0: jdbc:hive2://localhost:10000>       ) t ON e.id = t.id AND e.station_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0028)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 3 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2 ......   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 15.72 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_station from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_station/.hive-staging_hive_2020-02-06_16-16-28_030_7489136253567714846-83/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_station stats: [numFiles=1, numRows=111, totalSize=19867, rawDataSize=19756]
No rows affected (29.306 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ vi 6.sql 
[centos@d-hdp1 earthquakes-etl]$ bash shell.sh 
---------------------------------------------------
---------------------------------------------------
----------- EARTHQUAKES ETL PIPELINE --------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 1 - 6 ---------------------
------ loading earthquakes dataset to hive --------
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.54 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.356 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_full_dataset
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   year int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   date_time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depth double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   mag double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magType string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   nst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   gap string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   dmin string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   rms string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   net string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   updated string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   place string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   type string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   horizontalError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depthError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magNst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   status string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   locationSource string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magSource string
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.458 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
INFO  : Table earthquakesbasic.earthquakes_full_dataset stats: [numFiles=1, numRows=0, totalSize=23050, rawDataSize=0]
No rows affected (0.759 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 2 - 6 ---------------------
-- exctracting required columns from earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.524 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes;
No rows affected (0.299 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.416 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0029)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/01  [==========================>>] 100%  ELAPSED TIME: 9.18 s     
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_16-20-08_833_8434845447587625642-87/-ext-10000
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=1, numRows=111, totalSize=5788, rawDataSize=5677]
No rows affected (21.221 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 3 - 6 ---------------------
-- calculate distance - earthquakes to all cities -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.436 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.289 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.426 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://d-hdp1.novalocal:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://d-hdp1.novalocal:10000>           /PI())            
0: jdbc:hive2://d-hdp1.novalocal:10000> as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2914][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0030)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2                RUNNING      1          0        1        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [=============>>-------------] 50%   ELAPSED TIME: 12.01 s    
--------------------------------------------------------------------------------
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
---- find the closest city for all earthquakes ----
^C
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 3.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.589 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.579 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.896 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://localhost:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://localhost:10000>           /PI())            
0: jdbc:hive2://localhost:10000> as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes e
0: jdbc:hive2://localhost:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2930][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0031)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 34.97 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_16-21-20_316_1566582335436064206-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=1, numRows=1431123, totalSize=159723233, rawDataSize=158292110]
No rows affected (48.149 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ bash shell.sh 
---------------------------------------------------
---------------------------------------------------
----------- EARTHQUAKES ETL PIPELINE --------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 1 - 6 ---------------------
------ loading earthquakes dataset to hive --------
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.725 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.582 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_full_dataset
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   year int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   date_time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depth double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   mag double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magType string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   nst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   gap string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   dmin string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   rms string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   net string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   updated string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   place string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   type string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   horizontalError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depthError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magNst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   status string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   locationSource string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magSource string
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.503 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
Error: Error while compiling statement: FAILED: SemanticException Line 1:17 Invalid path ''/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv'': No files matching path hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv (state=42000,code=40000)

Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 2 - 6 ---------------------
-- exctracting required columns from earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.554 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes;
No rows affected (0.495 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.418 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0032)

INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_16-22-45_147_8528864354805602119-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (21.577 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 3 - 6 ---------------------
-- calculate distance - earthquakes to all cities -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.555 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.581 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.445 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://d-hdp1.novalocal:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://d-hdp1.novalocal:10000>           /PI())            
0: jdbc:hive2://d-hdp1.novalocal:10000> as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[2947][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0033)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 9.15 s     
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_16-23-12_096_9139491764515385871-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (21.724 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
---- find the closest city for all earthquakes ----
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.638 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city;
No rows affected (0.343 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.46 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      e.city_distance as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_distance_to_all_cities e INNER JOIN
0: jdbc:hive2://d-hdp1.novalocal:10000>   (
0: jdbc:hive2://d-hdp1.novalocal:10000>     SELECT id, MIN(city_distance) as MinDistance
0: jdbc:hive2://d-hdp1.novalocal:10000>     FROM earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000>     GROUP BY id
0: jdbc:hive2://d-hdp1.novalocal:10000>   ) t ON e.id = t.id AND e.city_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0034)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 3              SUCCEEDED      0          0        0        0       0       0
Reducer 2 ......   SUCCEEDED      2          2        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/03  [==========================>>] 100%  ELAPSED TIME: 10.26 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city/.hive-staging_hive_2020-02-06_16-23-39_268_8600478669959498799-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (23.444 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
- calculate distance - earthquakes to all stations -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.557 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city_discance_to_all_stations;
No rows affected (0.373 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_code string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_name string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_datacenter string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.576 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_discance_to_all_stations 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      e.city_distance as city_distance,
0: jdbc:hive2://d-hdp1.novalocal:10000>      s.station_code as station_code, s.station_name as station_name, s.country as station_country,
0: jdbc:hive2://d-hdp1.novalocal:10000>      s.latitude as station_latitude, s.longitude as station_longitude, s.datacenter as station_datacenter,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(s.latitude)))+(cos(radians(e.latitude))*cos(radians(s.latitude))*cos(radians(e.longitude - s.longitude))))))/PI()) as station_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_closest_city e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN seismograph_stations s;
INFO  : Warning: Map Join MAPJOIN[2979][bigTable=s] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_close...s(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0035)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 9.85 s     
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_discance_to_all_stations/.hive-staging_hive_2020-02-06_16-24-08_254_1146141050961004465-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (23.191 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
--- find the closest station for all earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.513 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city_station;
No rows affected (0.302 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city_station
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_code string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_name string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_datacenter string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   station_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.435 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_station 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT 
0: jdbc:hive2://d-hdp1.novalocal:10000> e.id as id,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.time as time,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.day as day,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.latitude as latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.longitude as longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city as city,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_latitude as latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_longitude as longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.country as country,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.city_distance as city_distance,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_code as station_code,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_name as station_name,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_latitude as station_latitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_longitude as station_longitude,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_datacenter as station_datacenter,
0: jdbc:hive2://d-hdp1.novalocal:10000> e.station_distance as station_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_closest_city_discance_to_all_stations e INNER JOIN
0: jdbc:hive2://d-hdp1.novalocal:10000>     (
0: jdbc:hive2://d-hdp1.novalocal:10000>       SELECT id, MIN(station_distance) as MinDistance
0: jdbc:hive2://d-hdp1.novalocal:10000>       FROM earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://d-hdp1.novalocal:10000>       GROUP BY id
0: jdbc:hive2://d-hdp1.novalocal:10000>       ) t ON e.id = t.id AND e.station_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0036)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 3              SUCCEEDED      0          0        0        0       0       0
Reducer 2 ......   SUCCEEDED      2          2        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/03  [==========================>>] 100%  ELAPSED TIME: 12.42 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_station from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_station/.hive-staging_hive_2020-02-06_16-24-36_817_140203726926272906-90/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_station stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (29.038 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------- Your data are now loaded to Hive ----------
[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ bash shell.sh 
---------------------------------------------------
---------------------------------------------------
----------- EARTHQUAKES ETL PIPELINE --------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 1 - 6 ---------------------
------ loading earthquakes dataset to hive --------
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.562 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.723 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_full_dataset
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   year int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   date_time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depth double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   mag double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magType string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   nst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   gap string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   dmin string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   rms string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   net string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   updated string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   place string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   type string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   horizontalError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depthError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magNst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   status string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   locationSource string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magSource string
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.442 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
Error: Error while compiling statement: FAILED: SemanticException Line 1:17 Invalid path ''/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv'': No files matching path hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv (state=42000,code=40000)

Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 2 - 6 ---------------------
-- exctracting required columns from earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.549 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes;
No rows affected (0.567 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.45 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0037)

INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_16-27-39_200_9161023092611843744-99/-ext-10000
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (21.669 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 3 - 6 ---------------------
-- calculate distance - earthquakes to all cities -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.621 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.579 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.532 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://d-hdp1.novalocal:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://d-hdp1.novalocal:10000>           /PI())            
0: jdbc:hive2://d-hdp1.novalocal:10000> as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[3024][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0038)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 10.60 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_16-28-26_824_261861614284381866-99/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (23.92 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
---- find the closest city for all earthquakes ----
^C
[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ help hf
-bash: help: no help topics match `hf'.  Try `help help' or `man -k hf' or `info hf'.
[centos@d-hdp1 earthquakes-etl]$ vi shell.sh 
[centos@d-hdp1 earthquakes-etl]$ bash shell.sh 
---------------------------------------------------
---------------------------------------------------
----------- EARTHQUAKES ETL PIPELINE --------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 1 - 6 ---------------------
------ loading earthquakes dataset to hive --------
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.702 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.54 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_full_dataset
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   year int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   date_time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depth double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   mag double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magType string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   nst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   gap string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   dmin string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   rms string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   net string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   updated string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   place string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   type string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   horizontalError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   depthError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magError string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magNst string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   status string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   locationSource string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magSource string
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.478 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
Error: Error while compiling statement: FAILED: SemanticException Line 1:17 Invalid path ''/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv'': No files matching path hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv (state=42000,code=40000)

Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 2 - 6 ---------------------
-- exctracting required columns from earthquakes --
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.602 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes;
No rows affected (0.545 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.431 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0039)

INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_16-34-02_998_3908707998588540497-102/-ext-10000
--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1           INITIALIZING     -1          0        0       -1       0       0
--------------------------------------------------------------------------------
VERTICES: 00/01  [>>--------------------------] 0%    ELAPSED TIME: 0.94 s     
--------------------------------------------------------------------------------
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (13.788 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 3 - 6 ---------------------
-- calculate distance - earthquakes to all cities -
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.538 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.498 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.464 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://d-hdp1.novalocal:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://d-hdp1.novalocal:10000>           /PI())            
0: jdbc:hive2://d-hdp1.novalocal:10000> as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes e
0: jdbc:hive2://d-hdp1.novalocal:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[3036][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0040)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1              SUCCEEDED      0          0        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/02  [==========================>>] 100%  ELAPSED TIME: 10.12 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_16-34-23_285_6233418758813748026-102/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
No rows affected (23.159 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
Closing: 0: jdbc:hive2://d-hdp1.novalocal:10000
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
---- find the closest city for all earthquakes ----
Connecting to jdbc:hive2://d-hdp1.novalocal:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://d-hdp1.novalocal:10000> use earthquakesbasic;
No rows affected (0.588 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> drop table if exists earthquakes_closest_city;
No rows affected (0.481 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> create table earthquakes_closest_city
0: jdbc:hive2://d-hdp1.novalocal:10000> (
0: jdbc:hive2://d-hdp1.novalocal:10000>   id string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   time string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   day date,
0: jdbc:hive2://d-hdp1.novalocal:10000>   latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   magnitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_latitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_longitude double,
0: jdbc:hive2://d-hdp1.novalocal:10000>   country string,
0: jdbc:hive2://d-hdp1.novalocal:10000>   population int,
0: jdbc:hive2://d-hdp1.novalocal:10000>   city_distance double
0: jdbc:hive2://d-hdp1.novalocal:10000>   )
0: jdbc:hive2://d-hdp1.novalocal:10000> row format delimited fields terminated by ',';
No rows affected (0.466 seconds)
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> 
0: jdbc:hive2://d-hdp1.novalocal:10000> INSERT OVERWRITE TABLE earthquakes_closest_city 
0: jdbc:hive2://d-hdp1.novalocal:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://d-hdp1.novalocal:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://d-hdp1.novalocal:10000>      e.city_distance as city_distance
0: jdbc:hive2://d-hdp1.novalocal:10000> FROM earthquakes_distance_to_all_cities e INNER JOIN
0: jdbc:hive2://d-hdp1.novalocal:10000>   (
0: jdbc:hive2://d-hdp1.novalocal:10000>     SELECT id, MIN(city_distance) as MinDistance
0: jdbc:hive2://d-hdp1.novalocal:10000>     FROM earthquakes_distance_to_all_cities
0: jdbc:hive2://d-hdp1.novalocal:10000>     GROUP BY id
0: jdbc:hive2://d-hdp1.novalocal:10000>   ) t ON e.id = t.id AND e.city_distance = t.MinDistance;
--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
- calculate distance - earthquakes to all stations -
^C--------------------- DONE ------------------------
---------------------------------------------------
---------------------------------------------------
------------------ STEP 4 - 6 ---------------------
--- find the closest station for all earthquakes --
^C
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 1.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.537 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_full_dataset;
No rows affected (0.354 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_full_dataset
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   year int,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   date_time string,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   depth double,
0: jdbc:hive2://localhost:10000>   mag double,
0: jdbc:hive2://localhost:10000>   magType string,
0: jdbc:hive2://localhost:10000>   nst string,
0: jdbc:hive2://localhost:10000>   gap string,
0: jdbc:hive2://localhost:10000>   dmin string,
0: jdbc:hive2://localhost:10000>   rms string,
0: jdbc:hive2://localhost:10000>   net string,
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   updated string,
0: jdbc:hive2://localhost:10000>   place string,
0: jdbc:hive2://localhost:10000>   type string,
0: jdbc:hive2://localhost:10000>   horizontalError string,
0: jdbc:hive2://localhost:10000>   depthError string,
0: jdbc:hive2://localhost:10000>   magError string,
0: jdbc:hive2://localhost:10000>   magNst string,
0: jdbc:hive2://localhost:10000>   status string,
0: jdbc:hive2://localhost:10000>   locationSource string,
0: jdbc:hive2://localhost:10000>   magSource string
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.503 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv' OVERWRITE INTO TABLE earthquakes_full_dataset;
INFO  : Loading data to table earthquakesbasic.earthquakes_full_dataset from hdfs://d-hdp1.novalocal:8020/user/admin/project/earthquakes-basic/earthquakes-etl/earthquakes.csv
INFO  : Table earthquakesbasic.earthquakes_full_dataset stats: [numFiles=1, numRows=0, totalSize=23050, rawDataSize=0]
No rows affected (1.797 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 2.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.542 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes;
No rows affected (0.373 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.462 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes 
0: jdbc:hive2://localhost:10000> SELECT id as id, time as time, day as day, latitude as latitude, longitude as longitude, mag as magnitude 
0: jdbc:hive2://localhost:10000> FROM earthquakes_full_dataset;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABL...hquakes_full_dataset(Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0042)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 01/01  [==========================>>] 100%  ELAPSED TIME: 8.70 s     
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes/.hive-staging_hive_2020-02-06_17-00-13_617_4963207059281322598-83/-ext-10000
INFO  : Table earthquakesbasic.earthquakes stats: [numFiles=1, numRows=111, totalSize=5788, rawDataSize=5677]
No rows affected (22.384 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 3.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.564 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_distance_to_all_cities;
No rows affected (0.396 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (4.159 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_distance_to_all_cities 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        c.city_ascii as city, c.lat as latitude, c.lng as longitude, c.country as country, c.population as population,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(c.lat)))
0: jdbc:hive2://localhost:10000>               +(cos(radians(e.latitude))*cos(radians(c.lat))*cos(radians(e.longitude - c.lng))))))
0: jdbc:hive2://localhost:10000>           /PI())            
0: jdbc:hive2://localhost:10000> as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes e
0: jdbc:hive2://localhost:10000> CROSS JOIN cities c;
INFO  : Warning: Map Join MAPJOIN[3076][bigTable=c] in task 'Map 2' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_dista...c(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0043)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 34.00 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_distance_to_all_cities from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_distance_to_all_cities/.hive-staging_hive_2020-02-06_17-00-55_285_7019382513264052790-83/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_distance_to_all_cities stats: [numFiles=1, numRows=1431123, totalSize=159723233, rawDataSize=158292110]
No rows affected (48.147 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 4.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.667 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city;
No rows affected (0.467 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.546 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://localhost:10000>      e.city_distance as city_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_distance_to_all_cities e INNER JOIN
0: jdbc:hive2://localhost:10000>   (
0: jdbc:hive2://localhost:10000>     SELECT id, MIN(city_distance) as MinDistance
0: jdbc:hive2://localhost:10000>     FROM earthquakes_distance_to_all_cities
0: jdbc:hive2://localhost:10000>     GROUP BY id
0: jdbc:hive2://localhost:10000>   ) t ON e.id = t.id AND e.city_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0044)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      3          3        0        0       0       0
Map 3 ..........   SUCCEEDED      3          3        0        0       0       0
Reducer 2 ......   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 48.77 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city/.hive-staging_hive_2020-02-06_17-01-58_614_6565523080255319932-83/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city stats: [numFiles=1, numRows=111, totalSize=12267, rawDataSize=12156]
No rows affected (61.754 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 5.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (0.777 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city_discance_to_all_stations;
No rows affected (0.455 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double,
0: jdbc:hive2://localhost:10000>   station_code string,
0: jdbc:hive2://localhost:10000>   station_name string,
0: jdbc:hive2://localhost:10000>   station_country string,
0: jdbc:hive2://localhost:10000>   station_latitude double,
0: jdbc:hive2://localhost:10000>   station_longitude double,
0: jdbc:hive2://localhost:10000>   station_datacenter string,
0: jdbc:hive2://localhost:10000>   station_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.538 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_discance_to_all_stations 
0: jdbc:hive2://localhost:10000> SELECT e.id as id, e.time as time, e.day as day, e.latitude as latitude, e.longitude as longitude, e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000>        e.city as city, e.city_latitude as city_latitude, e.city_longitude as city_longitude, e.country as country, e.population as population,
0: jdbc:hive2://localhost:10000>      e.city_distance as city_distance,
0: jdbc:hive2://localhost:10000>      s.station_code as station_code, s.station_name as station_name, s.country as station_country,
0: jdbc:hive2://localhost:10000>      s.latitude as station_latitude, s.longitude as station_longitude, s.datacenter as station_datacenter,
0: jdbc:hive2://localhost:10000>      60*1.1515*(180*(acos(((sin(radians(e.latitude))*sin(radians(s.latitude)))+(cos(radians(e.latitude))*cos(radians(s.latitude))*cos(radians(e.longitude - s.longitude))))))/PI()) as station_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_closest_city e
0: jdbc:hive2://localhost:10000> CROSS JOIN seismograph_stations s;
INFO  : Warning: Map Join MAPJOIN[3109][bigTable=e] in task 'Map 1' is a cross product
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earthquakes_close...s(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0045)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 2 ..........   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 14.80 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_discance_to_all_stations/.hive-staging_hive_2020-02-06_17-03-11_406_4821531820233352702-83/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_discance_to_all_stations stats: [numFiles=1, numRows=10212, totalSize=1956575, rawDataSize=1946363]
No rows affected (33.77 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 6.sql
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 1.2.1000.2.6.5.1175-1)
Driver: Hive JDBC (version 1.2.1000.2.6.5.1175-1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://localhost:10000> use earthquakesbasic;
No rows affected (1.067 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> drop table if exists earthquakes_closest_city_station;
No rows affected (0.595 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create table earthquakes_closest_city_station
0: jdbc:hive2://localhost:10000> (
0: jdbc:hive2://localhost:10000>   id string,
0: jdbc:hive2://localhost:10000>   time string,
0: jdbc:hive2://localhost:10000>   day date,
0: jdbc:hive2://localhost:10000>   latitude double,
0: jdbc:hive2://localhost:10000>   longitude double,
0: jdbc:hive2://localhost:10000>   magnitude double,
0: jdbc:hive2://localhost:10000>   city string,
0: jdbc:hive2://localhost:10000>   city_latitude double,
0: jdbc:hive2://localhost:10000>   city_longitude double,
0: jdbc:hive2://localhost:10000>   country string,
0: jdbc:hive2://localhost:10000>   population int,
0: jdbc:hive2://localhost:10000>   city_distance double,
0: jdbc:hive2://localhost:10000>   station_code string,
0: jdbc:hive2://localhost:10000>   station_name string,
0: jdbc:hive2://localhost:10000>   station_latitude double,
0: jdbc:hive2://localhost:10000>   station_longitude double,
0: jdbc:hive2://localhost:10000>   station_datacenter string,
0: jdbc:hive2://localhost:10000>   station_distance double
0: jdbc:hive2://localhost:10000>   )
0: jdbc:hive2://localhost:10000> row format delimited fields terminated by ',';
No rows affected (0.567 seconds)
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> INSERT OVERWRITE TABLE earthquakes_closest_city_station 
0: jdbc:hive2://localhost:10000> SELECT 
0: jdbc:hive2://localhost:10000> e.id as id,
0: jdbc:hive2://localhost:10000> e.time as time,
0: jdbc:hive2://localhost:10000> e.day as day,
0: jdbc:hive2://localhost:10000> e.latitude as latitude,
0: jdbc:hive2://localhost:10000> e.longitude as longitude,
0: jdbc:hive2://localhost:10000> e.magnitude as magnitude, 
0: jdbc:hive2://localhost:10000> e.city as city,
0: jdbc:hive2://localhost:10000> e.city_latitude as latitude,
0: jdbc:hive2://localhost:10000> e.city_longitude as longitude,
0: jdbc:hive2://localhost:10000> e.country as country,
0: jdbc:hive2://localhost:10000> e.population as population,
0: jdbc:hive2://localhost:10000> e.city_distance as city_distance,
0: jdbc:hive2://localhost:10000> e.station_code as station_code,
0: jdbc:hive2://localhost:10000> e.station_name as station_name,
0: jdbc:hive2://localhost:10000> e.station_latitude as station_latitude,
0: jdbc:hive2://localhost:10000> e.station_longitude as station_longitude,
0: jdbc:hive2://localhost:10000> e.station_datacenter as station_datacenter,
0: jdbc:hive2://localhost:10000> e.station_distance as station_distance
0: jdbc:hive2://localhost:10000> FROM earthquakes_closest_city_discance_to_all_stations e INNER JOIN
0: jdbc:hive2://localhost:10000>     (
0: jdbc:hive2://localhost:10000>       SELECT id, MIN(station_distance) as MinDistance
0: jdbc:hive2://localhost:10000>       FROM earthquakes_closest_city_discance_to_all_stations
0: jdbc:hive2://localhost:10000>       GROUP BY id
0: jdbc:hive2://localhost:10000>       ) t ON e.id = t.id AND e.station_distance = t.MinDistance;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: INSERT OVERWRITE TABLE earth...t.MinDistance(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1580611066755_0046)

--------------------------------------------------------------------------------
        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
--------------------------------------------------------------------------------
Map 1 ..........   SUCCEEDED      1          1        0        0       0       0
Map 3 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2 ......   SUCCEEDED      1          1        0        0       0       0
--------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 20.90 s    
--------------------------------------------------------------------------------
INFO  : Loading data to table earthquakesbasic.earthquakes_closest_city_station from hdfs://d-hdp1.novalocal:8020/apps/hive/warehouse/earthquakesbasic.db/earthquakes_closest_city_station/.hive-staging_hive_2020-02-06_17-03-59_164_7054952810418288804-85/-ext-10000
INFO  : Table earthquakesbasic.earthquakes_closest_city_station stats: [numFiles=1, numRows=111, totalSize=19867, rawDataSize=19756]
No rows affected (41.929 seconds)
0: jdbc:hive2://localhost:10000> 
Closing: 0: jdbc:hive2://localhost:10000
[centos@d-hdp1 earthquakes-etl]$ beeline -u jdbc:hive2://localhost:10000 -n admin -f 6.sqlpacket_write_wait: Connection to 161.74.26.176 port 22: Broken pipe
eroam-118-34:~ dimitriskagialis$ 
